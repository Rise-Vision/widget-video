{"version":3,"sources":["js/widget.min.js"],"names":["WIDGET_COMMON_CONFIG","AUTH_PATH_URL","LOGGER_CLIENT_ID","LOGGER_CLIENT_SECRET","LOGGER_REFRESH_TOKEN","STORE_URL","RiseVision","Common","LoggerUtils","displayId","companyId","version","getEventParams","params","cb","json","event","file_url","file_format","getFileFormat","company_id","display_id","getSuffix","date","Date","year","getUTCFullYear","month","getUTCMonth","day","getUTCDate","url","hasParams","str","substr","lastIndexOf","test","indexOf","length","toLowerCase","getInsertData","BASE_INSERT_SCHEMA","data","JSON","parse","stringify","rows","insertId","Math","random","toString","toUpperCase","ts","toISOString","logEvent","table","Logger","log","setIds","company","display","setVersion","value","utils","REFRESH_URL","serviceUrl","throttle","throttleDelay","lastEvent","refreshDate","token","refreshToken","xhr","XMLHttpRequest","open","onloadend","resp","response","access_token","refreshedAt","send","isThrottled","tableName","hasOwnProperty","setTimeout","insertWithToken","refreshData","insertData","replace","setRequestHeader","Utilities","getFontCssStyle","className","fontObj","family","decodeURIComponent","font","color","forecolor","size","weight","bold","italic","underline","highlight","highlightColor","backcolor","addCSSRules","rules","style","document","createElement","i","appendChild","createTextNode","head","loadFonts","settings","families","googleFamilies","customFamilies","customUrls","callback","onGoogleFontsLoaded","forEach","item","class","fontStyle","type","split","push","j","loadCustomFont","loadGoogleFonts","contentDoc","sheet","rule","styleSheets","addRule","WebFont","load","google","active","inactive","timeout","loadScript","src","getElementsByTagName","script","preloadImages","urls","images","Image","getQueryParameter","param","query","window","location","search","substring","vars","pair","getRiseCacheErrorMessage","statusCode","errorMessage","unescapeHTML","html","div","innerHTML","textContent","hasInternetConnection","filePath","getTime","status","e","isLegacy","legacyVersion","match","navigator","userAgent","parseInt","addProtocol","secure","RiseCache","BASE_CACHE_URL","_pingReceived","_isCacheRunning","_isV2Running","ping","r","self","onreadystatechange","readyState","responseText","console","debug","description","getFile","fileUrl","nocachebuster","totalCacheRequests","fileRequest","separator","encodeURIComponent","makeRequest","method","request","addEventListener","Error","getErrorMessage","isRiseCacheRunning","isV2Running","angular","module","constant","config","STORAGE_ENV","COMPONENTS_PATH","Video","gadgets","_additionalParams","_mode","_isLoading","_configDetails","_prefs","_storage","_nonStorage","_message","_player","_viewerPaused","_resume","_currentFiles","_currentPlaylistIndex","_errorLog","_errorTimer","_errorFlag","_storageErrorFlag","_playerErrorFlag","_unavailableFlag","_done","rpc","call","getString","_ready","_clearErrorTimer","clearTimeout","_startErrorTimer","_getCurrentFile","hasStorageError","hasPlayerError","showError","message","isStorageError","show","isError","getTableName","onFileInit","hide","play","onFileRefresh","update","onFileUnavailable","pause","reset","event_details","retry","PlayerVJS","init","playerEnded","playerReady","playerItemChange","index","setAdditionalParams","mode","isStorageFile","_","clone","Prefs","getElementById","width","getInt","height","video","resume","Message","Object","keys","storage","NonStorage","StorageFile","StorageFolder","playerError","error","details","MEDIA_ERROR","YOUTUBE_ERROR","PLAYER_ERROR","PLAYLIST_ERROR","ENCODING_MESSAGE","FORMAT_MESSAGE","stop","PlayerUtils","getPlaylist","list","playlist","file","getVideoFileType","extensions","urlLowercase","_initialLoad","riseCache","detail","changed","code","currentTarget","setAttribute","folder","fileName","_files","_getUrls","pluck","_getExistingFile","find","f","name","_deleteFile","existing","splice","_changeFile","_addFile","slice","sortedIndex","added","deleted","_refreshDuration","_refreshIntervalId","_url","_getFile","omitCacheBuster","_startRefreshInterval","setInterval","selector","_autoPlay","_playerInstance","_utils","_updateWaiting","_disableFullscreen","_getOptions","autoplay","controls","fluid","scaleToFit","volume","Number","isInteger","on","files","videojs","paused","remainingTime","currentTime","mainContainer","messageContainer","_active","_init","warn","firstChild","removeChild","fragment","createDocumentFragment","p","querySelector","prefs","id","oncontextmenu","configure","names","values","additionalParams","Array","isArray","register","isV2","link","webcomponents","href","storageReady","polymerReady","onPolymerReady","removeEventListener","onStorageReady","body","_gaq","ga","async","protocol","s","parentNode","insertBefore"],"mappings":"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","file":"widget.min.js","sourcesContent":["/* exported WIDGET_COMMON_CONFIG */\nvar WIDGET_COMMON_CONFIG = {\n  AUTH_PATH_URL: \"v1/widget/auth\",\n  LOGGER_CLIENT_ID: \"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com\",\n  LOGGER_CLIENT_SECRET: \"nlZyrcPLg6oEwO9f9Wfn29Wh\",\n  LOGGER_REFRESH_TOKEN: \"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT\",\n  STORE_URL: \"https://store-dot-rvaserver2.appspot.com/\"\n};\n/* global WIDGET_COMMON_CONFIG */\n\nvar RiseVision = RiseVision || {};\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.LoggerUtils = (function() {\n  \"use strict\";\n\n   var displayId = \"\",\n     companyId = \"\",\n     version = null;\n\n  /*\n   *  Private Methods\n   */\n\n  /* Retrieve parameters to pass to the event logger. */\n  function getEventParams(params, cb) {\n    var json = null;\n\n    // event is required.\n    if (params.event) {\n      json = params;\n\n      if (json.file_url) {\n        json.file_format = getFileFormat(json.file_url);\n      }\n\n      json.company_id = companyId;\n      json.display_id = displayId;\n\n      if (version) {\n        json.version = version;\n      }\n\n      cb(json);\n    }\n    else {\n      cb(json);\n    }\n  }\n\n  // Get suffix for BQ table name.\n  function getSuffix() {\n    var date = new Date(),\n      year = date.getUTCFullYear(),\n      month = date.getUTCMonth() + 1,\n      day = date.getUTCDate();\n\n    if (month < 10) {\n      month = \"0\" + month;\n    }\n\n    if (day < 10) {\n      day = \"0\" + day;\n    }\n\n    return \"\" + year + month + day;\n  }\n\n  /*\n   *  Public Methods\n   */\n  function getFileFormat(url) {\n    var hasParams = /[?#&]/,\n      str;\n\n    if (!url || typeof url !== \"string\") {\n      return null;\n    }\n\n    str = url.substr(url.lastIndexOf(\".\") + 1);\n\n    // don't include any params after the filename\n    if (hasParams.test(str)) {\n      str = str.substr(0 ,(str.indexOf(\"?\") !== -1) ? str.indexOf(\"?\") : str.length);\n\n      str = str.substr(0, (str.indexOf(\"#\") !== -1) ? str.indexOf(\"#\") : str.length);\n\n      str = str.substr(0, (str.indexOf(\"&\") !== -1) ? str.indexOf(\"&\") : str.length);\n    }\n\n    return str.toLowerCase();\n  }\n\n  function getInsertData(params) {\n    var BASE_INSERT_SCHEMA = {\n      \"kind\": \"bigquery#tableDataInsertAllRequest\",\n      \"skipInvalidRows\": false,\n      \"ignoreUnknownValues\": false,\n      \"templateSuffix\": getSuffix(),\n      \"rows\": [{\n        \"insertId\": \"\"\n      }]\n    },\n    data = JSON.parse(JSON.stringify(BASE_INSERT_SCHEMA));\n\n    data.rows[0].insertId = Math.random().toString(36).substr(2).toUpperCase();\n    data.rows[0].json = JSON.parse(JSON.stringify(params));\n    data.rows[0].json.ts = new Date().toISOString();\n\n    return data;\n  }\n\n  function logEvent(table, params) {\n    getEventParams(params, function(json) {\n      if (json !== null) {\n        RiseVision.Common.Logger.log(table, json);\n      }\n    });\n  }\n\n  /* Set the Company and Display IDs. */\n  function setIds(company, display) {\n    companyId = company;\n    displayId = display;\n  }\n\n  function setVersion(value) {\n    version = value;\n  }\n\n  return {\n    \"getInsertData\": getInsertData,\n    \"getFileFormat\": getFileFormat,\n    \"logEvent\": logEvent,\n    \"setIds\": setIds,\n    \"setVersion\": setVersion\n  };\n})();\n\nRiseVision.Common.Logger = (function(utils) {\n  \"use strict\";\n\n  var REFRESH_URL = \"https://www.googleapis.com/oauth2/v3/token?client_id=\" + WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID +\n      \"&client_secret=\" + WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET +\n      \"&refresh_token=\" + WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN +\n      \"&grant_type=refresh_token\";\n\n  var serviceUrl = \"https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll\",\n    throttle = false,\n    throttleDelay = 1000,\n    lastEvent = \"\",\n    refreshDate = 0,\n    token = \"\";\n\n  /*\n   *  Private Methods\n   */\n  function refreshToken(cb) {\n    var xhr = new XMLHttpRequest();\n\n    if (new Date() - refreshDate < 3580000) {\n      return cb({});\n    }\n\n    xhr.open(\"POST\", REFRESH_URL, true);\n    xhr.onloadend = function() {\n      var resp = JSON.parse(xhr.response);\n\n      cb({ token: resp.access_token, refreshedAt: new Date() });\n    };\n\n    xhr.send();\n  }\n\n  function isThrottled(event) {\n    return throttle && (lastEvent === event);\n  }\n\n  /*\n   *  Public Methods\n   */\n  function log(tableName, params) {\n    if (!tableName || !params || (params.hasOwnProperty(\"event\") && !params.event) ||\n      (params.hasOwnProperty(\"event\") && isThrottled(params.event))) {\n      return;\n    }\n\n    throttle = true;\n    lastEvent = params.event;\n\n    setTimeout(function () {\n      throttle = false;\n    }, throttleDelay);\n\n    function insertWithToken(refreshData) {\n      var xhr = new XMLHttpRequest(),\n        insertData, url;\n\n      url = serviceUrl.replace(\"TABLE_ID\", tableName);\n      refreshDate = refreshData.refreshedAt || refreshDate;\n      token = refreshData.token || token;\n      insertData = utils.getInsertData(params);\n\n      // Insert the data.\n      xhr.open(\"POST\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n\n      if (params.cb && typeof params.cb === \"function\") {\n        xhr.onloadend = function() {\n          params.cb(xhr.response);\n        };\n      }\n\n      xhr.send(JSON.stringify(insertData));\n    }\n\n    return refreshToken(insertWithToken);\n  }\n\n  return {\n    \"log\": log\n  };\n})(RiseVision.Common.LoggerUtils);\n/* global WebFont */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.Utilities = (function() {\n\n  function getFontCssStyle(className, fontObj) {\n    var family = \"font-family: \" + decodeURIComponent(fontObj.font.family).replace(/'/g, \"\") + \"; \";\n    var color = \"color: \" + (fontObj.color ? fontObj.color : fontObj.forecolor) + \"; \";\n    var size = \"font-size: \" + (fontObj.size.indexOf(\"px\") === -1 ? fontObj.size + \"px; \" : fontObj.size + \"; \");\n    var weight = \"font-weight: \" + (fontObj.bold ? \"bold\" : \"normal\") + \"; \";\n    var italic = \"font-style: \" + (fontObj.italic ? \"italic\" : \"normal\") + \"; \";\n    var underline = \"text-decoration: \" + (fontObj.underline ? \"underline\" : \"none\") + \"; \";\n    var highlight = \"background-color: \" + (fontObj.highlightColor ? fontObj.highlightColor : fontObj.backcolor) + \";\";\n\n    return \".\" + className + \" {\" + family + color + size + weight + italic + underline + highlight + \"}\";\n  }\n\n  function addCSSRules(rules) {\n    var style = document.createElement(\"style\");\n\n    for (var i = 0, length = rules.length; i < length; i++) {\n      style.appendChild(document.createTextNode(rules[i]));\n    }\n\n    document.head.appendChild(style);\n  }\n\n  /*\n   * Loads Google or custom fonts, if applicable, and injects CSS styles\n   * into the head of the document.\n   *\n   * @param    array    settings    Array of objects with the following form:\n *                                   [{\n *                                     \"class\": \"date\",\n *                                     \"fontSetting\": {\n *                                         bold: true,\n *                                         color: \"black\",\n *                                         font: {\n *                                           family: \"Akronim\",\n *                                           font: \"Akronim\",\n *                                           name: \"Verdana\",\n *                                           type: \"google\",\n *                                           url: \"http://custom-font-url\"\n *                                         },\n *                                         highlightColor: \"transparent\",\n *                                         italic: false,\n *                                         size: \"20\",\n *                                         underline: false\n *                                     }\n *                                   }]\n   *\n   *           object   contentDoc    Document object into which to inject styles\n   *                                  and load fonts (optional).\n   */\n  function loadFonts(settings, cb) {\n    var families = null,\n      googleFamilies = [],\n      customFamilies = [],\n      customUrls = [];\n\n    function callback() {\n      if (cb && typeof cb === \"function\") {\n        cb();\n      }\n    }\n\n    function onGoogleFontsLoaded() {\n      callback();\n    }\n\n    if (!settings || settings.length === 0) {\n      callback();\n      return;\n    }\n\n    // Check for custom css class names and add rules if so\n    settings.forEach(function(item) {\n      if (item.class && item.fontStyle) {\n        addCSSRules([ getFontCssStyle(item.class, item.fontStyle) ]);\n      }\n    });\n\n    // Google fonts\n    for (var i = 0; i < settings.length; i++) {\n      if (settings[i].fontStyle && settings[i].fontStyle.font.type &&\n        (settings[i].fontStyle.font.type === \"google\")) {\n        // Remove fallback font.\n        families = settings[i].fontStyle.font.family.split(\",\")[0];\n\n        // strip possible single quotes\n        families = families.replace(/'/g, \"\");\n\n        googleFamilies.push(families);\n      }\n    }\n\n    // Custom fonts\n    for (i = 0; i < settings.length; i++) {\n      if (settings[i].fontStyle && settings[i].fontStyle.font.type &&\n        (settings[i].fontStyle.font.type === \"custom\")) {\n        // decode value and strip single quotes\n        customFamilies.push(decodeURIComponent(settings[i].fontStyle.font.family).replace(/'/g, \"\"));\n        // strip single quotes\n        customUrls.push(settings[i].fontStyle.font.url.replace(/'/g, \"\\\\'\"));\n      }\n    }\n\n    if (googleFamilies.length === 0 && customFamilies.length === 0) {\n      callback();\n    }\n    else {\n      // Load the fonts\n      for (var j = 0; j < customFamilies.length; j += 1) {\n        loadCustomFont(customFamilies[j], customUrls[j]);\n      }\n\n      if (googleFamilies.length > 0) {\n        loadGoogleFonts(googleFamilies, onGoogleFontsLoaded);\n      }\n      else {\n        callback();\n      }\n    }\n  }\n\n  function loadCustomFont(family, url, contentDoc) {\n    var sheet = null;\n    var rule = \"font-family: \" + family + \"; \" + \"src: url('\" + url + \"');\";\n\n    contentDoc = contentDoc || document;\n\n    sheet = contentDoc.styleSheets[0];\n\n    if (sheet !== null) {\n      sheet.addRule(\"@font-face\", rule);\n    }\n  }\n\n  function loadGoogleFonts(families, cb) {\n    WebFont.load({\n      google: {\n        families: families\n      },\n      active: function() {\n        if (cb && typeof cb === \"function\") {\n          cb();\n        }\n      },\n      inactive: function() {\n        if (cb && typeof cb === \"function\") {\n          cb();\n        }\n      },\n      timeout: 2000\n    });\n  }\n\n  function loadScript( src ) {\n    var head = document.getElementsByTagName( \"head\" )[ 0 ],\n      script = document.createElement( \"script\" );\n\n    script.type = \"text/javascript\";\n    script.src = src;\n\n    head.appendChild( script );\n  }\n\n  function preloadImages(urls) {\n    var length = urls.length,\n      images = [];\n\n    for (var i = 0; i < length; i++) {\n      images[i] = new Image();\n      images[i].src = urls[i];\n    }\n  }\n\n  function getQueryParameter(param) {\n    var query = window.location.search.substring(1),\n      vars = query.split(\"&\"),\n      pair;\n\n    for (var i = 0; i < vars.length; i++) {\n      pair = vars[i].split(\"=\");\n\n      if (pair[0] == param) { // jshint ignore:line\n        return decodeURIComponent(pair[1]);\n      }\n    }\n\n    return \"\";\n  }\n\n  function getRiseCacheErrorMessage(statusCode) {\n    var errorMessage = \"\";\n    switch (statusCode) {\n      case 404:\n        errorMessage = \"The file does not exist or cannot be accessed.\";\n        break;\n      case 507:\n        errorMessage = \"There is not enough disk space to save the file on Rise Cache.\";\n        break;\n      default:\n        errorMessage = \"There was a problem retrieving the file from Rise Cache.\";\n    }\n\n    return errorMessage;\n  }\n\n  function unescapeHTML(html) {\n    var div = document.createElement(\"div\");\n\n    div.innerHTML = html;\n\n    return div.textContent;\n  }\n\n  function hasInternetConnection(filePath, callback) {\n    var xhr = new XMLHttpRequest();\n\n    if (!filePath || !callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    xhr.open(\"HEAD\", filePath + \"?cb=\" + new Date().getTime(), false);\n\n    try {\n      xhr.send();\n\n      callback((xhr.status >= 200 && xhr.status < 304));\n\n    } catch (e) {\n      callback(false);\n    }\n  }\n\n  /**\n   * Check if chrome version is under a certain version\n   */\n  function isLegacy() {\n    var legacyVersion = 25;\n\n    var match = navigator.userAgent.match(/Chrome\\/(\\S+)/);\n    var version = match ? match[1] : 0;\n\n    if (version) {\n      version = parseInt(version.substring(0,version.indexOf(\".\")));\n\n      if (version <= legacyVersion) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Adds http:// or https:// protocol to url if the protocol is missing\n   */\n  function addProtocol(url, secure) {\n    if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n      url = ((secure) ? \"https://\" : \"http://\") + url;\n    }\n    return url;\n  }\n\n  return {\n    addProtocol: addProtocol,\n    getQueryParameter: getQueryParameter,\n    getFontCssStyle:  getFontCssStyle,\n    addCSSRules:      addCSSRules,\n    loadFonts:        loadFonts,\n    loadCustomFont:   loadCustomFont,\n    loadGoogleFonts:   loadGoogleFonts,\n    loadScript: loadScript,\n    preloadImages:    preloadImages,\n    getRiseCacheErrorMessage: getRiseCacheErrorMessage,\n    unescapeHTML: unescapeHTML,\n    hasInternetConnection: hasInternetConnection,\n    isLegacy: isLegacy\n  };\n})();\n\nvar RiseVision = RiseVision || {};\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.RiseCache = (function () {\n  \"use strict\";\n\n  var BASE_CACHE_URL = \"//localhost:9494/\";\n\n  var _pingReceived = false,\n    _isCacheRunning = false,\n    _isV2Running = false;\n\n  function ping(callback) {\n    var r = new XMLHttpRequest(),\n      /* jshint validthis: true */\n      self = this;\n\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    if (!_isV2Running) {\n      r.open(\"GET\", BASE_CACHE_URL + \"ping?callback=_\", true);\n    }\n    else {\n      r.open(\"GET\", BASE_CACHE_URL, true);\n    }\n\n    r.onreadystatechange = function () {\n      try {\n        if (r.readyState === 4 ) {\n          // save this result for use in getFile()\n          _pingReceived = true;\n\n          if(r.status === 200) {\n            _isCacheRunning = true;\n\n            callback(true, r.responseText);\n          } else if (r.status === 404) {\n            // Rise Cache V2 is running\n            _isV2Running = true;\n\n            // call ping again so correct ping URL is used for Rise Cache V2\n            return self.ping(callback);\n          } else {\n            console.debug(\"Rise Cache is not running\");\n            _isCacheRunning = false;\n\n            callback(false, null);\n          }\n        }\n      }\n      catch (e) {\n        console.debug(\"Caught exception: \", e.description);\n      }\n\n    };\n    r.send();\n  }\n\n  function getFile(fileUrl, callback, nocachebuster) {\n    if (!fileUrl || !callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    var totalCacheRequests = 0;\n\n    function fileRequest() {\n      var url, str, separator;\n\n      if (_isCacheRunning) {\n        if (_isV2Running) {\n          url = BASE_CACHE_URL + \"files?url=\" + encodeURIComponent(fileUrl);\n        } else {\n          // configure url with cachebuster or not\n          url = (nocachebuster) ? BASE_CACHE_URL + \"?url=\" + encodeURIComponent(fileUrl) :\n          BASE_CACHE_URL + \"cb=\" + new Date().getTime() + \"?url=\" + encodeURIComponent(fileUrl);\n        }\n      } else {\n        if (nocachebuster) {\n          url = fileUrl;\n        } else {\n          str = fileUrl.split(\"?\");\n          separator = (str.length === 1) ? \"?\" : \"&\";\n          url = fileUrl + separator + \"cb=\" + new Date().getTime();\n        }\n      }\n\n      makeRequest(\"HEAD\", url);\n    }\n\n    function makeRequest(method, url) {\n      var xhr = new XMLHttpRequest(),\n        request = {\n          xhr: xhr,\n          url: url\n        };\n\n      if (_isCacheRunning) {\n        xhr.open(method, url, true);\n\n        xhr.addEventListener(\"loadend\", function () {\n          var status = xhr.status || 0;\n          if (status === 202) {\n              totalCacheRequests++;\n              if (totalCacheRequests < 3) {\n                setTimeout(function(){ makeRequest(method, url); }, 3000);                  \n              } else {\n                  callback(request, new Error(\"File is downloading\"));\n              }\n          } else if (status >= 200 && status < 300) {\n            callback(request);\n          } else {\n            // Server may not support HEAD request. Fallback to a GET request.\n            if (method === \"HEAD\") {\n              makeRequest(\"GET\", url);\n            } else {\n              callback(request, new Error(\"The request failed with status code: \" + status));\n            }\n          }\n        });\n\n        xhr.send();\n      }\n      else {\n        // Rise Cache is not running (preview), skip HEAD request and execute callback immediately\n        callback(request);\n      }\n\n    }\n\n    if (!_pingReceived) {\n      /* jshint validthis: true */\n      return this.ping(fileRequest);\n    } else {\n      return fileRequest();\n    }\n\n  }\n\n  function getErrorMessage(statusCode) {\n    var errorMessage = \"\";\n    switch (statusCode) {\n      case 502:\n        errorMessage = \"There was a problem retrieving the file.\";\n        break;\n      case 504:\n        errorMessage = \"Unable to download the file. The server is not responding.\";\n        break;\n      case 507:\n        errorMessage = \"There is not enough disk space to save the file on Rise Cache.\";\n        break;\n      case 534:\n        errorMessage = \"The file does not exist or cannot be accessed.\";\n        break;\n      default:\n        errorMessage = \"\";\n    }\n\n    return errorMessage;\n  }\n\n  function isRiseCacheRunning(callback) {\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    if (!_pingReceived) {\n      /* jshint validthis: true */\n      return this.ping(function () {\n        callback(_isCacheRunning);\n      });\n    } else {\n      callback(_isCacheRunning);\n    }\n  }\n\n  function isV2Running(callback) {\n    if (!callback || typeof callback !== \"function\") {\n      return;\n    }\n\n    if (!_pingReceived) {\n      /* jshint validthis: true */\n      return this.ping(function () {\n        callback(_isV2Running);\n      });\n    }\n    else {\n      callback(_isV2Running);\n    }\n  }\n\n  return {\n    getErrorMessage: getErrorMessage,\n    getFile: getFile,\n    isRiseCacheRunning: isRiseCacheRunning,\n    isV2Running: isV2Running,\n    ping: ping\n  };\n\n})();\n\n/* exported version */\nvar version = \"2.0.0\";\n/* exported config */\nif ( typeof angular !== \"undefined\" ) {\n  angular.module( \"risevision.common.i18n.config\", [] )\n    .constant( \"LOCALES_PREFIX\", \"locales/translation_\" )\n    .constant( \"LOCALES_SUFIX\", \".json\" );\n}\n\nconst config = {\n  STORAGE_ENV: \"prod\",\n  COMPONENTS_PATH: \"components/\"\n};\n\n/* global gadgets, _ */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = {};\n\nRiseVision.Video = ( function( window, gadgets ) {\n  \"use strict\";\n\n  var _additionalParams,\n    _mode,\n    _isLoading = true,\n    _configDetails = null,\n    _prefs = null,\n    _storage = null,\n    _nonStorage = null,\n    _message = null,\n    _player = null,\n    _viewerPaused = true,\n    _resume = true,\n    _currentFiles = [],\n    _currentPlaylistIndex = null,\n    _errorLog = null,\n    _errorTimer = null,\n    _errorFlag = false,\n    _storageErrorFlag = false,\n    _playerErrorFlag = false,\n    _unavailableFlag = false;\n\n  /*\n   *  Private Methods\n   */\n  function _done() {\n    gadgets.rpc.call( \"\", \"rsevent_done\", null, _prefs.getString( \"id\" ) );\n\n    // Any errors need to be logged before the done event.\n    if ( _errorLog !== null ) {\n      logEvent( _errorLog, true );\n    }\n\n    logEvent( { \"event\": \"done\" }, false );\n  }\n\n  function _ready() {\n    gadgets.rpc.call( \"\", \"rsevent_ready\", null, _prefs.getString( \"id\" ),\n      true, true, true, true, true );\n  }\n\n  function _clearErrorTimer() {\n    clearTimeout( _errorTimer );\n    _errorTimer = null;\n  }\n\n  function _startErrorTimer() {\n    _clearErrorTimer();\n\n    _errorTimer = setTimeout( function() {\n      // notify Viewer widget is done\n      _done();\n    }, 5000 );\n  }\n\n  function _getCurrentFile() {\n    if ( _currentFiles && _currentFiles.length > 0 ) {\n      if ( _mode === \"file\" ) {\n        return _currentFiles[ 0 ];\n      } else if ( _mode === \"folder\" ) {\n        if ( _currentPlaylistIndex ) {\n          // retrieve the currently played file\n          return _currentFiles[ _currentPlaylistIndex ];\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /*\n   *  Public Methods\n   */\n  function hasStorageError() {\n    return _storageErrorFlag;\n  }\n\n  function hasPlayerError() {\n    return _playerErrorFlag;\n  }\n\n  function showError( message, isStorageError ) {\n    _errorFlag = true;\n    _storageErrorFlag = typeof isStorageError !== \"undefined\";\n\n    _message.show( message );\n\n    _currentPlaylistIndex = null;\n\n    // if Widget is playing right now, run the timer\n    if ( !_viewerPaused ) {\n      _startErrorTimer();\n    }\n\n  }\n\n  function logEvent( params, isError ) {\n    if ( isError ) {\n      _errorLog = params;\n    }\n\n    if ( !params.file_url ) {\n      params.file_url = _getCurrentFile();\n    }\n\n    RiseVision.Common.LoggerUtils.logEvent( getTableName(), params );\n  }\n\n  function onFileInit( urls ) {\n    if ( _mode === \"file\" ) {\n      // urls value will be a string\n      _currentFiles[ 0 ] = urls;\n    } else if ( _mode === \"folder\" ) {\n      // urls value will be an array\n      _currentFiles = urls;\n    }\n\n    _unavailableFlag = false;\n\n    _message.hide();\n\n    if ( !_viewerPaused ) {\n      play();\n    }\n  }\n\n  function onFileRefresh( urls ) {\n    if ( _mode === \"file\" ) {\n      // urls value will be a string of one url\n      _currentFiles[ 0 ] = urls;\n    } else if ( _mode === \"folder\" ) {\n      // urls value will be an array of urls\n      _currentFiles = urls;\n    }\n\n    if ( _player ) {\n      _player.update( _currentFiles );\n    }\n\n    // in case refreshed file fixes an error with previous file, ensure flag is removed so playback is attempted again\n    _errorFlag = false;\n    _playerErrorFlag = false;\n    _storageErrorFlag = false;\n    _unavailableFlag = false;\n    _errorLog = null;\n  }\n\n  function onFileUnavailable( message ) {\n    _unavailableFlag = true;\n\n    _message.show( message );\n\n    _currentPlaylistIndex = null;\n\n    // if Widget is playing right now, run the timer\n    if ( !_viewerPaused ) {\n      _startErrorTimer();\n    }\n  }\n\n  function pause() {\n\n    _viewerPaused = true;\n\n    // in case error timer still running (no conditional check on errorFlag, it may have been reset in onFileRefresh)\n    _clearErrorTimer();\n\n    if ( _player ) {\n      if ( !_resume ) {\n        _currentPlaylistIndex = null;\n        _player.reset();\n      } else {\n        _player.pause();\n      }\n    }\n\n  }\n\n  function play() {\n    if ( _isLoading ) {\n      _isLoading = false;\n\n      // Log configuration event.\n      logEvent( {\n        event: \"configuration\",\n        event_details: _configDetails\n      }, false );\n    }\n\n    _viewerPaused = false;\n\n    logEvent( { \"event\": \"play\" }, false );\n\n    if ( _errorFlag ) {\n      _startErrorTimer();\n      return;\n    }\n\n    if ( _unavailableFlag ) {\n      if ( _mode === \"file\" && _storage ) {\n        _storage.retry();\n      }\n\n      return;\n    }\n\n    if ( _player ) {\n      // Ensures possible error messaging gets hidden and video gets shown\n      _message.hide();\n\n      _player.play();\n    } else {\n      if ( _currentFiles && _currentFiles.length > 0 ) {\n        _player = new RiseVision.Video.PlayerVJS( _additionalParams );\n        _player.init( _currentFiles );\n      }\n    }\n\n  }\n\n  function getTableName() {\n    return \"video_v2_events\";\n  }\n\n  function playerEnded() {\n    _currentPlaylistIndex = null;\n\n    _done();\n  }\n\n  function playerReady() {\n    // Ensures loading messaging is hidden and video gets shown\n    _message.hide();\n\n    if ( !_viewerPaused && _player ) {\n      _player.play();\n    }\n  }\n\n  function playerItemChange( index ) {\n    _currentPlaylistIndex = index;\n  }\n\n  function setAdditionalParams( params, mode ) {\n    var isStorageFile;\n\n    _additionalParams = _.clone( params );\n    _mode = mode;\n    _prefs = new gadgets.Prefs();\n\n    document.getElementById( \"container\" ).style.width = _prefs.getInt( \"rsW\" ) + \"px\";\n    document.getElementById( \"container\" ).style.height = _prefs.getInt( \"rsH\" ) + \"px\";\n\n    _additionalParams.width = _prefs.getInt( \"rsW\" );\n    _additionalParams.height = _prefs.getInt( \"rsH\" );\n\n    if ( _additionalParams.video.hasOwnProperty( \"resume\" ) ) {\n      _resume = _additionalParams.video.resume;\n    }\n\n    _message = new RiseVision.Common.Message( document.getElementById( \"container\" ),\n      document.getElementById( \"messageContainer\" ) );\n\n    if ( RiseVision.Common.Utilities.isLegacy() ) {\n      showError( \"This version of Video Widget is not supported on this version of Rise Player. \" +\n        \"Please use the latest Rise Player version available at https://help.risevision.com/user/create-a-display\" );\n    } else {\n      // show wait message while Storage initializes\n      _message.show( \"Please wait while your video is downloaded.\" );\n\n      if ( _mode === \"file\" ) {\n        isStorageFile = ( Object.keys( _additionalParams.storage ).length !== 0 );\n\n        if ( !isStorageFile ) {\n          _configDetails = \"custom\";\n\n          _nonStorage = new RiseVision.Video.NonStorage( _additionalParams );\n          _nonStorage.init();\n        } else {\n          _configDetails = \"storage file\";\n\n          // create and initialize the Storage file instance\n          _storage = new RiseVision.Video.StorageFile( _additionalParams );\n          _storage.init();\n        }\n      } else if ( _mode === \"folder\" ) {\n        _configDetails = \"storage folder\";\n\n        // create and initialize the Storage folder instance\n        _storage = new RiseVision.Video.StorageFolder( _additionalParams );\n        _storage.init();\n      }\n    }\n\n    _ready();\n  }\n\n  // An error occurred with JW Player.\n  function playerError( error ) {\n    var details = null,\n      params = {},\n      message = \"Sorry, there was a problem playing the video.\",\n      MEDIA_ERROR = \"Error loading media: File could not be played\",\n      YOUTUBE_ERROR = \"Error loading YouTube: Video could not be played\",\n      PLAYER_ERROR = \"Error loading player: No media sources found\",\n      PLAYLIST_ERROR = \"Error loading playlist: No playable sources found\",\n      ENCODING_MESSAGE = \"There was a problem playing that video. It could be that we don't \" +\n        \"support that format or it is not encoded correctly.\",\n      FORMAT_MESSAGE = \"The format of that video is not supported\";\n\n    if ( error ) {\n      if ( error.type && error.message ) {\n        details = error.type + \" - \" + error.message;\n      } else if ( error.type ) {\n        details = error.type;\n      } else if ( error.message ) {\n        details = error.message;\n      }\n\n      // Display appropriate on-screen error message.\n      if ( error.message ) {\n        if ( ( error.message === MEDIA_ERROR ) || ( error.message === YOUTUBE_ERROR ) ) {\n          message = ENCODING_MESSAGE;\n        } else if ( error.message === PLAYER_ERROR || error.message === PLAYLIST_ERROR ) {\n          message = FORMAT_MESSAGE;\n        }\n      }\n    }\n\n    params.event = \"player error\";\n    params.event_details = details;\n    _playerErrorFlag = true;\n\n    logEvent( params, true );\n    showError( message );\n  }\n\n  function stop() {\n    pause();\n  }\n\n  return {\n    \"getTableName\": getTableName,\n    \"hasPlayerError\": hasPlayerError,\n    \"hasStorageError\": hasStorageError,\n    \"logEvent\": logEvent,\n    \"onFileInit\": onFileInit,\n    \"onFileRefresh\": onFileRefresh,\n    \"onFileUnavailable\": onFileUnavailable,\n    \"pause\": pause,\n    \"play\": play,\n    \"setAdditionalParams\": setAdditionalParams,\n    \"showError\": showError,\n    \"playerEnded\": playerEnded,\n    \"playerReady\": playerReady,\n    \"playerError\": playerError,\n    \"playerItemChange\": playerItemChange,\n    \"stop\": stop\n  };\n\n} )( window, gadgets );\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.PlayerUtils = ( function() {\n  \"use strict\";\n\n  /*\n   *  Public  Methods\n   */\n  function getPlaylist( list ) {\n    var i,\n      playlist = [];\n\n    for ( i = 0; i < list.length; i += 1 ) {\n      playlist.push( {\n        file: list[ i ],\n        type: this.getVideoFileType( list[ i ] )\n      } );\n    }\n\n    return playlist;\n  }\n\n  function getVideoFileType( url ) {\n    var extensions = [ \".mp4\", \".webm\" ],\n      urlLowercase = url.toLowerCase(),\n      type = null,\n      i;\n\n    for ( i = 0; i <= extensions.length; i += 1 ) {\n      if ( urlLowercase.indexOf( extensions[ i ] ) !== -1 ) {\n        type = extensions[ i ].substr( extensions[ i ].lastIndexOf( \".\" ) + 1 );\n        break;\n      }\n    }\n\n    return type;\n  }\n\n  return {\n    \"getPlaylist\": getPlaylist,\n    \"getVideoFileType\": getVideoFileType\n  };\n\n} )();\n\n/* global config */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.StorageFile = function( data ) {\n  \"use strict\";\n\n  var _initialLoad = true,\n    utils = RiseVision.Common.Utilities,\n    riseCache = RiseVision.Common.RiseCache;\n\n  /*\n   *  Public Methods\n   */\n  function init() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    storage.addEventListener( \"rise-storage-response\", function( e ) {\n      if ( e.detail && e.detail.url ) {\n\n        if ( _initialLoad ) {\n          _initialLoad = false;\n\n          RiseVision.Video.onFileInit( e.detail.url );\n        } else {\n          // check for \"changed\" property\n          if ( e.detail.hasOwnProperty( \"changed\" ) ) {\n            if ( e.detail.changed ) {\n              RiseVision.Video.onFileRefresh( e.detail.url );\n            } else {\n              // in the event of a network failure and recovery, check if the Widget is in a state of storage error\n              if ( RiseVision.Video.hasStorageError() || RiseVision.Video.hasPlayerError() ) {\n                // proceed with refresh logic so the Widget can eventually play video again from a network recovery\n                RiseVision.Video.onFileRefresh( e.detail.url );\n              }\n            }\n          }\n        }\n      }\n    } );\n\n    storage.addEventListener( \"rise-storage-api-error\", function( e ) {\n      var params = {\n        \"event\": \"storage api error\",\n        \"event_details\": \"Response code: \" + e.detail.code + \", message: \" + e.detail.message\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-no-file\", function( e ) {\n      var params = { \"event\": \"storage file not found\", \"event_details\": e.detail };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected video does not exist or has been moved to Trash.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-file-throttled\", function( e ) {\n      var params = { \"event\": \"storage file throttled\", \"file_url\": e.detail };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected video is temporarily unavailable.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-expired\", function() {\n      var params = { \"event\": \"storage subscription expired\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Rise Storage subscription is not active.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-error\", function( e ) {\n      var params = {\n        \"event\": \"storage subscription error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n    } );\n\n    storage.addEventListener( \"rise-storage-error\", function( e ) {\n      var params = {\n        \"event\": \"rise storage error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\", true );\n    } );\n\n    storage.addEventListener( \"rise-cache-error\", function( e ) {\n      var params = {\n          \"event\": \"rise cache error\",\n          \"event_details\": e.detail.error.message\n        },\n        statusCode = 0,\n        errorMessage;\n\n      // log the error\n      RiseVision.Video.logEvent( params, true );\n\n      if ( riseCache.isV2Running() ) {\n        errorMessage = riseCache.getErrorMessage( statusCode );\n      } else {\n        // Show a different message if there is a 404 coming from rise cache\n        if ( e.detail.error.message ) {\n          statusCode = +e.detail.error.message.substring( e.detail.error.message.indexOf( \":\" ) + 2 );\n        }\n\n        errorMessage = utils.getRiseCacheErrorMessage( statusCode );\n      }\n\n      // show the error\n      RiseVision.Video.showError( errorMessage );\n    } );\n\n    storage.addEventListener( \"rise-cache-not-running\", function( e ) {\n\n      var params = {\n        \"event\": \"rise cache not running\",\n        \"event_details\": ( e.detail && e.detail.error ) ? e.detail.error.message : \"\"\n      };\n\n      RiseVision.Video.logEvent( params, true );\n    } );\n\n    storage.addEventListener( \"rise-cache-file-unavailable\", function() {\n      RiseVision.Video.onFileUnavailable( \"File is downloading\" );\n    } );\n\n    storage.setAttribute( \"folder\", data.storage.folder );\n    storage.setAttribute( \"fileName\", data.storage.fileName );\n    storage.setAttribute( \"companyId\", data.storage.companyId );\n    storage.setAttribute( \"env\", config.STORAGE_ENV );\n\n    // TODO: VideoJS with storage files, temporarily prevent this code executing\n    //storage.go();\n  }\n\n  function retry() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    // TODO: VideoJS with storage files, temporarily prevent this code executing\n    //storage.go();\n  }\n\n  return {\n    \"init\": init,\n    \"retry\": retry\n  };\n};\n\n/* global config, _ */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.StorageFolder = function( data ) {\n  \"use strict\";\n\n  var _initialLoad = true,\n    _files = [],\n    utils = RiseVision.Common.Utilities,\n    riseCache = RiseVision.Common.RiseCache;\n\n  function _getUrls() {\n    return _.pluck( _files, \"url\" );\n  }\n\n  function _getExistingFile( file ) {\n    return _.find( _files, function( f ) {\n      return file.name === f.name;\n    } );\n  }\n\n  function _deleteFile( file ) {\n    var existing = _getExistingFile( file );\n\n    if ( existing ) {\n      _files.splice( _files.indexOf( existing ), 1 );\n    }\n  }\n\n  function _changeFile( file ) {\n    var existing = _getExistingFile( file );\n\n    if ( existing ) {\n      existing.url = file.url;\n    }\n  }\n\n  function _addFile( file ) {\n    var existing = _getExistingFile( file );\n\n    if ( !existing ) {\n      // extract the actual file name and store in new property on file object\n      file.fileName = file.name.slice( file.name.lastIndexOf( \"/\" ) + 1, file.name.lastIndexOf( \".\" ) ).toLowerCase();\n\n      // insert file to _files list at specific index based on alphabetical order of file name\n      _files.splice( _.sortedIndex( _files, file, \"fileName\" ), 0, file );\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function init() {\n    var storage = document.getElementById( \"videoStorage\" );\n\n    if ( !storage ) {\n      return;\n    }\n\n    storage.addEventListener( \"rise-storage-response\", function( e ) {\n      var file = e.detail;\n\n      // Added\n      if ( file.added ) {\n        _addFile( file );\n\n        if ( _initialLoad ) {\n          _initialLoad = false;\n          RiseVision.Video.onFileInit( _getUrls() );\n\n          return;\n        }\n      }\n\n      // Changed or unchanged\n      if ( file.hasOwnProperty( \"changed\" ) ) {\n        if ( file.changed ) {\n          _changeFile( file );\n        } else {\n          // in the event of a network failure and recovery, check if the Widget is in a state of storage error\n          if ( !RiseVision.Video.hasStorageError() && !RiseVision.Video.hasPlayerError() ) {\n            // only proceed with refresh logic below if there's been a storage error, otherwise do nothing\n            // this is so the Widget can eventually play video again from a network recovery\n            return;\n          }\n        }\n      }\n\n      // Deleted\n      if ( file.deleted ) {\n        _deleteFile( file );\n      }\n\n      RiseVision.Video.onFileRefresh( _getUrls() );\n\n    } );\n\n    storage.addEventListener( \"rise-storage-api-error\", function( e ) {\n      var params = {\n        \"event\": \"storage api error\",\n        \"event_details\": \"Response code: \" + e.detail.code + \", message: \" + e.detail.message\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-empty-folder\", function() {\n      var params = { \"event\": \"storage folder empty\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected folder does not contain any videos.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-no-folder\", function( e ) {\n      var params = { \"event\": \"storage folder doesn't exist\", \"event_details\": e.detail };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected folder does not exist or has been moved to Trash.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-folder-invalid\", function() {\n      var params = { \"event\": \"storage folder format(s) invalid\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"The selected folder does not contain any supported video formats.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-expired\", function() {\n      var params = { \"event\": \"storage subscription expired\" };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Rise Storage subscription is not active.\" );\n    } );\n\n    storage.addEventListener( \"rise-storage-subscription-error\", function( e ) {\n      var params = {\n        \"event\": \"storage subscription error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n    } );\n\n    storage.addEventListener( \"rise-storage-error\", function( e ) {\n      var params = {\n        \"event\": \"rise storage error\",\n        \"event_details\": \"The request failed with status code: \" + e.detail.error.currentTarget.status\n      };\n\n      RiseVision.Video.logEvent( params, true );\n      RiseVision.Video.showError( \"Sorry, there was a problem communicating with Rise Storage.\", true );\n    } );\n\n    storage.addEventListener( \"rise-cache-error\", function( e ) {\n      var params = {\n          \"event\": \"rise cache error\",\n          \"event_details\": e.detail.error.message\n        },\n        statusCode = 0,\n        errorMessage;\n\n      RiseVision.Video.logEvent( params, true );\n\n      if ( riseCache.isV2Running() ) {\n        errorMessage = riseCache.getErrorMessage( statusCode );\n      } else {\n        // Show a different message if there is a 404 coming from rise cache\n        if ( e.detail.error.message ) {\n          statusCode = +e.detail.error.message.substring( e.detail.error.message.indexOf( \":\" ) + 2 );\n        }\n\n        errorMessage = utils.getRiseCacheErrorMessage( statusCode );\n      }\n\n      RiseVision.Video.showError( errorMessage );\n    } );\n\n    storage.addEventListener( \"rise-cache-not-running\", function( e ) {\n\n      var params = {\n        \"event\": \"rise cache not running\",\n        \"event_details\": ( e.detail && e.detail.error ) ? e.detail.error.message : \"\"\n      };\n\n      RiseVision.Video.logEvent( params, true );\n    } );\n\n    storage.setAttribute( \"fileType\", \"video\" );\n    storage.setAttribute( \"companyId\", data.storage.companyId );\n    storage.setAttribute( \"folder\", data.storage.folder );\n    storage.setAttribute( \"env\", config.STORAGE_ENV );\n\n    // TODO: VideoJS with storage files, temporarily prevent this code executing\n    //storage.go();\n  }\n\n  return {\n    \"init\": init\n  };\n};\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.NonStorage = function( data ) {\n  \"use strict\";\n\n  var riseCache = RiseVision.Common.RiseCache,\n    utils = RiseVision.Common.Utilities,\n    // 15 minutes\n    _refreshDuration = 900000,\n    _refreshIntervalId = null,\n    _isLoading = true,\n    _url = \"\";\n\n  function _getFile( omitCacheBuster ) {\n    riseCache.getFile( _url, function( response, error ) {\n      var statusCode = 0,\n        errorMessage;\n\n      if ( !error ) {\n\n        if ( _isLoading ) {\n          _isLoading = false;\n\n          RiseVision.Video.onFileInit( response.url );\n\n          // start the refresh interval\n          _startRefreshInterval();\n\n        } else {\n          RiseVision.Video.onFileRefresh( response.url );\n        }\n\n      } else {\n\n        if ( error.message && error.message === \"File is downloading\" ) {\n\n          RiseVision.Video.onFileUnavailable( error.message );\n\n        } else {\n\n          // error occurred\n          RiseVision.Video.logEvent( {\n            \"event\": \"non-storage error\",\n            \"event_details\": error.message,\n            \"file_url\": response.url\n          }, true );\n\n          if ( riseCache.isV2Running() ) {\n            errorMessage = riseCache.getErrorMessage( statusCode );\n          } else {\n            // Show a different message if there is a 404 coming from rise cache\n            if ( error.message ) {\n              statusCode = +error.message.substring( error.message.indexOf( \":\" ) + 2 );\n            }\n\n            errorMessage = utils.getRiseCacheErrorMessage( statusCode );\n          }\n\n          // show the error\n          RiseVision.Video.showError( errorMessage );\n        }\n      }\n    }, omitCacheBuster );\n  }\n\n  function _startRefreshInterval() {\n    if ( _refreshIntervalId === null ) {\n      _refreshIntervalId = setInterval( function() {\n        _getFile( false );\n      }, _refreshDuration );\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function init() {\n    // Handle pre-merge use of \"url\" setting property\n    _url = ( data.url && data.url !== \"\" ) ? data.url : data.selector.url;\n\n    _url = utils.addProtocol( _url );\n\n    _getFile( true );\n  }\n\n  return {\n    \"init\": init\n  };\n};\n\n/* global videojs */\n\nvar RiseVision = RiseVision || {};\n\nRiseVision.Video = RiseVision.Video || {};\n\nRiseVision.Video.PlayerVJS = function( params ) {\n  \"use strict\";\n\n  var _autoPlay = false,\n    _playerInstance = null,\n    _files = null,\n    _utils = RiseVision.Video.PlayerUtils,\n    _updateWaiting = false;\n\n  /*\n   *  Private Methods\n   */\n  function _disableFullscreen() {\n    var video = document.getElementById( \"player\" );\n\n    if ( video ) {\n      video.className += video.className ? \" vjs-nofull\" : \"vjs-nofull\";\n    }\n  }\n\n  function _getOptions() {\n    return {\n      autoplay: _autoPlay,\n      controls: params.video.controls,\n      fluid: params.video.scaleToFit,\n      height: params.height,\n      width: params.width\n    };\n  }\n\n  function _ready() {\n    if ( _files && _files.length && _files.length > 0 ) {\n      // set the source\n      _playerInstance.src( { type: \"video/\" + _utils.getVideoFileType( _files[ 0 ] ), src: _files[ 0 ] } );\n\n      if ( params.video && ( typeof params.video.volume !== \"undefined\" )\n        && Number.isInteger( params.video.volume ) ) {\n        _playerInstance.volume( params.video.volume / 100 );\n      }\n\n      // handle when video completes\n      _playerInstance.on( \"ended\", function() {\n        RiseVision.Video.playerEnded();\n      } );\n\n      // notify that player is ready\n      RiseVision.Video.playerReady();\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function init( files ) {\n    _files = files;\n    _autoPlay = ( !params.video.controls ) ? true : params.video.autoplay;\n\n    _disableFullscreen();\n\n    _playerInstance = videojs( \"player\", _getOptions(), function() {\n      _ready();\n    } );\n  }\n\n  function pause() {\n    if ( !_playerInstance.paused() ) {\n      _playerInstance.pause();\n    }\n  }\n\n  function play() {\n    if ( _updateWaiting ) {\n      _updateWaiting = false;\n      // set a new source\n\n      if ( _files && _files.length && _files.length > 0 ) {\n        _playerInstance.src( { type: \"video/\" + _utils.getVideoFileType( _files[ 0 ] ), src: _files[ 0 ] } );\n      }\n    }\n\n    if ( _autoPlay ) {\n      _playerInstance.play();\n    }\n  }\n\n  function reset() {\n    pause();\n\n    // if video is at end, a future play call will start video over from beginning automatically\n    if ( _playerInstance.remainingTime() > 0 ) {\n      _playerInstance.currentTime( 0 );\n    }\n  }\n\n  function update( files ) {\n    _files = files;\n    _updateWaiting = true;\n  }\n\n  return {\n    \"init\": init,\n    \"pause\": pause,\n    \"play\": play,\n    \"reset\": reset,\n    \"update\": update\n  };\n};\n\nvar RiseVision = RiseVision || {};\nRiseVision.Common = RiseVision.Common || {};\n\nRiseVision.Common.Message = function (mainContainer, messageContainer) {\n  \"use strict\";\n\n  var _active = false;\n\n  function _init() {\n    try {\n      messageContainer.style.height = mainContainer.style.height;\n    } catch (e) {\n      console.warn(\"Can't initialize Message - \", e.message);\n    }\n  }\n\n  /*\n   *  Public Methods\n   */\n  function hide() {\n    if (_active) {\n      // clear content of message container\n      while (messageContainer.firstChild) {\n        messageContainer.removeChild(messageContainer.firstChild);\n      }\n\n      // hide message container\n      messageContainer.style.display = \"none\";\n\n      // show main container\n      mainContainer.style.display = \"block\";\n\n      _active = false;\n    }\n  }\n\n  function show(message) {\n    var fragment = document.createDocumentFragment(),\n      p;\n\n    if (!_active) {\n      // hide main container\n      mainContainer.style.display = \"none\";\n\n      messageContainer.style.display = \"block\";\n\n      // create message element\n      p = document.createElement(\"p\");\n      p.innerHTML = message;\n      p.setAttribute(\"class\", \"message\");\n\n      fragment.appendChild(p);\n      messageContainer.appendChild(fragment);\n\n      _active = true;\n    } else {\n      // message already being shown, update message text\n      p = messageContainer.querySelector(\".message\");\n      p.innerHTML = message;\n    }\n  }\n\n  _init();\n\n  return {\n    \"hide\": hide,\n    \"show\": show\n  };\n};\n\n/* global gadgets, RiseVision, config, version */\n\n( function( window, gadgets ) {\n  \"use strict\";\n\n  var prefs = new gadgets.Prefs(),\n    id = prefs.getString( \"id\" );\n\n  // Disable context menu (right click menu)\n  window.oncontextmenu = function() {\n    return false;\n  };\n\n  function configure( names, values ) {\n    var additionalParams = null,\n      mode = \"\",\n      companyId = \"\",\n      displayId = \"\";\n\n    if ( Array.isArray( names ) && names.length > 0 && Array.isArray( values ) && values.length > 0 ) {\n      if ( names[ 0 ] === \"companyId\" ) {\n        companyId = values[ 0 ];\n      }\n\n      if ( names[ 1 ] === \"displayId\" ) {\n        if ( values[ 1 ] ) {\n          displayId = values[ 1 ];\n        } else {\n          displayId = \"preview\";\n        }\n      }\n\n      RiseVision.Common.LoggerUtils.setIds( companyId, displayId );\n      RiseVision.Common.LoggerUtils.setVersion( version );\n\n      if ( names[ 2 ] === \"additionalParams\" ) {\n        additionalParams = JSON.parse( values[ 2 ] );\n\n        if ( Object.keys( additionalParams.storage ).length !== 0 ) {\n          // storage file or folder selected\n          if ( !additionalParams.storage.fileName ) {\n            // folder was selected\n            mode = \"folder\";\n          } else {\n            // file was selected\n            mode = \"file\";\n          }\n        } else {\n          // non-storage file was selected\n          mode = \"file\";\n        }\n\n        RiseVision.Video.setAdditionalParams( additionalParams, mode );\n      }\n    }\n  }\n\n  function play() {\n    RiseVision.Video.play();\n  }\n\n  function pause() {\n    RiseVision.Video.pause();\n  }\n\n  function stop() {\n    RiseVision.Video.stop();\n  }\n\n  function init() {\n    if ( id && id !== \"\" ) {\n      gadgets.rpc.register( \"rscmd_play_\" + id, play );\n      gadgets.rpc.register( \"rscmd_pause_\" + id, pause );\n      gadgets.rpc.register( \"rscmd_stop_\" + id, stop );\n\n      gadgets.rpc.register( \"rsparam_set_\" + id, configure );\n      gadgets.rpc.call( \"\", \"rsparam_get\", null, id, [ \"companyId\", \"displayId\", \"additionalParams\" ] );\n    }\n  }\n\n  // check which version of Rise Cache is running and dynamically add rise-storage dependencies\n  RiseVision.Common.RiseCache.isV2Running( function( isV2 ) {\n    var fragment = document.createDocumentFragment(),\n      link = document.createElement( \"link\" ),\n      webcomponents = document.createElement( \"script\" ),\n      href = config.COMPONENTS_PATH + ( ( isV2 ) ? \"rise-storage-v2\" : \"rise-storage\" ) + \"/rise-storage.html\",\n      storage = document.createElement( \"rise-storage\" ),\n      storageReady = false,\n      polymerReady = false;\n\n    function onPolymerReady() {\n      window.removeEventListener( \"WebComponentsReady\", onPolymerReady );\n      polymerReady = true;\n\n      if ( storageReady && polymerReady ) {\n        init();\n      }\n    }\n\n    function onStorageReady() {\n      storage.removeEventListener( \"rise-storage-ready\", onStorageReady );\n      storageReady = true;\n\n      if ( storageReady && polymerReady ) {\n        init();\n      }\n    }\n\n    webcomponents.src = config.COMPONENTS_PATH + \"webcomponentsjs/webcomponents-lite.min.js\";\n    window.addEventListener( \"WebComponentsReady\", onPolymerReady );\n\n    // add the webcomponents polyfill source to the document head\n    document.getElementsByTagName( \"head\" )[ 0 ].appendChild( webcomponents );\n\n    link.setAttribute( \"rel\", \"import\" );\n    link.setAttribute( \"href\", href );\n\n    // add the rise-storage <link> element to document head\n    document.getElementsByTagName( \"head\" )[ 0 ].appendChild( link );\n\n    storage.setAttribute( \"id\", \"videoStorage\" );\n    storage.setAttribute( \"refresh\", 5 );\n\n    if ( isV2 ) {\n      storage.setAttribute( \"usage\", \"widget\" );\n    }\n\n    storage.addEventListener( \"rise-storage-ready\", onStorageReady );\n    fragment.appendChild( storage );\n\n    // add the <rise-storage> element to the body\n    document.body.appendChild( fragment );\n  } );\n\n} )( window, gadgets );\n\n\n\nvar _gaq = _gaq || [];\n\n_gaq.push(['_setAccount', 'UA-57092159-2']);\n_gaq.push(['_trackPageview']);\n\n(function() {\n  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n})();\n"]}