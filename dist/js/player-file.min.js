function configure(){}function doneEvent(){source.postMessage({event:"playerEnded"},origin)}function readyEvent(){source.postMessage({event:"playerReady"},origin)}function errorEvent(e){source.postMessage({event:"playerError",error:e},origin)}function playlistItemEvent(e){source.postMessage({event:"playerItemChange",index:e},origin)}function init(e,t){window.oncontextmenu=function(){return!1},width=e.width,height=e.height,controls=e.video.controls,volume=e.video.volume,stretching=e.video.scaleToFit?"uniform":"none",autoPlay=controls?e.video.autoplay:!0,e.video.pause?(e.video.pause="string"==typeof e.video.pause?parseInt(e.video.pause,10):e.video.pause,pauseDuration=isNaN(e.video.pause)?0:e.video.pause):pauseDuration=0,configure(t)}function load(){player.loadVideo()}function play(){player.play()}function pause(){"PLAYING"===player.getState().toUpperCase()&&player.pause()}function stop(){player.stop()}function remove(){player.remove()}function getVideoFileType(e){var t,o=[".mp4",".webm"],n=e.toLowerCase(),r=null;for(t=0;t<=o.length;t+=1)if(-1!==n.indexOf(o[t])){r=o[t].substr(o[t].lastIndexOf(".")+1);break}return r}function configure(e){file=e;var t=function(){return playerJW({file:file,type:getVideoFileType(file),width:width,height:height,controls:!1,skin:{name:"rise"},stretching:stretching})};player=t()}var controls,volume,autoPlay,stretching,pauseDuration,width,height,player=null,source=null,origin=null,playerJW=function(e){"use strict";function t(){doneEvent()}function o(){d||(clearTimeout(g),g=setTimeout(function(){jwplayer().play(),jwplayer().setControls(!1),jwplayer().setControls(!0)},1e3*pauseDuration))}function n(e){playlistItemEvent(e)}function r(e){e&&errorEvent({type:"video",message:e.message})}function a(e){e&&errorEvent({type:"setup",message:e.message})}function i(){jwplayer("player").setup(e),jwplayer().onSetupError(function(e){a(e)}),jwplayer().on("ready",function(){e.hasOwnProperty("playlist")?(jwplayer().on("playlistComplete",function(){t()}),jwplayer().on("playlistItem",function(e){n(e.index)})):e.hasOwnProperty("file")&&jwplayer().on("complete",function(){t()}),jwplayer().on("error",function(e){r(e)}),controls&&pauseDuration>1&&jwplayer().on("pause",function(){o()}),jwplayer().setVolume(volume),controls&&!autoPlay&&jwplayer().setControls(!0),readyEvent()})}function l(){d=!1,autoPlay&&(controls&&!jwplayer().getControls()&&jwplayer().setControls(!0),jwplayer().play(),controls&&(jwplayer().setControls(!1),jwplayer().setControls(!0)))}function s(){d=!0,clearTimeout(g),jwplayer().pause()}function u(){this.pause()}function p(){d=!1,clearTimeout(g),g=null,jwplayer().remove()}function c(){return jwplayer().getDuration()}function y(){return jwplayer().getPosition()}function f(){return jwplayer().getState()}var d=!1,g=null;return{getDuration:c,getPosition:y,getState:f,loadVideo:i,play:l,pause:s,onPlayerError:r,onSetupError:a,stop:u,remove:p}};window.addEventListener("message",function(e){if(origin=e.origin||e.originalEvent.origin,"http://s3.amazonaws.com"!==origin&&"http://localhost:8000"!==origin)return origin=null,void 0;if(source=e.source,e.data&&"object"==typeof e.data&&e.data.event)switch(e.data.event){case"init":init(e.data.params,e.data.files),load();break;case"play":play();break;case"pause":pause();break;case"stop":stop();break;case"remove":remove()}});var file;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3BsYXllci1maWxlLm1pbi5qcyJdLCJuYW1lcyI6WyJjb25maWd1cmUiLCJkb25lRXZlbnQiLCJzb3VyY2UiLCJwb3N0TWVzc2FnZSIsImV2ZW50Iiwib3JpZ2luIiwicmVhZHlFdmVudCIsImVycm9yRXZlbnQiLCJkYXRhIiwiZXJyb3IiLCJwbGF5bGlzdEl0ZW1FdmVudCIsImluZGV4IiwiaW5pdCIsInBhcmFtcyIsInVybHMiLCJ3aW5kb3ciLCJvbmNvbnRleHRtZW51Iiwid2lkdGgiLCJoZWlnaHQiLCJjb250cm9scyIsInZpZGVvIiwidm9sdW1lIiwic3RyZXRjaGluZyIsImF1dG9QbGF5IiwiYXV0b3BsYXkiLCJwYXVzZSIsInBhcnNlSW50IiwicGF1c2VEdXJhdGlvbiIsImlzTmFOIiwibG9hZCIsInBsYXllciIsImxvYWRWaWRlbyIsInBsYXkiLCJnZXRTdGF0ZSIsInRvVXBwZXJDYXNlIiwic3RvcCIsInJlbW92ZSIsImdldFZpZGVvRmlsZVR5cGUiLCJ1cmwiLCJpIiwiZXh0ZW5zaW9ucyIsInVybExvd2VyY2FzZSIsInRvTG93ZXJDYXNlIiwidHlwZSIsImxlbmd0aCIsImluZGV4T2YiLCJzdWJzdHIiLCJsYXN0SW5kZXhPZiIsImZpbGUiLCJmaWxlUGxheWVyIiwicGxheWVySlciLCJza2luIiwibmFtZSIsInNldHVwT2JqIiwiX29uQ29tcGxldGUiLCJfb25QYXVzZSIsInZpZXdlclBhdXNlZCIsImNsZWFyVGltZW91dCIsInBhdXNlVGltZXIiLCJzZXRUaW1lb3V0IiwiandwbGF5ZXIiLCJzZXRDb250cm9scyIsIl9vblBsYXlsaXN0SXRlbSIsIm9uUGxheWVyRXJyb3IiLCJtZXNzYWdlIiwib25TZXR1cEVycm9yIiwic2V0dXAiLCJvbiIsImhhc093blByb3BlcnR5Iiwic2V0Vm9sdW1lIiwiZ2V0Q29udHJvbHMiLCJ0aGlzIiwiZ2V0RHVyYXRpb24iLCJnZXRQb3NpdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJvcmlnaW5hbEV2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LEtBQUtKLE1BQzdELE9BQVFBLEVBQU1JLEtBQUtKLE9BQ2pCLElBQUssT0FDSFEsS0FBS1IsRUFBTUksS0FBS0ssT0FBUVQsRUFBTUksS0FBS29FLE9BQ25DL0MsTUFFQSxNQUNGLEtBQUssT0FDSEcsTUFDQSxNQUNGLEtBQUssUUFDSFAsT0FDQSxNQUNGLEtBQUssT0FDSFUsTUFDQSxNQUNGLEtBQUssU0FDSEMsV0FNUixJQUFJWSIsImZpbGUiOiJqcy9wbGF5ZXItZmlsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29udHJvbHMsIHZvbHVtZSwgYXV0b1BsYXksIHN0cmV0Y2hpbmcsIHBhdXNlRHVyYXRpb247XG52YXIgd2lkdGgsIGhlaWdodDtcblxudmFyIHBsYXllciA9IG51bGw7XG5cbnZhciBzb3VyY2UgPSBudWxsLFxuICBvcmlnaW4gPSBudWxsO1xuXG4vLyBPVkVSUklERTogbWV0aG9kIHRvIGRpc3Rpbmd1aXNoIGNvbmZpZ3VyYXRpb25zIGJldHdlZW4gZmlsZSBhbmQgZm9sZGVyXG5mdW5jdGlvbiBjb25maWd1cmUodXJscyl7fVxuXG5mdW5jdGlvbiBkb25lRXZlbnQoKSB7XG4gIHNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgZXZlbnQ6IFwicGxheWVyRW5kZWRcIlxuICB9LCBvcmlnaW4pO1xufVxuXG5mdW5jdGlvbiByZWFkeUV2ZW50KCkge1xuICBzb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgIGV2ZW50OiBcInBsYXllclJlYWR5XCJcbiAgfSwgb3JpZ2luKTtcblxufVxuXG5mdW5jdGlvbiBlcnJvckV2ZW50KGRhdGEpIHtcbiAgc291cmNlLnBvc3RNZXNzYWdlKHtcbiAgICBldmVudDogXCJwbGF5ZXJFcnJvclwiLFxuICAgIGVycm9yOiBkYXRhXG4gIH0sIG9yaWdpbik7XG59XG5cbmZ1bmN0aW9uIHBsYXlsaXN0SXRlbUV2ZW50KGluZGV4KSB7XG4gIHNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgZXZlbnQ6IFwicGxheWVySXRlbUNoYW5nZVwiLFxuICAgIGluZGV4OiBpbmRleFxuICB9LCBvcmlnaW4pO1xufVxuXG5mdW5jdGlvbiBpbml0KHBhcmFtcywgdXJscykge1xuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB3aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgY29udHJvbHMgPSBwYXJhbXMudmlkZW8uY29udHJvbHM7XG4gIHZvbHVtZSA9IHBhcmFtcy52aWRlby52b2x1bWU7XG4gIHN0cmV0Y2hpbmcgPSAocGFyYW1zLnZpZGVvLnNjYWxlVG9GaXQpID8gXCJ1bmlmb3JtXCIgOiBcIm5vbmVcIjtcblxuICAvLyBlbnN1cmUgYXV0b1BsYXkgaXMgdHJ1ZSBpZiBjb250cm9scyB2YWx1ZSBpcyBmYWxzZSwgb3RoZXJ3aXNlIHVzZSBwYXJhbXMgdmFsdWVcbiAgYXV0b1BsYXkgPSAoIWNvbnRyb2xzKSA/IHRydWUgOiBwYXJhbXMudmlkZW8uYXV0b3BsYXk7XG5cbiAgLy8gY2hlY2sgaWYgdGhpcyBzZXR0aW5nIGV4aXN0cyBkdWUgdG8gbWVyZ2Ugb2YgZmlsZSBhbmQgZm9sZGVyXG4gIGlmIChwYXJhbXMudmlkZW8ucGF1c2UpIHtcbiAgICAvLyBjb252ZXJ0IHBhdXNlIHZhbHVlIHRvIG51bWJlciBpZiB0eXBlIGlzIFwic3RyaW5nXCJcbiAgICBwYXJhbXMudmlkZW8ucGF1c2UgPSAodHlwZW9mIHBhcmFtcy52aWRlby5wYXVzZSA9PT0gXCJzdHJpbmdcIikgPyBwYXJzZUludChwYXJhbXMudmlkZW8ucGF1c2UsIDEwKSA6IHBhcmFtcy52aWRlby5wYXVzZTtcblxuICAgIC8vIGlmIG5vdCBvZiB0eXBlIFwibnVtYmVyXCIsIHNldCBpdHMgdmFsdWUgdG8gMCBzbyBhIHBhdXNlIGRvZXMgbm90IGdldCBhcHBsaWVkXG4gICAgcGF1c2VEdXJhdGlvbiA9IChpc05hTihwYXJhbXMudmlkZW8ucGF1c2UpKSA/IDAgOiBwYXJhbXMudmlkZW8ucGF1c2U7XG4gIH0gZWxzZSB7XG4gICAgLy8gZW5zdXJlIG5vIHBhdXNlIGR1cmF0aW9uIG9jY3Vyc1xuICAgIHBhdXNlRHVyYXRpb24gPSAwO1xuICB9XG5cbiAgY29uZmlndXJlKHVybHMpO1xufVxuXG5mdW5jdGlvbiBsb2FkKCkge1xuICBwbGF5ZXIubG9hZFZpZGVvKCk7XG59XG5cbmZ1bmN0aW9uIHBsYXkoKSB7XG4gIHBsYXllci5wbGF5KCk7XG59XG5cbmZ1bmN0aW9uIHBhdXNlKCkge1xuICAvLyBPbmx5IHBhdXNlIHZpZGVvIGlmIGl0J3MgYWN0dWFsbHkgcGxheWluZy5cbiAgaWYgKHBsYXllci5nZXRTdGF0ZSgpLnRvVXBwZXJDYXNlKCkgPT09IFwiUExBWUlOR1wiKSB7XG4gICAgcGxheWVyLnBhdXNlKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3RvcCgpIHtcbiAgcGxheWVyLnN0b3AoKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlKCkge1xuICBwbGF5ZXIucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIGdldFZpZGVvRmlsZVR5cGUgKHVybCkge1xuICB2YXIgZXh0ZW5zaW9ucyA9IFtcIi5tcDRcIiwgXCIud2VibVwiXSxcbiAgICB1cmxMb3dlcmNhc2UgPSB1cmwudG9Mb3dlckNhc2UoKSxcbiAgICB0eXBlID0gbnVsbCxcbiAgICBpO1xuXG4gIGZvciAoaSA9IDA7IGkgPD0gZXh0ZW5zaW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGlmICh1cmxMb3dlcmNhc2UuaW5kZXhPZihleHRlbnNpb25zW2ldKSAhPT0gLTEpIHtcbiAgICAgIHR5cGUgPSBleHRlbnNpb25zW2ldLnN1YnN0cihleHRlbnNpb25zW2ldLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHR5cGU7XG59XG5cbi8vIGluaGVyaXQgZnJvbSBwbGF5ZXJKVyBmb3IgYSBjdXN0b21pemVkIGZpbGUgb3IgZm9sZGVyIHBsYXllclxudmFyIHBsYXllckpXID0gZnVuY3Rpb24gKHNldHVwT2JqKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciB2aWV3ZXJQYXVzZWQgPSBmYWxzZTtcbiAgdmFyIHBhdXNlVGltZXIgPSBudWxsO1xuXG4gIGZ1bmN0aW9uIF9vbkNvbXBsZXRlKCkge1xuICAgIGRvbmVFdmVudCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gX29uUGF1c2UoKSB7XG4gICAgaWYgKCF2aWV3ZXJQYXVzZWQpIHtcbiAgICAgIC8vIHVzZXIgaGFzIHBhdXNlZCwgc2V0IGEgdGltZXIgdG8gcGxheSBhZ2FpblxuICAgICAgY2xlYXJUaW1lb3V0KHBhdXNlVGltZXIpO1xuXG4gICAgICBwYXVzZVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGNvbnRpbnVlIHBsYXlpbmcgdGhlIGN1cnJlbnQgdmlkZW9cbiAgICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG5cbiAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgY29udHJvbHMgcmVtYWluaW5nIHZpc2libGUsIHR1cm4gdGhlbSBvZmYgYW5kIG9uIGFnYWluXG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHMoZmFsc2UpO1xuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKHRydWUpO1xuXG4gICAgICB9LCBwYXVzZUR1cmF0aW9uICogMTAwMCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gX29uUGxheWxpc3RJdGVtKGluZGV4KSB7XG4gICAgcGxheWxpc3RJdGVtRXZlbnQoaW5kZXgpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25QbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3JFdmVudCh7XG4gICAgICAgIHR5cGU6IFwidmlkZW9cIixcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25TZXR1cEVycm9yKGVycm9yKSB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBlcnJvckV2ZW50KHtcbiAgICAgICAgdHlwZTogXCJzZXR1cFwiLFxuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkVmlkZW8oKSB7XG4gICAgandwbGF5ZXIoXCJwbGF5ZXJcIikuc2V0dXAoc2V0dXBPYmopO1xuXG4gICAgandwbGF5ZXIoKS5vblNldHVwRXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBvblNldHVwRXJyb3IoZXJyb3IpO1xuICAgIH0pO1xuXG4gICAgandwbGF5ZXIoKS5vbihcInJlYWR5XCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICBpZiAoc2V0dXBPYmouaGFzT3duUHJvcGVydHkoXCJwbGF5bGlzdFwiKSkge1xuICAgICAgICAvLyBmb2xkZXIsIGxpc3RlbiBmb3IgcGxheWxpc3QgY29tcGxldGUgZXZlbnRcbiAgICAgICAgandwbGF5ZXIoKS5vbihcInBsYXlsaXN0Q29tcGxldGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF9vbkNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGZvbGRlciwgbGlzdGVuIGZvciB3aGVuIGEgcGxheWxpc3QgaXRlbSBjaGFuZ2VzXG4gICAgICAgIGp3cGxheWVyKCkub24oXCJwbGF5bGlzdEl0ZW1cIiwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIF9vblBsYXlsaXN0SXRlbShkYXRhLmluZGV4KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChzZXR1cE9iai5oYXNPd25Qcm9wZXJ0eShcImZpbGVcIikpIHtcbiAgICAgICAgLy8gZmlsZSwgbGlzdGVuIGZvciBzaW5nbGUgZmlsZSBjb21wbGV0ZSBldmVudFxuICAgICAgICBqd3BsYXllcigpLm9uKFwiY29tcGxldGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF9vbkNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBqd3BsYXllcigpLm9uKFwiZXJyb3JcIiwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIG9uUGxheWVyRXJyb3IoZXJyb3IpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChjb250cm9scyAmJiBwYXVzZUR1cmF0aW9uID4gMSkge1xuICAgICAgICBqd3BsYXllcigpLm9uKFwicGF1c2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF9vblBhdXNlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBqd3BsYXllcigpLnNldFZvbHVtZSh2b2x1bWUpO1xuXG4gICAgICBpZiAoY29udHJvbHMgJiYgIWF1dG9QbGF5KSB7XG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHModHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIHJlYWR5RXZlbnQoKTtcblxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICB2aWV3ZXJQYXVzZWQgPSBmYWxzZTtcblxuICAgIGlmIChhdXRvUGxheSkge1xuICAgICAgaWYgKGNvbnRyb2xzICYmICFqd3BsYXllcigpLmdldENvbnRyb2xzKCkpIHtcbiAgICAgICAgLy8gV2lsbCBiZSBmaXJzdCB0aW1lIHBsYXllciBpcyBiZWluZyB0b2xkIHRvIHBsYXkgc28gZG9pbmcgdGhpcyBoZXJlIGFuZCBub3QgaW4gc2V0dXAgc28gdGhhdCBjb250cm9sc1xuICAgICAgICAvLyBhcmVuJ3QgdmlzaWJsZSB1cG9uIHBsYXlpbmcgZm9yIHRoZSBmaXJzdCB0aW1lLlxuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKHRydWUpO1xuICAgICAgfVxuXG4gICAgICBqd3BsYXllcigpLnBsYXkoKTtcblxuICAgICAgaWYgKGNvbnRyb2xzKSB7XG4gICAgICAgIC8vIHdvcmthcm91bmQgZm9yIGNvbnRyb2xzIHJlbWFpbmluZyB2aXNpYmxlLCB0dXJuIHRoZW0gb2ZmIGFuZCBvbiBhZ2FpblxuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKGZhbHNlKTtcbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICB2aWV3ZXJQYXVzZWQgPSB0cnVlO1xuICAgIGNsZWFyVGltZW91dChwYXVzZVRpbWVyKTtcbiAgICBqd3BsYXllcigpLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIHRoaXMucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICB2aWV3ZXJQYXVzZWQgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQocGF1c2VUaW1lcik7XG4gICAgcGF1c2VUaW1lciA9IG51bGw7XG4gICAgandwbGF5ZXIoKS5yZW1vdmUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldER1cmF0aW9uKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldER1cmF0aW9uKCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRQb3NpdGlvbigpIHtcbiAgICByZXR1cm4gandwbGF5ZXIoKS5nZXRQb3NpdGlvbigpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U3RhdGUoKSB7XG4gICAgcmV0dXJuIGp3cGxheWVyKCkuZ2V0U3RhdGUoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZ2V0RHVyYXRpb246IGdldER1cmF0aW9uLFxuICAgIGdldFBvc2l0aW9uOiBnZXRQb3NpdGlvbixcbiAgICBnZXRTdGF0ZTogZ2V0U3RhdGUsXG4gICAgbG9hZFZpZGVvOiBsb2FkVmlkZW8sXG4gICAgcGxheTogcGxheSxcbiAgICBwYXVzZTogcGF1c2UsXG4gICAgb25QbGF5ZXJFcnJvcjogb25QbGF5ZXJFcnJvcixcbiAgICBvblNldHVwRXJyb3I6IG9uU2V0dXBFcnJvcixcbiAgICBzdG9wOiBzdG9wLFxuICAgIHJlbW92ZTogcmVtb3ZlXG4gIH1cbn07XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBmdW5jdGlvbihldmVudCkge1xuICBvcmlnaW4gPSBldmVudC5vcmlnaW4gfHwgZXZlbnQub3JpZ2luYWxFdmVudC5vcmlnaW47XG5cbiAgLy8gZW5zdXJlIHRoaXMgbWVzc2FnZSBpcyBjb21pbmcgZnJvbSBBbWF6b24gUzMgKHdpZGdldCkgb3IgcHJldmlldyBhcHAgKGxvY2FsIHdpZGdldClcbiAgaWYgKG9yaWdpbiAhPT0gXCJodHRwOi8vczMuYW1hem9uYXdzLmNvbVwiICYmIG9yaWdpbiAhPT0gXCJodHRwOi8vbG9jYWxob3N0OjgwMDBcIikge1xuICAgIG9yaWdpbiA9IG51bGw7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc291cmNlID0gZXZlbnQuc291cmNlO1xuXG4gIGlmIChldmVudC5kYXRhICYmIHR5cGVvZiBldmVudC5kYXRhID09PSBcIm9iamVjdFwiICYmIGV2ZW50LmRhdGEuZXZlbnQpIHtcbiAgICBzd2l0Y2ggKGV2ZW50LmRhdGEuZXZlbnQpIHtcbiAgICAgIGNhc2UgXCJpbml0XCIgOlxuICAgICAgICBpbml0KGV2ZW50LmRhdGEucGFyYW1zLCBldmVudC5kYXRhLmZpbGVzKTtcbiAgICAgICAgbG9hZCgpO1xuXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInBsYXlcIjpcbiAgICAgICAgcGxheSgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJwYXVzZVwiOlxuICAgICAgICBwYXVzZSgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJzdG9wXCI6XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicmVtb3ZlXCI6XG4gICAgICAgIHJlbW92ZSgpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cbn0pO1xuXG52YXIgZmlsZTtcblxuZnVuY3Rpb24gY29uZmlndXJlKHVybHMpe1xuICBmaWxlID0gdXJscztcblxuICB2YXIgZmlsZVBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gcGxheWVySlcoe1xuICAgICAgZmlsZTogZmlsZSxcbiAgICAgIHR5cGU6IGdldFZpZGVvRmlsZVR5cGUoZmlsZSksXG4gICAgICB3aWR0aCA6IHdpZHRoLFxuICAgICAgaGVpZ2h0IDogaGVpZ2h0LFxuICAgICAgY29udHJvbHM6IGZhbHNlLFxuICAgICAgc2tpbjoge1xuICAgICAgICBuYW1lOiBcInJpc2VcIlxuICAgICAgfSxcbiAgICAgIHN0cmV0Y2hpbmcgOiBzdHJldGNoaW5nXG4gICAgfSk7XG4gIH07XG5cbiAgcGxheWVyID0gZmlsZVBsYXllcigpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
