if("undefined"==typeof config){var config={};"undefined"!=typeof angular&&(angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","components/rv-common-i18n/dist/locales/translation_").constant("LOCALES_SUFIX",".json"),angular.module("risevision.widget.common.storage-selector.config").value("STORAGE_MODAL","http://storage.risevision.com/~rvi/storage-client-rva-test/storage-modal.html#/files/"))}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e,t){"use strict";function i(){t.rpc.call("","rsevent_done",null,g.getString("id"))}function n(){t.rpc.call("","rsevent_ready",null,g.getString("id"),!0,!0,!0,!0,!0)}function o(){y=new RiseVision.Video.Player(m,p),y.init()}function a(){y.pause()}function s(){y.isInitialPlay()?m.video.autoplay&&y.play():y.userPaused()||y.play()}function r(){n()}function d(e){p=e}function c(i){g=new t.Prefs,m=i,e.getElementById("videoContainer").style.height=g.getInt("rsH")+"px",f=new RiseVision.Video.Background(m,p),f.init()}function u(){a()}function l(){i()}var g=null,m={},p=null,f=null,y=null;return{backgroundReady:o,pause:a,play:s,setCompanyId:d,setAdditionalParams:c,playerReady:r,stop:u,videoEnded:l}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Background=function(e,t){"use strict";function i(){var i=document.getElementById("background"),n=document.getElementById("backgroundStorage");document.body.style.background=e.background.color,e.background.useImage?(i.className=e.background.image.position,i.className=e.background.image.scale?i.className+" scale-to-fit":i.className,0===Object.keys(e.backgroundStorage).length?(i.style.backgroundImage="url("+e.background.image.url+")",RiseVision.Video.backgroundReady()):(n.addEventListener("rise-storage-response",function(e){i.style.backgroundImage="url("+e.detail[0]+")",RiseVision.Video.backgroundReady()}),n.setAttribute("folder",e.backgroundStorage.folder),n.setAttribute("fileName",e.backgroundStorage.fileName),n.setAttribute("companyId",t),n.go())):RiseVision.Video.backgroundReady()}return{init:i}};var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Player=function(e,t){"use strict";function i(){var t=e.url.substr(e.url.lastIndexOf(".")+1);return"ogv"===t&&(t="ogg"),t}function n(){p.style.visibility="visible",m.removeEventListener("loadeddata",n,!1)}function o(){RiseVision.Video.playerReady(),m.removeEventListener("canplay",o,!1)}function a(){y=!1,RiseVision.Video.videoEnded()}function s(){y=!v}function r(){f=!1,y=!1}function d(){return f}function c(){var d=document.getElementById("videoStorage"),c=document.createDocumentFragment(),u=c.appendChild(document.createElement("source")),l=document.createAttribute("src"),g=document.createAttribute("type");m.volume=e.video.volume/100,g.value="video/"+i(),u.setAttributeNode(g),m.addEventListener("loadeddata",n,!1),m.addEventListener("canplay",o,!1),m.addEventListener("ended",a,!1),m.addEventListener("pause",s,!1),m.addEventListener("play",r,!1),0===Object.keys(e.videoStorage).length?(l.value=e.url,u.setAttributeNode(l),m.appendChild(c)):(d.addEventListener("rise-storage-response",function(e){l.value=e.detail[0],u.setAttributeNode(l),m.appendChild(c)}),d.setAttribute("folder",e.videoStorage.folder),d.setAttribute("fileName",e.videoStorage.fileName),d.setAttribute("companyId",t),d.go())}function u(){v=!0,m.pause()}function l(){f=!1,v=!1,m.play()}function g(){return y}var m=document.getElementById("video"),p=document.getElementById("videoContainer"),f=!0,y=!1,v=!1;return{isInitialPlay:d,init:c,pause:u,play:l,userPaused:g}},function(e,t){"use strict";function i(){RiseVision.Video.play()}function n(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function a(e,t){Array.isArray(e)&&e.length>0&&"additionalParams"===e[0]&&Array.isArray(t)&&t.length>0&&RiseVision.Video.setAdditionalParams(JSON.parse(t[0]))}function s(e,i){e&&"companyId"===e&&RiseVision.Video.setCompanyId(i),t.rpc.register("rsparam_set_"+d,a),t.rpc.call("","rsparam_get",null,d,["additionalParams"])}var r=new t.Prefs,d=r.getString("id");e.oncontextmenu=function(){return!1},d&&""!==d&&(t.rpc.register("rscmd_play_"+d,i),t.rpc.register("rscmd_pause_"+d,n),t.rpc.register("rscmd_stop_"+d,o),t.rpc.register("rsparam_set_"+d,s),t.rpc.call("","rsparam_get",null,d,"companyId"))}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFsdWUiLCJSaXNlVmlzaW9uIiwiVmlkZW8iLCJkb2N1bWVudCIsImdhZGdldHMiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJiYWNrZ3JvdW5kUmVhZHkiLCJfcGxheWVyIiwiUGxheWVyIiwiX2FkZGl0aW9uYWxQYXJhbXMiLCJfY29tcGFueUlkIiwiaW5pdCIsInBhdXNlIiwicGxheSIsImlzSW5pdGlhbFBsYXkiLCJ2aWRlbyIsImF1dG9wbGF5IiwidXNlclBhdXNlZCIsInBsYXllclJlYWR5Iiwic2V0Q29tcGFueUlkIiwic2V0QWRkaXRpb25hbFBhcmFtcyIsInBhcmFtcyIsIlByZWZzIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImhlaWdodCIsImdldEludCIsIl9iYWNrZ3JvdW5kIiwiQmFja2dyb3VuZCIsInN0b3AiLCJ2aWRlb0VuZGVkIiwiZGF0YSIsImNvbXBhbnlJZCIsImJhY2tncm91bmQiLCJzdG9yYWdlIiwiYm9keSIsImNvbG9yIiwidXNlSW1hZ2UiLCJjbGFzc05hbWUiLCJpbWFnZSIsInBvc2l0aW9uIiwic2NhbGUiLCJPYmplY3QiLCJrZXlzIiwiYmFja2dyb3VuZFN0b3JhZ2UiLCJsZW5ndGgiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJ1cmwiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImRldGFpbCIsInNldEF0dHJpYnV0ZSIsImZvbGRlciIsImZpbGVOYW1lIiwiZ28iLCJfZ2V0VmlkZW9GaWxlVHlwZSIsInR5cGUiLCJzdWJzdHIiLCJsYXN0SW5kZXhPZiIsIl9vbkxvYWRlZERhdGEiLCJfdmlkZW9Db250YWluZXIiLCJ2aXNpYmlsaXR5IiwiX3ZpZGVvIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9vbkNhblBsYXkiLCJfb25FbmRlZCIsIl91c2VyUGF1c2VkIiwiX29uUGF1c2UiLCJfdmlld2VyUGF1c2VkIiwiX29uUGxheSIsIl9pbml0aWFsUGxheSIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsInNvdXJjZSIsImFwcGVuZENoaWxkIiwiY3JlYXRlRWxlbWVudCIsInNyY0F0dHIiLCJjcmVhdGVBdHRyaWJ1dGUiLCJ0eXBlQXR0ciIsInZvbHVtZSIsInNldEF0dHJpYnV0ZU5vZGUiLCJ2aWRlb1N0b3JhZ2UiLCJ3aW5kb3ciLCJhZGRpdGlvbmFsUGFyYW1zIiwibmFtZXMiLCJ2YWx1ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJKU09OIiwicGFyc2UiLCJuYW1lIiwicmVnaXN0ZXIiLCJpZCIsInByZWZzIiwib25jb250ZXh0bWVudSIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJhc3luYyIsInNyYyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIl0sIm1hcHBpbmdzIjoiQUFFQSxHQUFzQixtQkFBWEEsUUFBd0IsQ0FDakMsR0FBSUEsVUFJbUIsb0JBQVpDLFdBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHVEQUMzQkEsU0FBUyxnQkFBaUIsU0FFN0JGLFFBQVFDLE9BQU8sb0RBQ1pFLE1BQU0sZ0JBQWlCLDBGQU05QixHQUFJQyxZQUFhQSxjQUNqQkEsWUFBV0MsU0FFWEQsV0FBV0MsTUFBUSxTQUFXQyxFQUFVQyxHQUN0QyxZQVdBLFNBQVNDLEtBQ1BELEVBQVFFLElBQUlDLEtBQUssR0FBSSxlQUFnQixLQUFNQyxFQUFPQyxVQUFVLE9BSTlELFFBQVNDLEtBQ1BOLEVBQVFFLElBQUlDLEtBQUssR0FBSSxnQkFBaUIsS0FBTUMsRUFBT0MsVUFBVSxPQUMzRCxHQUFNLEdBQU0sR0FBTSxHQUFNLEdBTTVCLFFBQVNFLEtBRVBDLEVBQVUsR0FBSVgsWUFBV0MsTUFBTVcsT0FBT0MsRUFBbUJDLEdBQ3pESCxFQUFRSSxPQUdWLFFBQVND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QyxLQUFPLGtCQUFtQnlDLEVBQUdDLE9BQVEsRUFDbkZELEVBQUdFLEtBQU8sVUFBWXJHLFNBQVNzRyxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJeEcsU0FBU3lHLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFSLEVBQUlLIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgLy8gdmFyaWFibGVzIGdvIGhlcmVcbiAgfTtcblxuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBhbmd1bGFyLm1vZHVsZShcInJpc2V2aXNpb24uY29tbW9uLmkxOG4uY29uZmlnXCIsIFtdKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19QUkVGSVhcIiwgXCJjb21wb25lbnRzL3J2LWNvbW1vbi1pMThuL2Rpc3QvbG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi53aWRnZXQuY29tbW9uLnN0b3JhZ2Utc2VsZWN0b3IuY29uZmlnXCIpXG4gICAgICAudmFsdWUoXCJTVE9SQUdFX01PREFMXCIsIFwiaHR0cDovL3N0b3JhZ2UucmlzZXZpc2lvbi5jb20vfnJ2aS9zdG9yYWdlLWNsaWVudC1ydmEtdGVzdC9zdG9yYWdlLW1vZGFsLmh0bWwjL2ZpbGVzL1wiKTtcbiAgfVxufVxuXG4vKiBnbG9iYWwgZ2FkZ2V0cyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvID0ge307XG5cblJpc2VWaXNpb24uVmlkZW8gPSAoZnVuY3Rpb24gKGRvY3VtZW50LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfcHJlZnMgPSBudWxsLFxuICAgIF9hZGRpdGlvbmFsUGFyYW1zID0ge30sXG4gICAgX2NvbXBhbnlJZCA9IG51bGwsXG4gICAgX2JhY2tncm91bmQgPSBudWxsLFxuICAgIF9wbGF5ZXIgPSBudWxsO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9kb25lKCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X2RvbmVcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpKTtcblxuICB9XG5cbiAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X3JlYWR5XCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICAgIHRydWUsIHRydWUsIHRydWUsIHRydWUsIHRydWUpO1xuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBiYWNrZ3JvdW5kUmVhZHkoKSB7XG4gICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBQbGF5ZXIgaW5zdGFuY2VcbiAgICBfcGxheWVyID0gbmV3IFJpc2VWaXNpb24uVmlkZW8uUGxheWVyKF9hZGRpdGlvbmFsUGFyYW1zLCBfY29tcGFueUlkKTtcbiAgICBfcGxheWVyLmluaXQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIF9wbGF5ZXIucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgaWYgKF9wbGF5ZXIuaXNJbml0aWFsUGxheSgpKSB7XG4gICAgICAvLyBcImF1dG9wbGF5XCIgd2FzIHNlbGVjdGVkIGluIHNldHRpbmdzXG4gICAgICBpZiAoX2FkZGl0aW9uYWxQYXJhbXMudmlkZW8uYXV0b3BsYXkpIHtcbiAgICAgICAgX3BsYXllci5wbGF5KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghX3BsYXllci51c2VyUGF1c2VkKCkpIHtcbiAgICAgICAgX3BsYXllci5wbGF5KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyUmVhZHkoKSB7XG4gICAgX3JlYWR5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRDb21wYW55SWQodmFsdWUpIHtcbiAgICBfY29tcGFueUlkID0gdmFsdWU7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRBZGRpdGlvbmFsUGFyYW1zKHBhcmFtcykge1xuICAgIF9wcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCk7XG4gICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBwYXJhbXM7XG5cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgKyBcInB4XCI7XG5cbiAgICAvLyBjcmVhdGUgYW5kIGluaXRpYWxpemUgdGhlIEJhY2tncm91bmQgaW5zdGFuY2VcbiAgICBfYmFja2dyb3VuZCA9IG5ldyBSaXNlVmlzaW9uLlZpZGVvLkJhY2tncm91bmQoX2FkZGl0aW9uYWxQYXJhbXMsIF9jb21wYW55SWQpO1xuICAgIF9iYWNrZ3JvdW5kLmluaXQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1Jpc2UtVmlzaW9uL3ZpZXdlci9pc3N1ZXMvMzBcbiAgICAvLyBIYXZlIHRvIGNhbGwgcGF1c2UoKSBkdWUgdG8gVmlld2VyIGlzc3VlXG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHZpZGVvRW5kZWQoKSB7XG4gICAgX2RvbmUoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJiYWNrZ3JvdW5kUmVhZHlcIjogYmFja2dyb3VuZFJlYWR5LFxuICAgIFwicGF1c2VcIjogcGF1c2UsXG4gICAgXCJwbGF5XCI6IHBsYXksXG4gICAgXCJzZXRDb21wYW55SWRcIjogc2V0Q29tcGFueUlkLFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyUmVhZHlcIjogcGxheWVyUmVhZHksXG4gICAgXCJzdG9wXCI6IHN0b3AsXG4gICAgXCJ2aWRlb0VuZGVkXCI6IHZpZGVvRW5kZWRcbiAgfTtcblxufSkoZG9jdW1lbnQsIGdhZGdldHMpO1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvID0gUmlzZVZpc2lvbi5WaWRlbyB8fCB7fTtcblxuUmlzZVZpc2lvbi5WaWRlby5CYWNrZ3JvdW5kID0gZnVuY3Rpb24gKGRhdGEsIGNvbXBhbnlJZCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIGJhY2tncm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmRcIiksXG4gICAgICBzdG9yYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrZ3JvdW5kU3RvcmFnZVwiKTtcblxuICAgIC8vIHNldCB0aGUgZG9jdW1lbnQgYmFja2dyb3VuZFxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZCA9IGRhdGEuYmFja2dyb3VuZC5jb2xvcjtcblxuICAgIGlmIChkYXRhLmJhY2tncm91bmQudXNlSW1hZ2UpIHtcbiAgICAgIGJhY2tncm91bmQuY2xhc3NOYW1lID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnBvc2l0aW9uO1xuICAgICAgYmFja2dyb3VuZC5jbGFzc05hbWUgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2Uuc2NhbGUgPyBiYWNrZ3JvdW5kLmNsYXNzTmFtZSArIFwiIHNjYWxlLXRvLWZpdFwiXG4gICAgICAgIDogYmFja2dyb3VuZC5jbGFzc05hbWU7XG5cbiAgICAgIGlmIChPYmplY3Qua2V5cyhkYXRhLmJhY2tncm91bmRTdG9yYWdlKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwgKyBcIilcIjtcbiAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgICBzdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgIGJhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBlLmRldGFpbFswXSArIFwiKVwiO1xuICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8uYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZm9sZGVyXCIsIGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UuZm9sZGVyKTtcbiAgICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZpbGVOYW1lKTtcbiAgICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgY29tcGFueUlkKTtcbiAgICAgICAgc3RvcmFnZS5nbygpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBSaXNlVmlzaW9uLlZpZGVvLmJhY2tncm91bmRSZWFkeSgpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXRcbiAgfTtcbn07XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSBSaXNlVmlzaW9uLlZpZGVvIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvLlBsYXllciA9IGZ1bmN0aW9uIChkYXRhLCBjb21wYW55SWQpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF92aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9cIiksXG4gICAgX3ZpZGVvQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0NvbnRhaW5lclwiKSxcbiAgICBfaW5pdGlhbFBsYXkgPSB0cnVlLFxuICAgIF91c2VyUGF1c2VkID0gZmFsc2UsXG4gICAgX3ZpZXdlclBhdXNlZCA9IGZhbHNlO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2dldFZpZGVvRmlsZVR5cGUoKSB7XG4gICAgdmFyIHR5cGUgPSBkYXRhLnVybC5zdWJzdHIoZGF0YS51cmwubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJvZ3ZcIikge1xuICAgICAgdHlwZSA9IFwib2dnXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICBmdW5jdGlvbiBfb25Mb2FkZWREYXRhKCkge1xuICAgIC8vIGF0IGxlYXNlIDFzdCBmcmFtZSBvZiB2aWRlbyBoYXMgbG9hZGVkXG4gICAgX3ZpZGVvQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgICAvLyByZW1vdmUgdGhpcyBsaXN0ZW5lclxuICAgIF92aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZGVkZGF0YVwiLCBfb25Mb2FkZWREYXRhLCBmYWxzZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfb25DYW5QbGF5KCkge1xuICAgIC8vIGVub3VnaCBkYXRhIGhhcyBsb2FkZWQgdG8gc2FmZWx5IHBsYXkgd2l0aG91dCBpbnRlcnJ1cHRpb25cbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXllclJlYWR5KCk7XG4gICAgLy8gcmVtb3ZlIHRoaXMgbGlzdGVuZXJcbiAgICBfdmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNhbnBsYXlcIiwgX29uQ2FuUGxheSwgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gX29uRW5kZWQoKSB7XG4gICAgLy8gYSBcInBhdXNlXCIgZXZlbnQgaXMgYWx3YXlzIGZpcmVkIGJlZm9yZSBcImVuZGVkXCIgZXZlbnQsIGVuc3VyZSBfdXNlclBhdXNlZCBpcyBmYWxzZVxuICAgIF91c2VyUGF1c2VkID0gZmFsc2U7XG4gICAgLy8gdmlkZW8gZW5kZWRcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnZpZGVvRW5kZWQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBhdXNlKCkge1xuICAgIC8vIHRoaXMgaGFuZGxlciBhbHNvIGdldHMgY2FsbGVkIHZpYSBwdWJsaWMgXCJwYXVzZSgpXCIgZnVuY3Rpb24sIG9ubHkgc2V0IFwiX3VzZXJQYXVzZWQgPSB0cnVlXCIgaWYgbm90IHRoZSBjYXNlXG4gICAgX3VzZXJQYXVzZWQgPSAhX3ZpZXdlclBhdXNlZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBsYXkoKSB7XG4gICAgX2luaXRpYWxQbGF5ID0gZmFsc2U7XG4gICAgX3VzZXJQYXVzZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaXNJbml0aWFsUGxheSgpIHtcbiAgICByZXR1cm4gX2luaXRpYWxQbGF5O1xuICB9XG5cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9TdG9yYWdlXCIpLFxuICAgICAgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG4gICAgICBzb3VyY2UgPSBmcmFnbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic291cmNlXCIpKSxcbiAgICAgIHNyY0F0dHIgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoXCJzcmNcIiksXG4gICAgICB0eXBlQXR0ciA9IGRvY3VtZW50LmNyZWF0ZUF0dHJpYnV0ZShcInR5cGVcIik7XG5cbiAgICAvLyBzZXQgaW5pdGlhbCB2b2x1bWUgb24gPHZpZGVvPlxuICAgIF92aWRlby52b2x1bWUgPSBkYXRhLnZpZGVvLnZvbHVtZSAvIDEwMDtcblxuICAgIC8vIHNldCB0aGUgXCJ0eXBlXCIgYXR0cmlidXRlIG9uIDxzb3VyY2U+XG4gICAgdHlwZUF0dHIudmFsdWUgPSBcInZpZGVvL1wiICsgX2dldFZpZGVvRmlsZVR5cGUoKTtcbiAgICBzb3VyY2Uuc2V0QXR0cmlidXRlTm9kZSh0eXBlQXR0cik7XG5cbiAgICAvLyB2aWRlbyBldmVudHNcbiAgICBfdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRlZGRhdGFcIiwgX29uTG9hZGVkRGF0YSwgZmFsc2UpO1xuICAgIF92aWRlby5hZGRFdmVudExpc3RlbmVyKFwiY2FucGxheVwiLCBfb25DYW5QbGF5LCBmYWxzZSk7XG4gICAgX3ZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCBfb25FbmRlZCwgZmFsc2UpO1xuICAgIF92aWRlby5hZGRFdmVudExpc3RlbmVyKFwicGF1c2VcIiwgX29uUGF1c2UsIGZhbHNlKTtcbiAgICBfdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcInBsYXlcIiwgX29uUGxheSwgZmFsc2UpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGRhdGEudmlkZW9TdG9yYWdlKS5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIE5vbiBzdG9yYWdlIFVSTFxuICAgICAgc3JjQXR0ci52YWx1ZSA9IGRhdGEudXJsO1xuICAgICAgc291cmNlLnNldEF0dHJpYnV0ZU5vZGUoc3JjQXR0cik7XG4gICAgICBfdmlkZW8uYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHNyY0F0dHIudmFsdWUgPSBlLmRldGFpbFswXTtcbiAgICAgICAgc291cmNlLnNldEF0dHJpYnV0ZU5vZGUoc3JjQXR0cik7XG4gICAgICAgIF92aWRlby5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICB9KTtcblxuICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS52aWRlb1N0b3JhZ2UuZm9sZGVyKTtcbiAgICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZmlsZU5hbWVcIiwgZGF0YS52aWRlb1N0b3JhZ2UuZmlsZU5hbWUpO1xuICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgY29tcGFueUlkKTtcbiAgICAgIHN0b3JhZ2UuZ28oKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBfdmlld2VyUGF1c2VkID0gdHJ1ZTtcbiAgICBfdmlkZW8ucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgX2luaXRpYWxQbGF5ID0gZmFsc2U7XG4gICAgX3ZpZXdlclBhdXNlZCA9IGZhbHNlO1xuICAgIF92aWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiB1c2VyUGF1c2VkKCkge1xuICAgIHJldHVybiBfdXNlclBhdXNlZDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpc0luaXRpYWxQbGF5XCI6IGlzSW5pdGlhbFBsYXksXG4gICAgXCJpbml0XCI6IGluaXQsXG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInVzZXJQYXVzZWRcIjogdXNlclBhdXNlZFxuICB9O1xufTtcblxuLyogZ2xvYmFsIGdhZGdldHMsIFJpc2VWaXNpb24gKi9cblxuKGZ1bmN0aW9uICh3aW5kb3csIGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIHByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKSxcbiAgICBpZCA9IHByZWZzLmdldFN0cmluZyhcImlkXCIpO1xuXG4gIC8vIERpc2FibGUgY29udGV4dCBtZW51IChyaWdodCBjbGljayBtZW51KVxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8ucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5zdG9wKCk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRpdGlvbmFsUGFyYW1zKG5hbWVzLCB2YWx1ZXMpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCAmJiBuYW1lc1swXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5zZXRBZGRpdGlvbmFsUGFyYW1zKEpTT04ucGFyc2UodmFsdWVzWzBdKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY29tcGFueUlkKG5hbWUsIHZhbHVlKSB7XG4gICAgaWYgKG5hbWUgJiYgbmFtZSA9PT0gXCJjb21wYW55SWRcIikge1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5zZXRDb21wYW55SWQodmFsdWUpO1xuICAgIH1cblxuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNwYXJhbV9zZXRfXCIgKyBpZCwgYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbXCJhZGRpdGlvbmFsUGFyYW1zXCJdKTtcbiAgfVxuXG4gIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3N0b3BfXCIgKyBpZCwgc3RvcCk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBjb21wYW55SWQpO1xuXG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBcImNvbXBhbnlJZFwiKTtcblxuICB9XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTInXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9