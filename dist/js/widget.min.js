if("undefined"==typeof config){var config={};"undefined"!=typeof angular&&(angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","components/rv-common-i18n/dist/locales/translation_").constant("LOCALES_SUFIX",".json"),angular.module("risevision.widget.common.storage-selector.config").value("STORAGE_MODAL","https://storage-stage.risevision.com/rva-test/dist/storage-modal.html#/files/"))}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e,t){"use strict";function n(){t.rpc.call("","rsevent_done",null,l.getString("id"))}function i(){t.rpc.call("","rsevent_ready",null,l.getString("id"),!0,!0,!0,!0,!0)}function o(){p=new RiseVision.Video.Player(g),p.init()}function a(){p.pause()}function s(){p.isInitialPlay()?g.video.autoplay&&p.play():p.userPaused()||p.play()}function r(){i()}function d(n){l=new t.Prefs,g=n,e.getElementById("videoContainer").style.height=l.getInt("rsH")+"px",m=new RiseVision.Common.Background(g),m.init(o)}function c(){a()}function u(){n()}var l=null,g={},m=null,p=null;return{pause:a,play:s,setAdditionalParams:d,playerReady:r,stop:c,videoEnded:u}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function t(){s=!0,a&&"function"==typeof a&&a()}function n(e){d.removeEventListener("rise-storage-response",n),r.style.backgroundImage=Array.isArray(e.detail)?"url("+e.detail[0]+")":"url("+e.detail+")",t()}function i(){r=document.getElementById("background"),d=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,r?e.background.useImage?(r.className=e.background.image.position,r.className=e.background.image.scale?r.className+" scale-to-fit":r.className,0===Object.keys(e.backgroundStorage).length?(r.style.backgroundImage="url("+e.background.image.url+")",t()):d?(d.addEventListener("rise-storage-response",n),d.setAttribute("folder",e.backgroundStorage.folder),d.setAttribute("fileName",e.backgroundStorage.fileName),d.setAttribute("companyId",e.backgroundStorage.companyId),d.go()):console.log("Missing element with id value of 'backgroundStorage'")):t():console.log("Missing element with id value of 'background'")}function o(e){s?e&&"function"==typeof e&&e():(e&&(a=e),i())}var a=null,s=!1,r=null,d=null;return{init:o}};var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Player=function(e){"use strict";function t(e){b.removeEventListener("rise-storage-response",t),m.value=Array.isArray(e.detail)?e.detail[0]:e.detail,f.setAttributeNode(m),v.appendChild(p)}function n(){var t=e.url.substr(e.url.lastIndexOf(".")+1);return"ogv"===t&&(t="ogg"),t}function i(){y.style.visibility="visible",v.removeEventListener("loadeddata",i,!1)}function o(){RiseVision.Video.playerReady(),v.removeEventListener("canplay",o,!1)}function a(){A=!1,RiseVision.Video.videoEnded()}function s(){A=!E}function r(){V=!1,A=!1}function d(){return V}function c(){var d=document.createAttribute("type");p=document.createDocumentFragment(),f=p.appendChild(document.createElement("source")),m=document.createAttribute("src"),e.video.autoplay||v.setAttribute("controls",""),v.className=e.video.scaleToFit?v.className+" scale-to-fit":v.className+" no-scale",v.volume=e.video.volume/100,d.value="video/"+n(),f.setAttributeNode(d),v.addEventListener("loadeddata",i,!1),v.addEventListener("canplay",o,!1),v.addEventListener("ended",a,!1),v.addEventListener("pause",s,!1),v.addEventListener("play",r,!1),0===Object.keys(e.videoStorage).length?(m.value=e.url,f.setAttributeNode(m),v.appendChild(p)):(b.addEventListener("rise-storage-response",t),b.setAttribute("folder",e.videoStorage.folder),b.setAttribute("fileName",e.videoStorage.fileName),b.setAttribute("companyId",e.videoStorage.companyId),b.go())}function u(){E=!0,v.pause()}function l(){V=!1,E=!1,v.play()}function g(){return A}var m,p,f,v=document.getElementById("video"),y=document.getElementById("videoContainer"),b=document.getElementById("videoStorage"),V=!0,A=!1,E=!1;return{isInitialPlay:d,init:c,pause:u,play:l,userPaused:g}},function(e,t){"use strict";function n(){RiseVision.Video.play()}function i(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function a(e,t){Array.isArray(e)&&e.length>0&&"additionalParams"===e[0]&&Array.isArray(t)&&t.length>0&&RiseVision.Video.setAdditionalParams(JSON.parse(t[0]))}var s=new t.Prefs,r=s.getString("id");e.oncontextmenu=function(){return!1},r&&""!==r&&(t.rpc.register("rscmd_play_"+r,n),t.rpc.register("rscmd_pause_"+r,i),t.rpc.register("rscmd_stop_"+r,o),t.rpc.register("rsparam_set_"+r,a),t.rpc.call("","rsparam_get",null,r,["additionalParams"]))}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFsdWUiLCJSaXNlVmlzaW9uIiwiVmlkZW8iLCJkb2N1bWVudCIsImdhZGdldHMiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJfYmFja2dyb3VuZFJlYWR5IiwiX3BsYXllciIsIlBsYXllciIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiaW5pdCIsInBhdXNlIiwicGxheSIsImlzSW5pdGlhbFBsYXkiLCJ2aWRlbyIsImF1dG9wbGF5IiwidXNlclBhdXNlZCIsInBsYXllclJlYWR5Iiwic2V0QWRkaXRpb25hbFBhcmFtcyIsInBhcmFtcyIsIlByZWZzIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImhlaWdodCIsImdldEludCIsIl9iYWNrZ3JvdW5kIiwiQ29tbW9uIiwiQmFja2dyb3VuZCIsInN0b3AiLCJ2aWRlb0VuZGVkIiwiZGF0YSIsIl9jYWxsYmFjayIsIl9zdG9yYWdlUmVzcG9uc2UiLCJlIiwiX3N0b3JhZ2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYmFja2dyb3VuZEltYWdlIiwiQXJyYXkiLCJpc0FycmF5IiwiZGV0YWlsIiwiX2NvbmZpZ3VyZSIsImJvZHkiLCJiYWNrZ3JvdW5kIiwiY29sb3IiLCJ1c2VJbWFnZSIsImNsYXNzTmFtZSIsImltYWdlIiwicG9zaXRpb24iLCJzY2FsZSIsIk9iamVjdCIsImtleXMiLCJiYWNrZ3JvdW5kU3RvcmFnZSIsImxlbmd0aCIsInVybCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRBdHRyaWJ1dGUiLCJmb2xkZXIiLCJmaWxlTmFtZSIsImNvbXBhbnlJZCIsImdvIiwiY29uc29sZSIsImxvZyIsImNiIiwiX3NyY0F0dHIiLCJfc291cmNlIiwic2V0QXR0cmlidXRlTm9kZSIsIl92aWRlbyIsImFwcGVuZENoaWxkIiwiX2ZyYWdtZW50IiwiX2dldFZpZGVvRmlsZVR5cGUiLCJ0eXBlIiwic3Vic3RyIiwibGFzdEluZGV4T2YiLCJfb25Mb2FkZWREYXRhIiwiX3ZpZGVvQ29udGFpbmVyIiwidmlzaWJpbGl0eSIsIl9vbkNhblBsYXkiLCJfb25FbmRlZCIsIl91c2VyUGF1c2VkIiwiX29uUGF1c2UiLCJfdmlld2VyUGF1c2VkIiwiX29uUGxheSIsIl9pbml0aWFsUGxheSIsInR5cGVBdHRyIiwiY3JlYXRlQXR0cmlidXRlIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzY2FsZVRvRml0Iiwidm9sdW1lIiwidmlkZW9TdG9yYWdlIiwid2luZG93IiwiYWRkaXRpb25hbFBhcmFtcyIsIm5hbWVzIiwidmFsdWVzIiwiSlNPTiIsInBhcnNlIiwicHJlZnMiLCJpZCIsIm9uY29udGV4dG1lbnUiLCJyZWdpc3RlciIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJhc3luYyIsInNyYyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIl0sIm1hcHBpbmdzIjoiQUFFQSxHQUFzQixtQkFBWEEsUUFBd0IsQ0FDakMsR0FBSUEsVUFJbUIsb0JBQVpDLFdBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHVEQUMzQkEsU0FBUyxnQkFBaUIsU0FFN0JGLFFBQVFDLE9BQU8sb0RBQ1pFLE1BQU0sZ0JBQWlCLGtGQU05QixHQUFJQyxZQUFhQSxjQUNqQkEsWUFBV0MsU0FFWEQsV0FBV0MsTUFBUSxTQUFXQyxFQUFVQyxHQUN0QyxZQVVBLFNBQVNDLEtBQ1BELEVBQVFFLElBQUlDLEtBQUssR0FBSSxlQUFnQixLQUFNQyxFQUFPQyxVQUFVLE9BSTlELFFBQVNDLEtBQ1BOLEVBQVFFLElBQUlDLEtBQUssR0FBSSxnQkFBaUIsS0FBTUMsRUFBT0MsVUFBVSxPQUMzRCxHQUFNLEdBQU0sR0FBTSxHQUFNLEdBRzVCLFFBQVNFLEtBRVBDLEVB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Z0IsV0FDckIsT0FBTyxHQXVCTEQsR0FBYSxLQUFQQSxJQUNSbEcsRUFBUUUsSUFBSWtHLFNBQVMsY0FBZ0JGLEVBQUlyRixHQUN6Q2IsRUFBUUUsSUFBSWtHLFNBQVMsZUFBaUJGLEVBQUl0RixHQUMxQ1osRUFBUUUsSUFBSWtHLFNBQVMsY0FBZ0JGLEVBQUlyRSxHQUV6QzdCLEVBQVFFLElBQUlrRyxTQUFTLGVBQWlCRixFQUFJTixHQUMxQzVGLEVBQVFFLElBQUlDLEtBQUssR0FBSSxjQUFlLEtBQU0rRixHQUFLLHVCQUloRFAsT0FBUTNGLFFBS1gsSUFBSXFHLE1BQU9BLFFBRVhBLE1BQUtDLE1BQU0sY0FBZSxrQkFDMUJELEtBQUtDLE1BQU0sbUJBRVgsV0FDRSxHQUFJQyxHQUFLeEcsU0FBU3dGLGNBQWMsU0FBV2dCLEdBQUdoQyxLQUFPLGtCQUFtQmdDLEVBQUdDLE9BQVEsRUFDbkZELEVBQUdFLEtBQU8sVUFBWTFHLFNBQVMyRyxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJN0csU0FBUzhHLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFSLEVBQUlLIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgLy8gdmFyaWFibGVzIGdvIGhlcmVcbiAgfTtcblxuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBhbmd1bGFyLm1vZHVsZShcInJpc2V2aXNpb24uY29tbW9uLmkxOG4uY29uZmlnXCIsIFtdKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19QUkVGSVhcIiwgXCJjb21wb25lbnRzL3J2LWNvbW1vbi1pMThuL2Rpc3QvbG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi53aWRnZXQuY29tbW9uLnN0b3JhZ2Utc2VsZWN0b3IuY29uZmlnXCIpXG4gICAgICAudmFsdWUoXCJTVE9SQUdFX01PREFMXCIsIFwiaHR0cHM6Ly9zdG9yYWdlLXN0YWdlLnJpc2V2aXNpb24uY29tL3J2YS10ZXN0L2Rpc3Qvc3RvcmFnZS1tb2RhbC5odG1sIy9maWxlcy9cIik7XG4gIH1cbn1cblxuLyogZ2xvYmFsIGdhZGdldHMgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvID0gKGZ1bmN0aW9uIChkb2N1bWVudCwgZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX3ByZWZzID0gbnVsbCxcbiAgICBfYWRkaXRpb25hbFBhcmFtcyA9IHt9LFxuICAgIF9iYWNrZ3JvdW5kID0gbnVsbCxcbiAgICBfcGxheWVyID0gbnVsbDtcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfZG9uZSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9kb25lXCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9iYWNrZ3JvdW5kUmVhZHkoKSB7XG4gICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBQbGF5ZXIgaW5zdGFuY2VcbiAgICBfcGxheWVyID0gbmV3IFJpc2VWaXNpb24uVmlkZW8uUGxheWVyKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICBfcGxheWVyLmluaXQoKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgX3BsYXllci5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBpZiAoX3BsYXllci5pc0luaXRpYWxQbGF5KCkpIHtcbiAgICAgIC8vIFwiYXV0b3BsYXlcIiB3YXMgc2VsZWN0ZWQgaW4gc2V0dGluZ3NcbiAgICAgIGlmIChfYWRkaXRpb25hbFBhcmFtcy52aWRlby5hdXRvcGxheSkge1xuICAgICAgICBfcGxheWVyLnBsYXkoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFfcGxheWVyLnVzZXJQYXVzZWQoKSkge1xuICAgICAgICBfcGxheWVyLnBsYXkoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJSZWFkeSgpIHtcbiAgICBfcmVhZHkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMocGFyYW1zKSB7XG4gICAgX3ByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcbiAgICBfYWRkaXRpb25hbFBhcmFtcyA9IHBhcmFtcztcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIikuc3R5bGUuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKSArIFwicHhcIjtcblxuICAgIC8vIGNyZWF0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgQmFja2dyb3VuZCBpbnN0YW5jZVxuICAgIF9iYWNrZ3JvdW5kID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgIF9iYWNrZ3JvdW5kLmluaXQoX2JhY2tncm91bmRSZWFkeSk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9SaXNlLVZpc2lvbi92aWV3ZXIvaXNzdWVzLzMwXG4gICAgLy8gSGF2ZSB0byBjYWxsIHBhdXNlKCkgZHVlIHRvIFZpZXdlciBpc3N1ZVxuICAgIHBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiB2aWRlb0VuZGVkKCkge1xuICAgIF9kb25lKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwicGF1c2VcIjogcGF1c2UsXG4gICAgXCJwbGF5XCI6IHBsYXksXG4gICAgXCJzZXRBZGRpdGlvbmFsUGFyYW1zXCI6IHNldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInN0b3BcIjogc3RvcCxcbiAgICBcInZpZGVvRW5kZWRcIjogdmlkZW9FbmRlZFxuICB9O1xuXG59KShkb2N1bWVudCwgZ2FkZ2V0cyk7XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2NhbGxiYWNrID0gbnVsbCxcbiAgICBfcmVhZHkgPSBmYWxzZSxcbiAgICBfYmFja2dyb3VuZCA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2JhY2tncm91bmRSZWFkeSgpIHtcbiAgICBfcmVhZHkgPSB0cnVlO1xuXG4gICAgaWYgKF9jYWxsYmFjayAmJiB0eXBlb2YgX2NhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIF9jYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdG9yYWdlUmVzcG9uc2UoZSkge1xuICAgIF9zdG9yYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgX3N0b3JhZ2VSZXNwb25zZSk7XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShlLmRldGFpbCkpIHtcbiAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZS5kZXRhaWxbMF0gKyBcIilcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgX2JhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBlLmRldGFpbCArIFwiKVwiO1xuICAgIH1cbiAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBfY29uZmlndXJlKCkge1xuICAgIF9iYWNrZ3JvdW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrZ3JvdW5kXCIpO1xuICAgIF9zdG9yYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrZ3JvdW5kU3RvcmFnZVwiKTtcblxuICAgIC8vIHNldCB0aGUgZG9jdW1lbnQgYmFja2dyb3VuZFxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZCA9IGRhdGEuYmFja2dyb3VuZC5jb2xvcjtcblxuICAgIGlmIChfYmFja2dyb3VuZCkge1xuICAgICAgaWYgKGRhdGEuYmFja2dyb3VuZC51c2VJbWFnZSkge1xuICAgICAgICBfYmFja2dyb3VuZC5jbGFzc05hbWUgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2UucG9zaXRpb247XG4gICAgICAgIF9iYWNrZ3JvdW5kLmNsYXNzTmFtZSA9IGRhdGEuYmFja2dyb3VuZC5pbWFnZS5zY2FsZSA/IF9iYWNrZ3JvdW5kLmNsYXNzTmFtZSArIFwiIHNjYWxlLXRvLWZpdFwiXG4gICAgICAgICAgOiBfYmFja2dyb3VuZC5jbGFzc05hbWU7XG5cbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnVybCArIFwiKVwiO1xuICAgICAgICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoX3N0b3JhZ2UpIHtcbiAgICAgICAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgICAgICAgX3N0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBfc3RvcmFnZVJlc3BvbnNlKTtcblxuICAgICAgICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZm9sZGVyXCIsIGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UuZm9sZGVyKTtcbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImZpbGVOYW1lXCIsIGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UuZmlsZU5hbWUpO1xuICAgICAgICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UuY29tcGFueUlkKTtcbiAgICAgICAgICAgIF9zdG9yYWdlLmdvKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTWlzc2luZyBlbGVtZW50IHdpdGggaWQgdmFsdWUgb2YgJ2JhY2tncm91bmRTdG9yYWdlJ1wiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coXCJNaXNzaW5nIGVsZW1lbnQgd2l0aCBpZCB2YWx1ZSBvZiAnYmFja2dyb3VuZCdcIik7XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBpbml0KGNiKSB7XG4gICAgaWYgKCFfcmVhZHkpIHtcbiAgICAgIGlmIChjYikge1xuICAgICAgICBfY2FsbGJhY2sgPSBjYjtcbiAgICAgIH1cblxuICAgICAgX2NvbmZpZ3VyZSgpO1xuXG4gICAgfSBlbHNlIGlmIChjYiAmJiB0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY2IoKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0XG4gIH07XG59O1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvID0gUmlzZVZpc2lvbi5WaWRlbyB8fCB7fTtcblxuUmlzZVZpc2lvbi5WaWRlby5QbGF5ZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX3ZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb1wiKSxcbiAgICBfdmlkZW9Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLFxuICAgIF9zdG9yYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb1N0b3JhZ2VcIiksXG4gICAgX2luaXRpYWxQbGF5ID0gdHJ1ZSxcbiAgICBfdXNlclBhdXNlZCA9IGZhbHNlLFxuICAgIF92aWV3ZXJQYXVzZWQgPSBmYWxzZSxcbiAgICBfc3JjQXR0ciwgX2ZyYWdtZW50LCBfc291cmNlO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX3N0b3JhZ2VSZXNwb25zZShlKSB7XG4gICAgX3N0b3JhZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBfc3RvcmFnZVJlc3BvbnNlKTtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGUuZGV0YWlsKSkge1xuICAgICAgX3NyY0F0dHIudmFsdWUgPSBlLmRldGFpbFswXTtcbiAgICB9IGVsc2Uge1xuICAgICAgX3NyY0F0dHIudmFsdWUgPSBlLmRldGFpbDtcbiAgICB9XG5cbiAgICBfc291cmNlLnNldEF0dHJpYnV0ZU5vZGUoX3NyY0F0dHIpO1xuICAgIF92aWRlby5hcHBlbmRDaGlsZChfZnJhZ21lbnQpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2dldFZpZGVvRmlsZVR5cGUoKSB7XG4gICAgdmFyIHR5cGUgPSBkYXRhLnVybC5zdWJzdHIoZGF0YS51cmwubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJvZ3ZcIikge1xuICAgICAgdHlwZSA9IFwib2dnXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICBmdW5jdGlvbiBfb25Mb2FkZWREYXRhKCkge1xuICAgIC8vIGF0IGxlYXNlIDFzdCBmcmFtZSBvZiB2aWRlbyBoYXMgbG9hZGVkXG4gICAgX3ZpZGVvQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgICAvLyByZW1vdmUgdGhpcyBsaXN0ZW5lclxuICAgIF92aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZGVkZGF0YVwiLCBfb25Mb2FkZWREYXRhLCBmYWxzZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfb25DYW5QbGF5KCkge1xuICAgIC8vIGVub3VnaCBkYXRhIGhhcyBsb2FkZWQgdG8gc2FmZWx5IHBsYXkgd2l0aG91dCBpbnRlcnJ1cHRpb25cbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXllclJlYWR5KCk7XG4gICAgLy8gcmVtb3ZlIHRoaXMgbGlzdGVuZXJcbiAgICBfdmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNhbnBsYXlcIiwgX29uQ2FuUGxheSwgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gX29uRW5kZWQoKSB7XG4gICAgLy8gYSBcInBhdXNlXCIgZXZlbnQgaXMgYWx3YXlzIGZpcmVkIGJlZm9yZSBcImVuZGVkXCIgZXZlbnQsIGVuc3VyZSBfdXNlclBhdXNlZCBpcyBmYWxzZVxuICAgIF91c2VyUGF1c2VkID0gZmFsc2U7XG4gICAgLy8gdmlkZW8gZW5kZWRcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnZpZGVvRW5kZWQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBhdXNlKCkge1xuICAgIC8vIHRoaXMgaGFuZGxlciBhbHNvIGdldHMgY2FsbGVkIHZpYSBwdWJsaWMgXCJwYXVzZSgpXCIgZnVuY3Rpb24sIG9ubHkgc2V0IFwiX3VzZXJQYXVzZWQgPSB0cnVlXCIgaWYgbm90IHRoZSBjYXNlXG4gICAgX3VzZXJQYXVzZWQgPSAhX3ZpZXdlclBhdXNlZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBsYXkoKSB7XG4gICAgX2luaXRpYWxQbGF5ID0gZmFsc2U7XG4gICAgX3VzZXJQYXVzZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaXNJbml0aWFsUGxheSgpIHtcbiAgICByZXR1cm4gX2luaXRpYWxQbGF5O1xuICB9XG5cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgdHlwZUF0dHIgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoXCJ0eXBlXCIpO1xuXG4gICAgX2ZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIF9zb3VyY2UgPSBfZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKSk7XG4gICAgX3NyY0F0dHIgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoXCJzcmNcIik7XG5cbiAgICAvLyB1c2UgZGVmYXVsdCBjb250cm9scyBpZiBub3Qgc2V0IHRvIGF1dG9wbGF5XG4gICAgaWYgKCFkYXRhLnZpZGVvLmF1dG9wbGF5KSB7XG4gICAgICBfdmlkZW8uc2V0QXR0cmlidXRlKFwiY29udHJvbHNcIiwgXCJcIik7XG4gICAgfVxuXG4gICAgLy8gc2V0IGFwcHJvcHJpYXRlIHNpemluZyBjbGFzcyBiYXNlZCBvbiBzY2FsZVRvRml0IHZhbHVlXG4gICAgX3ZpZGVvLmNsYXNzTmFtZSA9IGRhdGEudmlkZW8uc2NhbGVUb0ZpdCA/IF92aWRlby5jbGFzc05hbWUgKyBcIiBzY2FsZS10by1maXRcIlxuICAgICAgOiBfdmlkZW8uY2xhc3NOYW1lICsgXCIgbm8tc2NhbGVcIjtcblxuICAgIC8vIHNldCBpbml0aWFsIHZvbHVtZSBvbiA8dmlkZW8+XG4gICAgX3ZpZGVvLnZvbHVtZSA9IGRhdGEudmlkZW8udm9sdW1lIC8gMTAwO1xuXG4gICAgLy8gc2V0IHRoZSBcInR5cGVcIiBhdHRyaWJ1dGUgb24gPHNvdXJjZT5cbiAgICB0eXBlQXR0ci52YWx1ZSA9IFwidmlkZW8vXCIgKyBfZ2V0VmlkZW9GaWxlVHlwZSgpO1xuICAgIF9zb3VyY2Uuc2V0QXR0cmlidXRlTm9kZSh0eXBlQXR0cik7XG5cbiAgICAvLyB2aWRlbyBldmVudHNcbiAgICBfdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRlZGRhdGFcIiwgX29uTG9hZGVkRGF0YSwgZmFsc2UpO1xuICAgIF92aWRlby5hZGRFdmVudExpc3RlbmVyKFwiY2FucGxheVwiLCBfb25DYW5QbGF5LCBmYWxzZSk7XG4gICAgX3ZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCBfb25FbmRlZCwgZmFsc2UpO1xuICAgIF92aWRlby5hZGRFdmVudExpc3RlbmVyKFwicGF1c2VcIiwgX29uUGF1c2UsIGZhbHNlKTtcbiAgICBfdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcInBsYXlcIiwgX29uUGxheSwgZmFsc2UpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGRhdGEudmlkZW9TdG9yYWdlKS5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIE5vbiBzdG9yYWdlIFVSTFxuICAgICAgX3NyY0F0dHIudmFsdWUgPSBkYXRhLnVybDtcbiAgICAgIF9zb3VyY2Uuc2V0QXR0cmlidXRlTm9kZShfc3JjQXR0cik7XG4gICAgICBfdmlkZW8uYXBwZW5kQ2hpbGQoX2ZyYWdtZW50KTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSaXNlIFN0b3JhZ2VcbiAgICAgIF9zdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgX3N0b3JhZ2VSZXNwb25zZSk7XG5cbiAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnZpZGVvU3RvcmFnZS5mb2xkZXIpO1xuICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZmlsZU5hbWVcIiwgZGF0YS52aWRlb1N0b3JhZ2UuZmlsZU5hbWUpO1xuICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEudmlkZW9TdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgICBfc3RvcmFnZS5nbygpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIF92aWV3ZXJQYXVzZWQgPSB0cnVlO1xuICAgIF92aWRlby5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBfaW5pdGlhbFBsYXkgPSBmYWxzZTtcbiAgICBfdmlld2VyUGF1c2VkID0gZmFsc2U7XG4gICAgX3ZpZGVvLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVzZXJQYXVzZWQoKSB7XG4gICAgcmV0dXJuIF91c2VyUGF1c2VkO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImlzSW5pdGlhbFBsYXlcIjogaXNJbml0aWFsUGxheSxcbiAgICBcImluaXRcIjogaW5pdCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwidXNlclBhdXNlZFwiOiB1c2VyUGF1c2VkXG4gIH07XG59O1xuXG4vKiBnbG9iYWwgZ2FkZ2V0cywgUmlzZVZpc2lvbiAqL1xuXG4oZnVuY3Rpb24gKHdpbmRvdywgZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpLFxuICAgIGlkID0gcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIik7XG5cbiAgLy8gRGlzYWJsZSBjb250ZXh0IG1lbnUgKHJpZ2h0IGNsaWNrIG1lbnUpXG4gIHdpbmRvdy5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8ucGxheSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnN0b3AoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZGl0aW9uYWxQYXJhbXMobmFtZXMsIHZhbHVlcykge1xuICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWVzKSAmJiBuYW1lcy5sZW5ndGggPiAwICYmIG5hbWVzWzBdID09PSBcImFkZGl0aW9uYWxQYXJhbXNcIikge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzKSAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLnNldEFkZGl0aW9uYWxQYXJhbXMoSlNPTi5wYXJzZSh2YWx1ZXNbMF0pKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wYXVzZV9cIiArIGlkLCBwYXVzZSk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBhZGRpdGlvbmFsUGFyYW1zKTtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuXG4gIH1cblxufSkod2luZG93LCBnYWRnZXRzKTtcblxuXG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktMiddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=