if("undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function t(){e.rpc.call("","rsevent_done",null,v.getString("id"))}function n(){console.log("video.js::_ready()",f.storage.fileName),e.rpc.call("","rsevent_ready",null,v.getString("id"),!0,!0,!0,!0,!0)}function i(){R=new RiseVision.Common.Video.FrameController,R.add(0),R.hide(0),y=0,R.createFramePlayer(0,f,p,config.SKIN,"player.html")}function o(e){E=setInterval(function(){p=f.url+S+"cb="+(new Date).getTime(),b=!1},e)}function r(e){p=e,i()}function a(e){p=e,b=!1}function s(){var e=R.getFrameObject(y);e&&e.pause()}function c(){var e=R.getFrameObject(y);b?t():e?e.play():(R.add(0),R.hide(0),R.createFramePlayer(0,f,p,config.SKIN,"player.html"))}function l(){R.remove(y,function(){t()})}function d(){var e;R.show(y),h?(e=R.getFrameObject(y),e.play()):(h=!0,_||null!==E||o(A),n())}function u(t,n){var o;Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(n)&&n.length>0&&(f=JSON.parse(n[0]),v=new e.Prefs,document.getElementById("videoContainer").style.height=v.getInt("rsH")+"px",f.width=v.getInt("rsW"),f.height=v.getInt("rsH"),_=0!==Object.keys(f.storage).length,_?(V=new RiseVision.Video.Storage(f),V.init()):(o=f.url.split("?"),S=1===o.length?"?":"&",p=f.url,i()))}function m(e){console.debug("video-folder::playerError()",e),h?(b=!0,l()):R.remove(y)}function g(){s()}var f,p,y,v=null,V=null,R=null,h=!1,b=!1,_=!1,S="",A=9e5,E=null;return{onStorageInit:r,onStorageRefresh:a,pause:s,play:c,setAdditionalParams:u,playerEnded:l,playerReady:d,playerError:m,stop:g}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoStorage");t&&(t.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(n?(n=!1,RiseVision.Video.onStorageInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onStorageRefresh(e.detail.url))}),t.setAttribute("folder",e.storage.folder),t.setAttribute("fileName",e.storage.fileName),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("env",config.STORAGE_ENV),t.go())}var n=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(c+e)}function t(t){var n,i=e(t);return n=i.querySelector("iframe"),n?n.contentWindow?n.contentWindow:n.contentDocument.document?n.contentDocument.document:n.contentDocument:null}function n(n){var i,o=e(n),r=t(n);r&&(i=o.querySelector("iframe"),r.remove(),i.setAttribute("src","about:blank"))}function i(t){var n=e(t),i=document.createElement("iframe");i.setAttribute("allowTransparency",!0),i.setAttribute("frameborder","0"),i.setAttribute("scrolling","no"),n.appendChild(i)}function o(n,i,o,r,a){var s,c=e(n),l=t(n);l&&(s=c.querySelector("iframe"),s.onload=function(){s.onload=null,l.init(i,o,r),l.load()},s.setAttribute("src",a))}function r(t){var n=e(t);n.style.visibility="hidden"}function a(e,t){var i=document.getElementById(c+e);n(e),setTimeout(function(){for(;i.firstChild;)i.removeChild(i.firstChild);t&&"function"==typeof t&&t()},200)}function s(t){var n=e(t);n.style.visibility="visible"}var c="if_";return{add:i,createFramePlayer:o,getFrameContainer:e,getFrameObject:t,hide:r,remove:a,show:s}},function(e,t){"use strict";function n(){RiseVision.Video.play()}function i(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function r(){e.removeEventListener("WebComponentsReady",r),s&&""!==s&&(t.rpc.register("rscmd_play_"+s,n),t.rpc.register("rscmd_pause_"+s,i),t.rpc.register("rscmd_stop_"+s,o),t.rpc.register("rsparam_set_"+s,RiseVision.Video.setAdditionalParams),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}var a=new t.Prefs,s=a.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiU0tJTiIsIlNUT1JBR0VfRU5WIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiUmlzZVZpc2lvbiIsIlZpZGVvIiwiZ2FkZ2V0cyIsIl9kb25lIiwicnBjIiwiY2FsbCIsIl9wcmVmcyIsImdldFN0cmluZyIsIl9yZWFkeSIsImNvbnNvbGUiLCJsb2ciLCJfYWRkaXRpb25hbFBhcmFtcyIsInN0b3JhZ2UiLCJmaWxlTmFtZSIsIl9pbml0IiwiX2ZyYW1lQ29udHJvbGxlciIsIkNvbW1vbiIsIkZyYW1lQ29udHJvbGxlciIsImFkZCIsImhpZGUiLCJfY3VycmVudEZyYW1lIiwiY3JlYXRlRnJhbWVQbGF5ZXIiLCJfY3VycmVudEZpbGUiLCJfcmVmcmVzaEludGVydmFsIiwiZHVyYXRpb24iLCJfcmVmcmVzaEludGVydmFsSWQiLCJzZXRJbnRlcnZhbCIsInVybCIsIl9zZXBhcmF0b3IiLCJEYXRlIiwiZ2V0VGltZSIsIl9wbGF5YmFja0Vycm9yIiwib25TdG9yYWdlSW5pdCIsIm9uU3RvcmFnZVJlZnJlc2giLCJwYXVzZSIsImZyYW1lT2JqIiwiZ2V0RnJhbWVPYmplY3QiLCJwbGF5IiwicGxheWVyRW5kZWQiLCJyZW1vdmUiLCJwbGF5ZXJSZWFkeSIsInNob3ciLCJfaW5pdGlhbGl6ZWQiLCJfaXNTdG9yYWdlRmlsZSIsIl9yZWZyZXNoRHVyYXRpb24iLCJzZXRBZGRpdGlvbmFsUGFyYW1zIiwibmFtZXMiLCJ2YWx1ZXMiLCJzdHIiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJKU09OIiwicGFyc2UiLCJQcmVmcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImhlaWdodCIsImdldEludCIsIndpZHRoIiwiT2JqZWN0Iiwia2V5cyIsIl9zdG9yYWdlIiwiU3RvcmFnZSIsImluaXQiLCJzcGxpdCIsInBsYXllckVycm9yIiwiZXJyb3IiLCJkZWJ1ZyIsInN0b3AiLCJkYXRhIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJkZXRhaWwiLCJfaW5pdGlhbExvYWQiLCJoYXNPd25Qcm9wZXJ0eSIsImNoYW5nZWQiLCJzZXRBdHRyaWJ1dGUiLCJmb2xkZXIiLCJjb21wYW55SWQiLCJnbyIsImdldEZyYW1lQ29udGFpbmVyIiwiaW5kZXgiLCJQUkVGSVgiLCJpZnJhbWUiLCJmcmFtZUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50V2luZG93IiwiY29udGVudERvY3VtZW50IiwiX2NsZWFyIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwicGFyYW1zIiwiZmlsZXMiLCJza2luIiwic3JjIiwib25sb2FkIiwibG9hZCIsInZpc2liaWxpdHkiLCJjYWxsYmFjayIsInNldFRpbWVvdXQiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJ3aW5kb3ciLCJwb2x5bWVyUmVhZHkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaWQiLCJyZWdpc3RlciIsInByZWZzIiwib25jb250ZXh0bWVudSIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJ0eXBlIiwiYXN5bmMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwicyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBc0IsbUJBQVhBLFFBQXdCLENBQ2pDLEdBQUlBLFNBQ0ZDLEtBQU0sa0JBQ05DLFlBQWEsT0FHUSxvQkFBWkMsVUFDVEEsUUFBUUMsT0FBTyxvQ0FDWkMsU0FBUyxpQkFBa0Isd0JBQzNCQSxTQUFTLGdCQUFpQixTQU1qQyxHQUFJQyxZQUFhQSxjQUNqQkEsWUFBV0MsU0FFWEQsV0FBV0MsTUFBUSxTQUFXQyxHQUM1QixZQXFCQSxTQUFTQyxLQUNQRCxFQUFRRSxJQUFJQyxLQUFLLEdBQUksZUFBZ0IsS0FBTUMsRUFBT0MsVUFBVSxPQUk5RCxRQUFTQyxLQUNQQyxRQUFRQyxJQUFJLHFCQUFzQkMsRUFBa0JDLFFBQVFD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QSxFQUNSRSxLQUFNQSxJQU1WLFNBQVcrRCxFQUFRdEcsR0FDakIsWUFVQSxTQUFTbUMsS0FDUHJDLFdBQVdDLE1BQU1vQyxPQUduQixRQUFTSCxLQUNQbEMsV0FBV0MsTUFBTWlDLFFBR25CLFFBQVNvQyxLQUNQdEUsV0FBV0MsTUFBTXFFLE9BR25CLFFBQVNtQyxLQUNQRCxFQUFPRSxvQkFBb0IscUJBQXNCRCxHQUU3Q0UsR0FBYSxLQUFQQSxJQUNSekcsRUFBUUUsSUFBSXdHLFNBQVMsY0FBZ0JELEVBQUl0RSxHQUN6Q25DLEVBQVFFLElBQUl3RyxTQUFTLGVBQWlCRCxFQUFJekUsR0FDMUNoQyxFQUFRRSxJQUFJd0csU0FBUyxjQUFnQkQsRUFBSXJDLEdBRXpDcEUsRUFBUUUsSUFBSXdHLFNBQVMsZUFBaUJELEVBQUkzRyxXQUFXQyxNQUFNNEMscUJBQzNEM0MsRUFBUUUsSUFBSUMsS0FBSyxHQUFJLGNBQWUsS0FBTXNHLEdBQUssc0JBN0JuRCxHQUFJRSxHQUFRLEdBQUkzRyxHQUFRb0QsTUFDdEJxRCxFQUFLRSxFQUFNdEcsVUFBVSxLQUd2QmlHLEdBQU9NLGNBQWdCLFdBQ3JCLE9BQU8sR0E0QlROLEVBQU9oQyxpQkFBaUIscUJBQXNCaUMsSUFFN0NELE9BQVF0RyxRQUtYLElBQUk2RyxNQUFPQSxRQUVYQSxNQUFLQyxNQUFNLGNBQWUsa0JBQzFCRCxLQUFLQyxNQUFNLG1CQUVYLFdBQ0UsR0FBSUMsR0FBSzFELFNBQVNvQyxjQUFjLFNBQVdzQixHQUFHQyxLQUFPLGtCQUFtQkQsRUFBR0UsT0FBUSxFQUNuRkYsRUFBR2pCLEtBQU8sVUFBWXpDLFNBQVM2RCxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJL0QsU0FBU2dFLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFSLEVBQUlLIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgU0tJTjogXCJza2luL1JWU2tpbi54bWxcIixcbiAgICBTVE9SQUdFX0VOVjogXCJwcm9kXCJcbiAgfTtcblxuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBhbmd1bGFyLm1vZHVsZShcInJpc2V2aXNpb24uY29tbW9uLmkxOG4uY29uZmlnXCIsIFtdKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19QUkVGSVhcIiwgXCJsb2NhbGVzL3RyYW5zbGF0aW9uX1wiKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19TVUZJWFwiLCBcIi5qc29uXCIpO1xuICB9XG59XG5cbi8qIGdsb2JhbCBnYWRnZXRzLCBjb25maWcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvID0gKGZ1bmN0aW9uIChnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfYWRkaXRpb25hbFBhcmFtcztcblxuICB2YXIgX3ByZWZzID0gbnVsbCxcbiAgICBfc3RvcmFnZSA9IG51bGwsXG4gICAgX2ZyYW1lQ29udHJvbGxlciA9IG51bGw7XG5cbiAgdmFyIF9pbml0aWFsaXplZCA9IGZhbHNlLFxuICAgIF9wbGF5YmFja0Vycm9yID0gZmFsc2UsXG4gICAgX2lzU3RvcmFnZUZpbGUgPSBmYWxzZTtcblxuICB2YXIgX2N1cnJlbnRGaWxlLCBfY3VycmVudEZyYW1lO1xuXG4gIHZhciBfc2VwYXJhdG9yID0gXCJcIixcbiAgICBfcmVmcmVzaER1cmF0aW9uID0gOTAwMDAwLCAgLy8gMTUgbWludXRlc1xuICAgIF9yZWZyZXNoSW50ZXJ2YWxJZCA9IG51bGw7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2RvbmUoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfZG9uZVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIikpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBfcmVhZHkoKSB7XG4gICAgY29uc29sZS5sb2coXCJ2aWRlby5qczo6X3JlYWR5KClcIiwgX2FkZGl0aW9uYWxQYXJhbXMuc3RvcmFnZS5maWxlTmFtZSk7XG5cbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9pbml0KCkge1xuICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uVmlkZW8uRnJhbWVDb250cm9sbGVyKCk7XG5cbiAgICAvLyBhZGQgdGhlIGZpcnN0IGZyYW1lIGFuZCBjcmVhdGUgaXRzIHBsYXllclxuICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKDApO1xuICAgIF9mcmFtZUNvbnRyb2xsZXIuaGlkZSgwKTtcbiAgICBfY3VycmVudEZyYW1lID0gMDtcbiAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGUsIGNvbmZpZy5TS0lOLCBcInBsYXllci5odG1sXCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlZnJlc2hJbnRlcnZhbChkdXJhdGlvbikge1xuICAgIF9yZWZyZXNoSW50ZXJ2YWxJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uIHZpZGVvUmVmcmVzaCgpIHtcbiAgICAgIC8vIHNldCBuZXcgdmFsdWUgb2Ygbm9uIHJpc2Utc3RvcmFnZSB1cmwgd2l0aCBhIGNhY2hlYnVzdGVyXG4gICAgICBfY3VycmVudEZpbGUgPSBfYWRkaXRpb25hbFBhcmFtcy51cmwgKyBfc2VwYXJhdG9yICsgXCJjYj1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgICAvLyBpbiBjYXNlIHJlZnJlc2hlZCBmaWxlIGZpeGVzIGFuIGVycm9yIHdpdGggcHJldmlvdXMgZmlsZSwgZW5zdXJlIGZsYWcgaXMgcmVtb3ZlZCBzbyBwbGF5YmFjayBpcyBhdHRlbXB0ZWQgYWdhaW5cbiAgICAgIF9wbGF5YmFja0Vycm9yID0gZmFsc2U7XG5cbiAgICB9LCBkdXJhdGlvbik7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIG9uU3RvcmFnZUluaXQodXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgX2luaXQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU3RvcmFnZVJlZnJlc2godXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgLy8gaW4gY2FzZSByZWZyZXNoZWQgZmlsZSBmaXhlcyBhbiBlcnJvciB3aXRoIHByZXZpb3VzIGZpbGUsIGVuc3VyZSBmbGFnIGlzIHJlbW92ZWQgc28gcGxheWJhY2sgaXMgYXR0ZW1wdGVkIGFnYWluXG4gICAgX3BsYXliYWNrRXJyb3IgPSBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIHZhciBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGZyYW1lT2JqLnBhdXNlKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgaWYgKCFfcGxheWJhY2tFcnJvcikge1xuICAgICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICAgIGZyYW1lT2JqLnBsYXkoKTtcbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgLy8gYWRkIGZyYW1lIGFuZCBjcmVhdGUgdGhlIHBsYXllciwgYnV0IGhpZGUgdmlzaWJpbGl0eSBvZiBmcmFtZSBjb250YWluZXIgdW50aWwgXCJyZWFkeVwiIGlzIHJlY2VpdmVkXG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKDApO1xuICAgICAgICBfZnJhbWVDb250cm9sbGVyLmhpZGUoMCk7XG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuY3JlYXRlRnJhbWVQbGF5ZXIoMCwgX2FkZGl0aW9uYWxQYXJhbXMsIF9jdXJyZW50RmlsZSwgY29uZmlnLlNLSU4sIFwicGxheWVyLmh0bWxcIik7XG5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhpcyBmbGFnIG9ubHkgZ290IHNldCB1cG9uIGEgcmVmcmVzaCBvZiBoaWRkZW4gZnJhbWUgYW5kIHRoZXJlIHdhcyBhbiBlcnJvciBpbiBzZXR1cCBvciB2aWRlb1xuICAgICAgLy8gU2VuZCBWaWV3ZXIgXCJkb25lXCJcbiAgICAgIF9kb25lKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRW5kZWQoKSB7XG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgX2RvbmUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllclJlYWR5KCkge1xuICAgIHZhciBmcmFtZU9iajtcblxuICAgIC8vIG1ha2UgdGhlIGZyYW1lIGNvbnRhaW5lciB2aXNpYmxlIG5vdyB0aGF0IHJlYWR5IGhhcyBiZWVuIHJlY2VpdmVkXG4gICAgX2ZyYW1lQ29udHJvbGxlci5zaG93KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgaWYgKCFfaW5pdGlhbGl6ZWQpIHtcbiAgICAgIF9pbml0aWFsaXplZCA9IHRydWU7XG5cbiAgICAgIGlmICghX2lzU3RvcmFnZUZpbGUgJiYgX3JlZnJlc2hJbnRlcnZhbElkID09PSBudWxsKSB7XG4gICAgICAgIF9yZWZyZXNoSW50ZXJ2YWwoX3JlZnJlc2hEdXJhdGlvbik7XG4gICAgICB9XG5cbiAgICAgIF9yZWFkeSgpO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcbiAgICAgIGZyYW1lT2JqLnBsYXkoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZXRBZGRpdGlvbmFsUGFyYW1zKG5hbWVzLCB2YWx1ZXMpIHtcbiAgICB2YXIgc3RyO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZSh2YWx1ZXNbMF0pO1xuICAgICAgICBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpO1xuXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIikuc3R5bGUuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKSArIFwicHhcIjtcblxuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCA9IF9wcmVmcy5nZXRJbnQoXCJyc1dcIik7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIik7XG5cbiAgICAgICAgX2lzU3RvcmFnZUZpbGUgPSAoT2JqZWN0LmtleXMoX2FkZGl0aW9uYWxQYXJhbXMuc3RvcmFnZSkubGVuZ3RoICE9PSAwKTtcblxuICAgICAgICBpZiAoIV9pc1N0b3JhZ2VGaWxlKSB7XG4gICAgICAgICAgc3RyID0gX2FkZGl0aW9uYWxQYXJhbXMudXJsLnNwbGl0KFwiP1wiKTtcblxuICAgICAgICAgIC8vIHN0b3JlIHRoaXMgZm9yIHRoZSByZWZyZXNoIHRpbWVyXG4gICAgICAgICAgX3NlcGFyYXRvciA9IChzdHIubGVuZ3RoID09PSAxKSA/IFwiP1wiIDogXCImXCI7XG5cbiAgICAgICAgICBfY3VycmVudEZpbGUgPSBfYWRkaXRpb25hbFBhcmFtcy51cmw7XG5cbiAgICAgICAgICBfaW5pdCgpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBTdG9yYWdlIG1vZHVsZSBpbnN0YW5jZVxuICAgICAgICAgIF9zdG9yYWdlID0gbmV3IFJpc2VWaXNpb24uVmlkZW8uU3RvcmFnZShfYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICAgICAgX3N0b3JhZ2UuaW5pdCgpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUuZGVidWcoXCJ2aWRlby1mb2xkZXI6OnBsYXllckVycm9yKClcIiwgZXJyb3IpO1xuXG4gICAgaWYgKCFfaW5pdGlhbGl6ZWQpIHtcbiAgICAgIC8vIFdpZGdldCBoYXMgbm90IHNlbnQgXCJyZWFkeVwiIHlldCBzbyB0aGVyZSBoYXMgYmVlbiBhIHNldHVwIGVycm9yXG4gICAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lKTtcblxuICAgICAgLy8gZG8gbm90aGluZyBtb3JlLCBlbnN1cmUgXCJyZWFkeVwiIGlzIG5vdCBzZW50IHRvIFZpZXdlciBzbyB0aGF0IHRoaXMgd2lkZ2V0IGNhbiBiZSBza2lwcGVkXG5cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZmxhZyB0aGUgdmlkZW8gaGFzIGFuIGVycm9yXG4gICAgICBfcGxheWJhY2tFcnJvciA9IHRydWU7XG5cbiAgICAgIC8vIGFjdCBhcyB0aG91Z2ggdmlkZW8gaGFzIGVuZGVkXG4gICAgICBwbGF5ZXJFbmRlZCgpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcIm9uU3RvcmFnZUluaXRcIjogb25TdG9yYWdlSW5pdCxcbiAgICBcIm9uU3RvcmFnZVJlZnJlc2hcIjogb25TdG9yYWdlUmVmcmVzaCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyRW5kZWRcIjogcGxheWVyRW5kZWQsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInBsYXllckVycm9yXCI6IHBsYXllckVycm9yLFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGdhZGdldHMpO1xuXG4vKiBnbG9iYWwgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSBSaXNlVmlzaW9uLlZpZGVvIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvLlN0b3JhZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2luaXRpYWxMb2FkID0gdHJ1ZTtcblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIHN0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvU3RvcmFnZVwiKTtcblxuICAgIGlmICghc3RvcmFnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5kZXRhaWwgJiYgZS5kZXRhaWwudXJsKSB7XG5cbiAgICAgICAgaWYgKF9pbml0aWFsTG9hZCkge1xuICAgICAgICAgIF9pbml0aWFsTG9hZCA9IGZhbHNlO1xuXG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5vblN0b3JhZ2VJbml0KGUuZGV0YWlsLnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gY2hlY2sgZm9yIFwiY2hhbmdlZFwiIHByb3BlcnR5IGFuZCBlbnN1cmUgaXQgaXMgdHJ1ZVxuICAgICAgICAgIGlmIChlLmRldGFpbC5oYXNPd25Qcm9wZXJ0eShcImNoYW5nZWRcIikgJiYgZS5kZXRhaWwuY2hhbmdlZCkge1xuICAgICAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5vblN0b3JhZ2VSZWZyZXNoKGUuZGV0YWlsLnVybCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnN0b3JhZ2UuZm9sZGVyKTtcbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZpbGVOYW1lXCIsIGRhdGEuc3RvcmFnZS5maWxlTmFtZSk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5zdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJlbnZcIiwgY29uZmlnLlNUT1JBR0VfRU5WKTtcbiAgICBzdG9yYWdlLmdvKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0XG4gIH07XG59O1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5WaWRlbyA9IFJpc2VWaXNpb24uQ29tbW9uLlZpZGVvIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5WaWRlby5GcmFtZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBQUkVGSVggPSBcImlmX1wiO1xuXG4gIGZ1bmN0aW9uIGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEZyYW1lT2JqZWN0KGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxuICAgICAgaWZyYW1lO1xuXG4gICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcblxuICAgIGlmIChpZnJhbWUpIHtcbiAgICAgIHJldHVybiAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpID8gaWZyYW1lLmNvbnRlbnRXaW5kb3cgOlxuICAgICAgICAoaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCkgPyBpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50IDogaWZyYW1lLmNvbnRlbnREb2N1bWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jbGVhcihpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcbiAgICAgIGZyYW1lT2JqID0gZ2V0RnJhbWVPYmplY3QoaW5kZXgpLFxuICAgICAgaWZyYW1lO1xuXG4gICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuICAgICAgZnJhbWVPYmoucmVtb3ZlKCk7XG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic3JjXCIsIFwiYWJvdXQ6YmxhbmtcIik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gYWRkKGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxuICAgICAgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcblxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd1RyYW5zcGFyZW5jeVwiLCB0cnVlKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwiZnJhbWVib3JkZXJcIiwgXCIwXCIpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzY3JvbGxpbmdcIiwgXCJub1wiKTtcblxuICAgIGZyYW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVGcmFtZVBsYXllcihpbmRleCwgcGFyYW1zLCBmaWxlcywgc2tpbiwgc3JjKSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG5cbiAgICAgIGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmcmFtZS5vbmxvYWQgPSBudWxsO1xuXG4gICAgICAgIC8vIGluaXRpYWxpemUgYW5kIGxvYWQgdGhlIHBsYXllciBpbnNpZGUgdGhlIGlmcmFtZVxuICAgICAgICBmcmFtZU9iai5pbml0KHBhcmFtcywgZmlsZXMsIHNraW4pO1xuICAgICAgICBmcmFtZU9iai5sb2FkKCk7XG4gICAgICB9O1xuXG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic3JjXCIsIHNyYyk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBoaWRlKGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpO1xuXG4gICAgZnJhbWVDb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmUoaW5kZXgsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpO1xuXG4gICAgX2NsZWFyKGluZGV4KTtcblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgLy8gcmVtb3ZlIHRoZSBpZnJhbWUgYnkgY2xlYXJpbmcgYWxsIGVsZW1lbnRzIGluc2lkZSBkaXYgY29udGFpbmVyXG4gICAgICB3aGlsZSAoZnJhbWVDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICBmcmFtZUNvbnRhaW5lci5yZW1vdmVDaGlsZChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNhbGxiYWNrICYmIHR5cGVvZiBjYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9XG4gICAgfSwgMjAwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3coaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCk7XG5cbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZDogYWRkLFxuICAgIGNyZWF0ZUZyYW1lUGxheWVyOiBjcmVhdGVGcmFtZVBsYXllcixcbiAgICBnZXRGcmFtZUNvbnRhaW5lcjogZ2V0RnJhbWVDb250YWluZXIsXG4gICAgZ2V0RnJhbWVPYmplY3Q6IGdldEZyYW1lT2JqZWN0LFxuICAgIGhpZGU6IGhpZGUsXG4gICAgcmVtb3ZlOiByZW1vdmUsXG4gICAgc2hvdzogc2hvd1xuICB9O1xufTtcblxuLyogZ2xvYmFsIGdhZGdldHMsIFJpc2VWaXNpb24gKi9cblxuKGZ1bmN0aW9uICh3aW5kb3csIGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIHByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKSxcbiAgICBpZCA9IHByZWZzLmdldFN0cmluZyhcImlkXCIpO1xuXG4gIC8vIERpc2FibGUgY29udGV4dCBtZW51IChyaWdodCBjbGljayBtZW51KVxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8ucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5zdG9wKCk7XG4gIH1cblxuICBmdW5jdGlvbiBwb2x5bWVyUmVhZHkoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJXZWJDb21wb25lbnRzUmVhZHlcIiwgcG9seW1lclJlYWR5KTtcblxuICAgIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wbGF5X1wiICsgaWQsIHBsYXkpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wYXVzZV9cIiArIGlkLCBwYXVzZSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3N0b3BfXCIgKyBpZCwgc3RvcCk7XG5cbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNwYXJhbV9zZXRfXCIgKyBpZCwgUmlzZVZpc2lvbi5WaWRlby5zZXRBZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc3BhcmFtX2dldFwiLCBudWxsLCBpZCwgW1wiYWRkaXRpb25hbFBhcmFtc1wiXSk7XG4gICAgfVxuICB9XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJXZWJDb21wb25lbnRzUmVhZHlcIiwgcG9seW1lclJlYWR5KTtcblxufSkod2luZG93LCBnYWRnZXRzKTtcblxuXG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktMiddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=