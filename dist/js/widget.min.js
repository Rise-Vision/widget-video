if("undefined"==typeof config){var config={SKIN:"/rise-common/scripts/jw-player/skins/six.xml"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseCache=function(){"use strict";function e(){return"http://localhost:9494/?url="}function n(e){var n=new XMLHttpRequest;e&&"function"!=typeof e||(n.open("GET","http://localhost:9494/ping",!0),n.onreadystatechange=function(){try{4===n.readyState&&(200===n.status?e(!0,n.responseText):(console.debug("Rise Cache is not running"),e(!1,null)))}catch(i){console.debug("Caught exception: ",i.description)}},n.send())}return{ping:n,getUrl:e}}();var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e,n){"use strict";function i(){n.rpc.call("","rsevent_done",null,f.getString("id"))}function t(){n.rpc.call("","rsevent_ready",null,f.getString("id"),!0,!0,!0,!0,!0)}function o(){d=RiseVision.Video.Player,d.init(g)}function s(){d.pause()}function a(){p?(p=!1,g.video.autoplay?d.play():d.play(!0)):d.play()}function r(){t()}function l(i,t){Array.isArray(i)&&i.length>0&&"additionalParams"===i[0]&&Array.isArray(t)&&t.length>0&&(g=JSON.parse(t[0]),f=new n.Prefs,e.getElementById("videoContainer").style.height=f.getInt("rsH")+"px",g.width=f.getInt("rsW"),g.height=f.getInt("rsH"),m=new RiseVision.Common.Background(g),m.init(o))}function c(){s()}function u(){i()}var d,g,f=null,m=null,p=!0;return{pause:s,play:a,setAdditionalParams:l,playerReady:r,stop:c,videoEnded:u}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function n(){setTimeout(function(){r.style.backgroundImage="url("+e.background.image.url+d+"cb="+(new Date).getTime()+")",n()},c)}function i(){a=!0,e.background.useImage&&!u&&n(),s&&"function"==typeof s&&s()}function t(){var n;r=document.getElementById("background"),l=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,r?e.background.useImage?(r.className=e.background.image.position,r.className=e.background.image.scale?r.className+" scale-to-fit":r.className,u=0!==Object.keys(e.backgroundStorage).length,u?l?(l.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.files&&e.detail.files.length>0&&(r.style.backgroundImage="url("+e.detail.files[0].url+")"),a||i()}),l.setAttribute("folder",e.backgroundStorage.folder),l.setAttribute("fileName",e.backgroundStorage.fileName),l.setAttribute("companyId",e.backgroundStorage.companyId),l.go()):console.log("Missing element with id value of 'backgroundStorage'"):(n=e.background.image.url.split("?"),d=1===n.length?"?":"&",r.style.backgroundImage="url("+e.background.image.url+")",i())):i():console.log("Missing element with id value of 'background'")}function o(e){a?e&&"function"==typeof e&&e():(e&&(s=e),t())}var s=null,a=!1,r=null,l=null,c=9e5,u=!1,d="";return{init:o}};var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Player=function(e,n,i,t){"use strict";function o(e){var n,i=[".mp4",".webm",".ogg",".ogv"],t=e.toLowerCase(),o=null;for(n=0;n<=i.length;n+=1)if(-1!==t.indexOf(i[n])){o=i[n].substr(i[n].lastIndexOf(".")+1);break}return"ogv"===o&&(o="ogg"),o}function s(){setTimeout(function(){A=!0},N)}function a(){var e;S?(e=o(I),A=!1,console.debug("Refresh, JW Player load: ",[I,e]),n().load([{file:I,type:e}])):(e=o(h),i.ping(function(t){P=t,A=!1,console.debug("Refresh, JW Player load: ",[P?i.getUrl()+encodeURIComponent(h):h,e]),n().load([{file:P?i.getUrl()+encodeURIComponent(h):h,type:e}]),s()}))}function r(){console.debug("JW Player video complete"),RiseVision.Video.videoEnded()}function l(){w&&(w=!1,S||s()),C=!1}function c(){n().setMute(!1),n().setVolume(R),RiseVision.Video.playerReady()}function u(e){console.debug("JW Player Error - ",e),C=!0,w&&(w=!1,S||s()),RiseVision.Video.videoEnded()}function d(){var s,a;e.getElementById("videoJW").style.visibility="hidden",S?(s=I,a=o(I)):(s=P?i.getUrl()+encodeURIComponent(h):h,a=o(h)),console.debug("JW Player setup: ",[s,a]),n("videoJW").setup({file:s,type:a,width:k,height:E,controls:!b,mute:!0,stretching:V?"uniform":"none",primary:"html5",skin:t.SKIN,events:{onReady:function(e){c(e)},onComplete:function(e){r(e)},onError:function(e){u(e)},onPlay:function(e){l(e)}}})}function g(e){console.debug("Rise Storage response - ",e),e.detail&&e.detail.files&&e.detail.files.length>0&&(I=e.detail.files[0].url,w?d():A=!0)}function f(n){var t,o=e.getElementById("videoJW"),s=e.getElementById("videoStorage");o&&s&&(b=n.video.autoplay,R=n.video.volume,V=n.video.scaleToFit,h=n.url,k=n.width,E=n.height,S=0!==Object.keys(n.videoStorage).length,S?(s.addEventListener("rise-storage-response",g),s.setAttribute("folder",n.videoStorage.folder),s.setAttribute("fileName",n.videoStorage.fileName),s.setAttribute("companyId",n.videoStorage.companyId),s.go()):(t=h.split("?"),_=1===t.length?"?":"&",i.ping(function(e){P=e,d()})))}function m(){var i=n().getState();("BUFFERING"===i||"PLAYING"===i)&&n().pause(!0),e.getElementById("videoJW").style.visibility="hidden",A&&a()}function p(i){e.getElementById("videoJW").style.visibility="visible",C?RiseVision.Video.videoEnded():i||(n().getPosition()>0?(n().seek(0),n().play(!0)):n().play(!0))}function y(){n().remove()}function v(){m()}var b,R,V,h,I,k,E,S,w=!0,C=!1,_="",P=!1,A=!1,N=9e5;return{init:f,pause:m,play:p,remove:y,stop:v}}(document,jwplayer,RiseVision.Common.RiseCache,config),function(e,n){"use strict";function i(){RiseVision.Video.play()}function t(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}var s=new n.Prefs,a=s.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("polymer-ready",function(){a&&""!==a&&(n.rpc.register("rscmd_play_"+a,i),n.rpc.register("rscmd_pause_"+a,t),n.rpc.register("rscmd_stop_"+a,o),n.rpc.register("rsparam_set_"+a,RiseVision.Video.setAdditionalParams),n.rpc.call("","rsparam_get",null,a,["additionalParams"]))})}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiU0tJTiIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsIlJpc2VWaXNpb24iLCJDb21tb24iLCJSaXNlQ2FjaGUiLCJnZXRVcmwiLCJwaW5nIiwiY2FsbGJhY2siLCJyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlVGV4dCIsImNvbnNvbGUiLCJkZWJ1ZyIsImUiLCJkZXNjcmlwdGlvbiIsInNlbmQiLCJWaWRlbyIsImRvY3VtZW50IiwiZ2FkZ2V0cyIsIl9kb25lIiwicnBjIiwiY2FsbCIsIl9wcmVmcyIsImdldFN0cmluZyIsIl9yZWFkeSIsIl9iYWNrZ3JvdW5kUmVhZHkiLCJfcGxheWVyIiwiUGxheWVyIiwiaW5pdCIsIl9hZGRpdGlvbmFsUGFyYW1zIiwicGF1c2UiLCJwbGF5IiwiX2luaXRpYWxQbGF5IiwidmlkZW8iLCJhdXRvcGxheSIsInBsYXllclJlYWR5Iiwic2V0QWRkaXRpb25hbFBhcmFtcyIsIm5hbWVzIiwidmFsdWVzIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwiSlNPTiIsInBhcnNlIiwiUHJlZnMiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiaGVpZ2h0IiwiZ2V0SW50Iiwid2lkdGgiLCJfYmFja2dyb3VuZCIsIkJhY2tncm91bmQiLCJzdG9wIiwidmlkZW9FbmRlZCIsImRhdGEiLCJfcmVmcmVzaFRpbWVyIiwic2V0VGltZW91dCIsImJhY2tncm91bmRJbWFnZSIsImJhY2tncm91bmQiLCJpbWFnZSIsInVybCIsIl9zZXBhcmF0b3IiLCJEYXRlIiwiZ2V0VGltZSIsIl9yZWZyZXNoRHVyYXRpb24iLCJ1c2VJbWFnZSIsIl9pc1N0b3JhZ2VGaWxlIiwiX2NhbGxiYWNrIiwiX2NvbmZpZ3VyZSIsInN0ciIsIl9zdG9yYWdlIiwiYm9keSIsImNvbG9yIiwiY2xhc3NOYW1lIiwicG9zaXRpb24iLCJzY2FsZSIsIk9iamVjdCIsImtleXMiLCJiYWNrZ3JvdW5kU3RvcmFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZXRhaWwiLCJmaWxlcyIsInNldEF0dHJpYnV0ZSIsImZvbGRlciIsImZpbGVOYW1lIiwiY29tcGFueUlkIiwiZ28iLCJsb2ciLCJzcGxpdCIsImNiIiwiandwbGF5ZXIiLCJjYWNoZSIsIl9nZXRWaWRlb0ZpbGVUeXBlIiwiaSIsImV4dGVuc2lvbnMiLCJ1cmxMb3dlcmNhc2UiLCJ0b0xvd2VyQ2FzZSIsInR5cGUiLCJpbmRleE9mIiwic3Vic3RyIiwibGFzdEluZGV4T2YiLCJfcmVmcmVzaFdhaXRpbmciLCJfcmVmcmVzaCIsImZpbGVUeXBlIiwiX3N0b3JhZ2VVcmwiLCJsb2FkIiwiZmlsZSIsIl91cmwiLCJpc1J1bm5pbmciLCJfcmlzZUNhY2hlUnVubmluZyIsImVuY29kZVVSSUNvbXBvbmVudCIsIl9vblZpZGVvQ29tcGxldGUiLCJfb25WaWRlb1BsYXkiLCJfaXNMb2FkaW5nIiwiX3BsYXllckVycm9yIiwiX29uUGxheWVyUmVhZHkiLCJzZXRNdXRlIiwic2V0Vm9sdW1lIiwiX3ZvbHVtZSIsIl9vblBsYXllckVycm9yIiwiZXJyb3IiLCJfbG9hZCIsInZpc2liaWxpdHkiLCJzZXR1cCIsIl93aWR0aCIsIl9oZWlnaHQiLCJjb250cm9scyIsIl9hdXRvUGxheSIsIm11dGUiLCJzdHJldGNoaW5nIiwiX3NjYWxlVG9GaXQiLCJwcmltYXJ5Iiwic2tpbiIsImV2ZW50cyIsIm9uUmVhZHkiLCJldmVudCIsIm9uQ29tcGxldGUiLCJvbkVycm9yIiwib25QbGF5IiwiX29uUmlzZVN0b3JhZ2VSZXNwb25zZSIsInN0b3JhZ2UiLCJ2b2x1bWUiLCJzY2FsZVRvRml0IiwidmlkZW9TdG9yYWdlIiwic3RhdGUiLCJnZXRTdGF0ZSIsInNob3dPbmx5IiwiZ2V0UG9zaXRpb24iLCJzZWVrIiwicmVtb3ZlIiwid2luZG93IiwicHJlZnMiLCJpZCIsIm9uY29udGV4dG1lbnUiLCJyZWdpc3RlciIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJjcmVhdGVFbGVtZW50IiwiYXN5bmMiLCJzcmMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwicyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBc0IsbUJBQVhBLFFBQXdCLENBQ2pDLEdBQUlBLFNBQ0ZDLEtBQU0sK0NBR2Usb0JBQVpDLFVBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHdCQUMzQkEsU0FBUyxnQkFBaUIsU0FJakMsR0FBSUMsWUFBYUEsY0FDakJBLFlBQVdDLE9BQVNELFdBQVdDLFdBRS9CRCxXQUFXQyxPQUFPQyxVQUFZLFdBQzVCLFlBRUEsU0FBU0MsS0FDUCxNQUFPLDhCQUdULFFBQVNDLEdBQUtDLEdBQ1osR0FBSUMsR0FBSSxHQUFJQyxlQUVSRixJQUFnQyxrQkFBYkEsS0FJdkJDLEVBQUVFLEtBQUssTUFBTyw4QkFBOEIsR0FDNUNGLEVBQUVHLG1CQUFxQixXQUNyQixJQUN1QixJQUFqQkgsRUFBRUksYUFDWSxNQUFiSixFQUFFSyxPQUNITixHQUFTLEVBQU1DLEVBQUVNLGVBRWpCQyxRQUFRQyxNQUFNLDZCQUNkVCxHQUFTLEVBQU8sUUFJdEIsTUFBT1UsR0FDTEYsUUFBUUMsTUFBTSxxQkFBc0JDLEVBQUVDLGVBSTFDVixFQUFFVyxRQUdKLE9BQ0ViLEtBQU1BLEVBQ05ELE9BQVNBLEtBT2IsSUFBSUgsWUFBYUEsY0FDakJBLFlBQVdrQixTQUVYbEIsV0FBV2tCLE1BQVEsU0FBV0MsRUFBVUMsR0FDdEMsWUFVQSxTQUFTQyxLQUNQRCxFQUFRRSxJQUFJQyxLQUFLLEdBQUksZUFBZ0IsS0FBTUMsRUFBT0MsVUFBVSxPQUk5RCxRQUFTQyxLQUNQTixFQUFRRSxJQUFJQyxLQUFLLEdBQUksZ0JBQWlCLEtBQU1DLEVBQU9DLFVBQVUsT0FDM0QsR0FBTSxHQUFNLEdBQU0sR0FBTSxHQUc1QixRQUFTRSxL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bUksR0FBSyx5QkFJbERGLE9BQVFwSSxRQUtYLElBQUl5SSxNQUFPQSxRQUVYQSxNQUFLQyxNQUFNLGNBQWUsa0JBQzFCRCxLQUFLQyxNQUFNLG1CQUVYLFdBQ0UsR0FBSUMsR0FBSzVJLFNBQVM2SSxjQUFjLFNBQVdELEdBQUc1RCxLQUFPLGtCQUFtQjRELEVBQUdFLE9BQVEsRUFDbkZGLEVBQUdHLEtBQU8sVUFBWS9JLFNBQVNnSixTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJbEosU0FBU21KLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFULEVBQUlNIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgU0tJTjogXCIvcmlzZS1jb21tb24vc2NyaXB0cy9qdy1wbGF5ZXIvc2tpbnMvc2l4LnhtbFwiXG4gIH07XG5cbiAgaWYgKHR5cGVvZiBhbmd1bGFyICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoXCJyaXNldmlzaW9uLmNvbW1vbi5pMThuLmNvbmZpZ1wiLCBbXSlcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfUFJFRklYXCIsIFwibG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcbiAgfVxufVxuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5SaXNlQ2FjaGUgPSAoZnVuY3Rpb24gKCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICBmdW5jdGlvbiBnZXRVcmwoKSB7XG4gICAgcmV0dXJuIFwiaHR0cDovL2xvY2FsaG9zdDo5NDk0Lz91cmw9XCI7XG4gIH1cblxuICBmdW5jdGlvbiBwaW5nKGNhbGxiYWNrKSB7XG4gICAgdmFyIHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIGlmIChjYWxsYmFjayAmJiB0eXBlb2YgY2FsbGJhY2sgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHIub3BlbihcIkdFVFwiLCBcImh0dHA6Ly9sb2NhbGhvc3Q6OTQ5NC9waW5nXCIsIHRydWUpO1xuICAgIHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKHIucmVhZHlTdGF0ZSA9PT0gNCApIHtcbiAgICAgICAgICBpZihyLnN0YXR1cyA9PT0gMjAwKXtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRydWUsIHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlJpc2UgQ2FjaGUgaXMgbm90IHJ1bm5pbmdcIik7XG4gICAgICAgICAgICBjYWxsYmFjayhmYWxzZSwgbnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmRlYnVnKFwiQ2F1Z2h0IGV4Y2VwdGlvbjogXCIsIGUuZGVzY3JpcHRpb24pO1xuICAgICAgfVxuXG4gICAgfTtcbiAgICByLnNlbmQoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcGluZzogcGluZyxcbiAgICBnZXRVcmw6ICBnZXRVcmxcbiAgfTtcblxufSkoKTtcblxuLyogZ2xvYmFsIGdhZGdldHMgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvID0gKGZ1bmN0aW9uIChkb2N1bWVudCwgZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX3ByZWZzID0gbnVsbCxcbiAgICBfYmFja2dyb3VuZCA9IG51bGwsXG4gICAgX2luaXRpYWxQbGF5ID0gdHJ1ZSxcbiAgICBfcGxheWVyLCBfYWRkaXRpb25hbFBhcmFtcztcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfZG9uZSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9kb25lXCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9iYWNrZ3JvdW5kUmVhZHkoKSB7XG4gICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBQbGF5ZXIgaW5zdGFuY2VcbiAgICBfcGxheWVyID0gUmlzZVZpc2lvbi5WaWRlby5QbGF5ZXI7XG4gICAgX3BsYXllci5pbml0KF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgX3BsYXllci5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICAvLyBcImF1dG9wbGF5XCIgd2FzIHNlbGVjdGVkIGluIHNldHRpbmdzXG4gICAgaWYgKF9pbml0aWFsUGxheSkge1xuICAgICAgX2luaXRpYWxQbGF5ID0gZmFsc2U7XG5cbiAgICAgIGlmIChfYWRkaXRpb25hbFBhcmFtcy52aWRlby5hdXRvcGxheSkge1xuICAgICAgICBfcGxheWVyLnBsYXkoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9wbGF5ZXIucGxheSh0cnVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgX3BsYXllci5wbGF5KCk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJSZWFkeSgpIHtcbiAgICBfcmVhZHkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMobmFtZXMsIHZhbHVlcykge1xuICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWVzKSAmJiBuYW1lcy5sZW5ndGggPiAwICYmIG5hbWVzWzBdID09PSBcImFkZGl0aW9uYWxQYXJhbXNcIikge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzKSAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcyA9IEpTT04ucGFyc2UodmFsdWVzWzBdKTtcbiAgICAgICAgX3ByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcblxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgKyBcInB4XCI7XG5cbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMud2lkdGggPSBfcHJlZnMuZ2V0SW50KFwicnNXXCIpO1xuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgQmFja2dyb3VuZCBpbnN0YW5jZVxuICAgICAgICBfYmFja2dyb3VuZCA9IG5ldyBSaXNlVmlzaW9uLkNvbW1vbi5CYWNrZ3JvdW5kKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgX2JhY2tncm91bmQuaW5pdChfYmFja2dyb3VuZFJlYWR5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1Jpc2UtVmlzaW9uL3ZpZXdlci9pc3N1ZXMvMzBcbiAgICAvLyBIYXZlIHRvIGNhbGwgcGF1c2UoKSBkdWUgdG8gVmlld2VyIGlzc3VlXG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHZpZGVvRW5kZWQoKSB7XG4gICAgX2RvbmUoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInNldEFkZGl0aW9uYWxQYXJhbXNcIjogc2V0QWRkaXRpb25hbFBhcmFtcyxcbiAgICBcInBsYXllclJlYWR5XCI6IHBsYXllclJlYWR5LFxuICAgIFwic3RvcFwiOiBzdG9wLFxuICAgIFwidmlkZW9FbmRlZFwiOiB2aWRlb0VuZGVkXG4gIH07XG5cbn0pKGRvY3VtZW50LCBnYWRnZXRzKTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uQmFja2dyb3VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfY2FsbGJhY2sgPSBudWxsLFxuICAgIF9yZWFkeSA9IGZhbHNlLFxuICAgIF9iYWNrZ3JvdW5kID0gbnVsbCxcbiAgICBfc3RvcmFnZSA9IG51bGwsXG4gICAgX3JlZnJlc2hEdXJhdGlvbiA9IDkwMDAwMCwgLy8gMTUgbWludXRlc1xuICAgIF9pc1N0b3JhZ2VGaWxlID0gZmFsc2UsXG4gICAgX3NlcGFyYXRvciA9IFwiXCI7XG5cbiAgLypcbiAgICogUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfcmVmcmVzaFRpbWVyKCkge1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gYmFja2dyb3VuZFJlZnJlc2goKSB7XG4gICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwgKyBfc2VwYXJhdG9yICsgXCJjYj1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgXCIpXCI7XG4gICAgICBfcmVmcmVzaFRpbWVyKCk7XG4gICAgfSwgX3JlZnJlc2hEdXJhdGlvbik7XG4gIH1cblxuICBmdW5jdGlvbiBfYmFja2dyb3VuZFJlYWR5KCkge1xuICAgIF9yZWFkeSA9IHRydWU7XG5cbiAgICBpZiAoZGF0YS5iYWNrZ3JvdW5kLnVzZUltYWdlICYmICFfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgLy8gc3RhcnQgdGhlIHJlZnJlc2ggcG9sbCBmb3Igbm9uLXN0b3JhZ2UgYmFja2dyb3VuZCBpbWFnZVxuICAgICAgX3JlZnJlc2hUaW1lcigpO1xuICAgIH1cblxuICAgIGlmIChfY2FsbGJhY2sgJiYgdHlwZW9mIF9jYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBfY2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfY29uZmlndXJlKCkge1xuICAgIHZhciBzdHI7XG5cbiAgICBfYmFja2dyb3VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZFwiKTtcbiAgICBfc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZFN0b3JhZ2VcIik7XG5cbiAgICAvLyBzZXQgdGhlIGRvY3VtZW50IGJhY2tncm91bmRcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmQgPSBkYXRhLmJhY2tncm91bmQuY29sb3I7XG5cbiAgICBpZiAoX2JhY2tncm91bmQpIHtcbiAgICAgIGlmIChkYXRhLmJhY2tncm91bmQudXNlSW1hZ2UpIHtcbiAgICAgICAgX2JhY2tncm91bmQuY2xhc3NOYW1lID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnBvc2l0aW9uO1xuICAgICAgICBfYmFja2dyb3VuZC5jbGFzc05hbWUgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2Uuc2NhbGUgPyBfYmFja2dyb3VuZC5jbGFzc05hbWUgKyBcIiBzY2FsZS10by1maXRcIlxuICAgICAgICAgIDogX2JhY2tncm91bmQuY2xhc3NOYW1lO1xuXG4gICAgICAgIF9pc1N0b3JhZ2VGaWxlID0gKE9iamVjdC5rZXlzKGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UpLmxlbmd0aCAhPT0gMCk7XG5cbiAgICAgICAgaWYgKCFfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgICAgIHN0ciA9IGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwuc3BsaXQoXCI/XCIpO1xuXG4gICAgICAgICAgLy8gc3RvcmUgdGhpcyBmb3IgdGhlIHJlZnJlc2ggdGltZXJcbiAgICAgICAgICBfc2VwYXJhdG9yID0gKHN0ci5sZW5ndGggPT09IDEpID8gXCI/XCIgOiBcIiZcIjtcblxuICAgICAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnVybCArIFwiKVwiO1xuICAgICAgICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoX3N0b3JhZ2UpIHtcbiAgICAgICAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgICAgICAgX3N0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBpZiAoZS5kZXRhaWwgJiYgZS5kZXRhaWwuZmlsZXMgJiYgZS5kZXRhaWwuZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZS5kZXRhaWwuZmlsZXNbMF0udXJsICsgXCIpXCI7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIV9yZWFkeSkge1xuICAgICAgICAgICAgICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZvbGRlcik7XG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImNvbXBhbnlJZFwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgICAgICAgICBfc3RvcmFnZS5nbygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZWxlbWVudCB3aXRoIGlkIHZhbHVlIG9mICdiYWNrZ3JvdW5kU3RvcmFnZSdcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiTWlzc2luZyBlbGVtZW50IHdpdGggaWQgdmFsdWUgb2YgJ2JhY2tncm91bmQnXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdChjYikge1xuICAgIGlmICghX3JlYWR5KSB7XG4gICAgICBpZiAoY2IpIHtcbiAgICAgICAgX2NhbGxiYWNrID0gY2I7XG4gICAgICB9XG5cbiAgICAgIF9jb25maWd1cmUoKTtcblxuICAgIH0gZWxzZSBpZiAoY2IgJiYgdHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGNiKCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxuLyogZ2xvYmFsIGp3cGxheWVyLCBjb25maWcgKi9cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSBSaXNlVmlzaW9uLlZpZGVvIHx8IHt9O1xuXG5cblJpc2VWaXNpb24uVmlkZW8uUGxheWVyID0gKGZ1bmN0aW9uIChkb2N1bWVudCwgandwbGF5ZXIsIGNhY2hlLCBjb25maWcpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hdXRvUGxheSwgX3ZvbHVtZSwgX3NjYWxlVG9GaXQsIF91cmwsIF9zdG9yYWdlVXJsO1xuICB2YXIgX3dpZHRoLCBfaGVpZ2h0O1xuICB2YXIgX2lzU3RvcmFnZUZpbGU7XG5cbiAgdmFyIF9pc0xvYWRpbmcgPSB0cnVlLFxuICAgIF9wbGF5ZXJFcnJvciA9IGZhbHNlLFxuICAgIF9zZXBhcmF0b3IgPSBcIlwiLFxuICAgIF9yaXNlQ2FjaGVSdW5uaW5nID0gZmFsc2UsXG4gICAgX3JlZnJlc2hXYWl0aW5nID0gZmFsc2UsXG4gICAgX3JlZnJlc2hEdXJhdGlvbiA9IDkwMDAwMDsgLy8gMTUgbWludXRlc1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9nZXRWaWRlb0ZpbGVUeXBlKHVybCkge1xuICAgIHZhciBleHRlbnNpb25zID0gW1wiLm1wNFwiLCBcIi53ZWJtXCIsIFwiLm9nZ1wiLCBcIi5vZ3ZcIl0sXG4gICAgICB1cmxMb3dlcmNhc2UgPSB1cmwudG9Mb3dlckNhc2UoKSxcbiAgICAgIHR5cGUgPSBudWxsLFxuICAgICAgaTtcblxuICAgIGZvciAoaSA9IDA7IGkgPD0gZXh0ZW5zaW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgaWYgKHVybExvd2VyY2FzZS5pbmRleE9mKGV4dGVuc2lvbnNbaV0pICE9PSAtMSkge1xuICAgICAgICB0eXBlID0gZXh0ZW5zaW9uc1tpXS5zdWJzdHIoZXh0ZW5zaW9uc1tpXS5sYXN0SW5kZXhPZihcIi5cIikgKyAxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGUgPT09IFwib2d2XCIpIHtcbiAgICAgIHR5cGUgPSBcIm9nZ1wiO1xuICAgIH1cblxuICAgIHJldHVybiB0eXBlO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlZnJlc2hUaW1lcigpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIGRvIG5vdCBkbyBhbnkgaW1tZWRpYXRlIGFjdGlvbiB0byBhdm9pZCBhbnkgdW5mb3Jlc2VlbiBzY2VuYXJpb1xuICAgICAgLy8gd2FpdCB1bnRpbCB2aWV3ZXIgaGFzIHRvbGQgd2lkZ2V0IHRvIHBhdXNlXG4gICAgICBfcmVmcmVzaFdhaXRpbmcgPSB0cnVlO1xuICAgIH0sIF9yZWZyZXNoRHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlZnJlc2goKSB7XG4gICAgdmFyIGZpbGVUeXBlO1xuXG4gICAgaWYgKF9pc1N0b3JhZ2VGaWxlKSB7XG4gICAgICBmaWxlVHlwZSA9IF9nZXRWaWRlb0ZpbGVUeXBlKF9zdG9yYWdlVXJsKTtcblxuICAgICAgX3JlZnJlc2hXYWl0aW5nID0gZmFsc2U7XG5cbiAgICAgIGNvbnNvbGUuZGVidWcoXCJSZWZyZXNoLCBKVyBQbGF5ZXIgbG9hZDogXCIsIFtfc3RvcmFnZVVybCwgZmlsZVR5cGVdKTtcblxuICAgICAgLy8gbG9hZCBhIG5ldyBcInBsYXlsaXN0XCJcbiAgICAgIGp3cGxheWVyKCkubG9hZChbe1xuICAgICAgICBmaWxlOiBfc3RvcmFnZVVybCxcbiAgICAgICAgdHlwZTogZmlsZVR5cGVcbiAgICAgIH1dKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICBmaWxlVHlwZSA9IF9nZXRWaWRlb0ZpbGVUeXBlKF91cmwpO1xuXG4gICAgICBjYWNoZS5waW5nKGZ1bmN0aW9uIChpc1J1bm5pbmcpIHtcbiAgICAgICAgX3Jpc2VDYWNoZVJ1bm5pbmcgPSBpc1J1bm5pbmc7XG5cbiAgICAgICAgX3JlZnJlc2hXYWl0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlJlZnJlc2gsIEpXIFBsYXllciBsb2FkOiBcIixcbiAgICAgICAgICBbX3Jpc2VDYWNoZVJ1bm5pbmcgPyBjYWNoZS5nZXRVcmwoKSArIGVuY29kZVVSSUNvbXBvbmVudChfdXJsKSA6IF91cmwsIGZpbGVUeXBlXSk7XG5cbiAgICAgICAgLy8gbG9hZCBhIG5ldyBcInBsYXlsaXN0XCJcbiAgICAgICAgandwbGF5ZXIoKS5sb2FkKFt7XG4gICAgICAgICAgZmlsZTogX3Jpc2VDYWNoZVJ1bm5pbmcgPyBjYWNoZS5nZXRVcmwoKSArIGVuY29kZVVSSUNvbXBvbmVudChfdXJsKSA6IF91cmwsXG4gICAgICAgICAgdHlwZTogZmlsZVR5cGVcbiAgICAgICAgfV0pO1xuXG4gICAgICAgIC8vIHN0YXJ0IHRoZSByZWZyZXNoIHRpbWVyIGFnYWluIGZvciB0aGlzIG5vbi1zdG9yYWdlIHZpZGVvXG4gICAgICAgIF9yZWZyZXNoVGltZXIoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblZpZGVvQ29tcGxldGUoKSB7XG4gICAgY29uc29sZS5kZWJ1ZyhcIkpXIFBsYXllciB2aWRlbyBjb21wbGV0ZVwiKTtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnZpZGVvRW5kZWQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblZpZGVvUGxheSgpIHtcbiAgICAvLyBKVyBQbGF5ZXIgZmlyZXMgb25QbGF5IHR3aWNlIHdoZW4gdmlkZW8gaXMgYmVpbmcgcGxheWVkIGZyb20gaW5pdGlhbCBwb3NpdGlvblxuICAgIGlmIChfaXNMb2FkaW5nKSB7XG4gICAgICBfaXNMb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgIGlmICghX2lzU3RvcmFnZUZpbGUpIHtcbiAgICAgICAgX3JlZnJlc2hUaW1lcigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF9wbGF5ZXJFcnJvciA9IGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gX29uUGxheWVyUmVhZHkoKSB7XG4gICAgandwbGF5ZXIoKS5zZXRNdXRlKGZhbHNlKTtcbiAgICBqd3BsYXllcigpLnNldFZvbHVtZShfdm9sdW1lKTtcblxuICAgIC8vIG5vdyBub3RpZnkgVmlld2VyIHRoYXQgcGxheWVyIGlzIHJlYWR5XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wbGF5ZXJSZWFkeSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gX29uUGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBjb25zb2xlLmRlYnVnKFwiSlcgUGxheWVyIEVycm9yIC0gXCIsIGVycm9yKTtcblxuICAgIF9wbGF5ZXJFcnJvciA9IHRydWU7XG5cbiAgICBpZiAoX2lzTG9hZGluZykge1xuICAgICAgX2lzTG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICBpZiAoIV9pc1N0b3JhZ2VGaWxlKSB7XG4gICAgICAgIF9yZWZyZXNoVGltZXIoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBSaXNlVmlzaW9uLlZpZGVvLnZpZGVvRW5kZWQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9sb2FkKCkge1xuICAgIHZhciBmaWxlLCBmaWxlVHlwZTtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9KV1wiKS5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcblxuICAgIGlmIChfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgZmlsZSA9IF9zdG9yYWdlVXJsO1xuICAgICAgZmlsZVR5cGUgPSBfZ2V0VmlkZW9GaWxlVHlwZShfc3RvcmFnZVVybCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpbGUgPSBfcmlzZUNhY2hlUnVubmluZyA/IGNhY2hlLmdldFVybCgpICsgZW5jb2RlVVJJQ29tcG9uZW50KF91cmwpIDogX3VybDtcbiAgICAgIGZpbGVUeXBlID0gX2dldFZpZGVvRmlsZVR5cGUoX3VybCk7XG4gICAgfVxuXG4gICAgY29uc29sZS5kZWJ1ZyhcIkpXIFBsYXllciBzZXR1cDogXCIsIFtmaWxlLCBmaWxlVHlwZV0pO1xuXG4gICAgandwbGF5ZXIoXCJ2aWRlb0pXXCIpLnNldHVwKHtcbiAgICAgIGZpbGUgOiBmaWxlLFxuICAgICAgdHlwZTogZmlsZVR5cGUsXG4gICAgICB3aWR0aCA6IF93aWR0aCxcbiAgICAgIGhlaWdodCA6IF9oZWlnaHQsXG4gICAgICBjb250cm9sczogIV9hdXRvUGxheSxcbiAgICAgIG11dGU6IHRydWUsXG4gICAgICBzdHJldGNoaW5nIDogX3NjYWxlVG9GaXQgPyBcInVuaWZvcm1cIiA6IFwibm9uZVwiLFxuICAgICAgcHJpbWFyeTogXCJodG1sNVwiLFxuICAgICAgc2tpbjogY29uZmlnLlNLSU4sXG4gICAgICBldmVudHMgOiB7XG4gICAgICAgIG9uUmVhZHkgOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBfb25QbGF5ZXJSZWFkeShldmVudCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ29tcGxldGUgOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBfb25WaWRlb0NvbXBsZXRlKGV2ZW50KTtcbiAgICAgICAgfSxcbiAgICAgICAgb25FcnJvciA6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIF9vblBsYXllckVycm9yKGVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25QbGF5IDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgX29uVmlkZW9QbGF5KGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gIH1cblxuICBmdW5jdGlvbiBfb25SaXNlU3RvcmFnZVJlc3BvbnNlKGUpIHtcbiAgICBjb25zb2xlLmRlYnVnKFwiUmlzZSBTdG9yYWdlIHJlc3BvbnNlIC0gXCIsIGUpO1xuICAgIGlmIChlLmRldGFpbCAmJiBlLmRldGFpbC5maWxlcyAmJiBlLmRldGFpbC5maWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICBfc3RvcmFnZVVybCA9IGUuZGV0YWlsLmZpbGVzWzBdLnVybDtcblxuICAgICAgaWYgKF9pc0xvYWRpbmcpIHtcbiAgICAgICAgX2xvYWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGRvIG5vdCBkbyBhbnkgaW1tZWRpYXRlIGFjdGlvbiB0byBhdm9pZCBhbnkgdW5mb3Jlc2VlbiBzY2VuYXJpb1xuICAgICAgICAvLyB3YWl0IHVudGlsIHZpZXdlciBoYXMgdG9sZCB3aWRnZXQgdG8gcGF1c2VcbiAgICAgICAgX3JlZnJlc2hXYWl0aW5nID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoZGF0YSkge1xuICAgIHZhciB2aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9KV1wiKSxcbiAgICAgIHN0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvU3RvcmFnZVwiKSxcbiAgICAgIHN0cjtcblxuICAgIGlmICghdmlkZW8gfHwgIXN0b3JhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBfYXV0b1BsYXkgPSBkYXRhLnZpZGVvLmF1dG9wbGF5O1xuICAgIF92b2x1bWUgPSBkYXRhLnZpZGVvLnZvbHVtZTtcbiAgICBfc2NhbGVUb0ZpdCA9IGRhdGEudmlkZW8uc2NhbGVUb0ZpdDtcbiAgICBfdXJsID0gZGF0YS51cmw7XG5cbiAgICBfd2lkdGggPSBkYXRhLndpZHRoO1xuICAgIF9oZWlnaHQgPSBkYXRhLmhlaWdodDtcblxuICAgIF9pc1N0b3JhZ2VGaWxlID0gKE9iamVjdC5rZXlzKGRhdGEudmlkZW9TdG9yYWdlKS5sZW5ndGggIT09IDApO1xuXG4gICAgaWYgKCFfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgc3RyID0gX3VybC5zcGxpdChcIj9cIik7XG4gICAgICAvLyBzdG9yZSB0aGlzIGZvciB0aGUgcmVmcmVzaCB0aW1lclxuICAgICAgX3NlcGFyYXRvciA9IChzdHIubGVuZ3RoID09PSAxKSA/IFwiP1wiIDogXCImXCI7XG5cbiAgICAgIGNhY2hlLnBpbmcoZnVuY3Rpb24gKGlzUnVubmluZykge1xuICAgICAgICBfcmlzZUNhY2hlUnVubmluZyA9IGlzUnVubmluZztcbiAgICAgICAgX2xvYWQoKTtcbiAgICAgIH0pO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIF9vblJpc2VTdG9yYWdlUmVzcG9uc2UpO1xuXG4gICAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnZpZGVvU3RvcmFnZS5mb2xkZXIpO1xuICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLnZpZGVvU3RvcmFnZS5maWxlTmFtZSk7XG4gICAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImNvbXBhbnlJZFwiLCBkYXRhLnZpZGVvU3RvcmFnZS5jb21wYW55SWQpO1xuICAgICAgc3RvcmFnZS5nbygpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIHZhciBzdGF0ZSA9IGp3cGxheWVyKCkuZ2V0U3RhdGUoKTtcblxuICAgIGlmIChzdGF0ZSA9PT0gXCJCVUZGRVJJTkdcIiB8fCBzdGF0ZSA9PT0gXCJQTEFZSU5HXCIpIHtcbiAgICAgIGp3cGxheWVyKCkucGF1c2UodHJ1ZSk7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0pXXCIpLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXG4gICAgaWYgKF9yZWZyZXNoV2FpdGluZykge1xuICAgICAgX3JlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KHNob3dPbmx5KSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0pXXCIpLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcblxuICAgIGlmICghX3BsYXllckVycm9yKSB7XG4gICAgICBpZiAoIXNob3dPbmx5KSB7XG4gICAgICAgIGlmIChqd3BsYXllcigpLmdldFBvc2l0aW9uKCkgPiAwKSB7XG4gICAgICAgICAgandwbGF5ZXIoKS5zZWVrKDApO1xuICAgICAgICAgIGp3cGxheWVyKCkucGxheSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBqd3BsYXllcigpLnBsYXkodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICBSaXNlVmlzaW9uLlZpZGVvLnZpZGVvRW5kZWQoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgandwbGF5ZXIoKS5yZW1vdmUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXQsXG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInJlbW92ZVwiOiByZW1vdmUsXG4gICAgXCJzdG9wXCI6IHN0b3BcblxuICB9O1xuXG59KShkb2N1bWVudCwgandwbGF5ZXIsIFJpc2VWaXNpb24uQ29tbW9uLlJpc2VDYWNoZSwgY29uZmlnKTtcblxuLyogZ2xvYmFsIGdhZGdldHMsIFJpc2VWaXNpb24gKi9cblxuKGZ1bmN0aW9uICh3aW5kb3csIGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIHByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKSxcbiAgICBpZCA9IHByZWZzLmdldFN0cmluZyhcImlkXCIpO1xuXG4gIC8vIERpc2FibGUgY29udGV4dCBtZW51IChyaWdodCBjbGljayBtZW51KVxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8ucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5zdG9wKCk7XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvbHltZXItcmVhZHlcIiwgZnVuY3Rpb24oKSB7XG4gICAgaWYgKGlkICYmIGlkICE9PSBcIlwiKSB7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfc3RvcF9cIiArIGlkLCBzdG9wKTtcblxuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBSaXNlVmlzaW9uLlZpZGVvLnNldEFkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbXCJhZGRpdGlvbmFsUGFyYW1zXCJdKTtcbiAgICB9XG4gIH0pO1xuXG59KSh3aW5kb3csIGdhZGdldHMpO1xuXG5cblxuLyoganNoaW50IGlnbm9yZTpzdGFydCAqL1xudmFyIF9nYXEgPSBfZ2FxIHx8IFtdO1xuXG5fZ2FxLnB1c2goWydfc2V0QWNjb3VudCcsICdVQS01NzA5MjE1OS0yJ10pO1xuX2dhcS5wdXNoKFsnX3RyYWNrUGFnZXZpZXcnXSk7XG5cbihmdW5jdGlvbigpIHtcbiAgdmFyIGdhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7IGdhLnR5cGUgPSAndGV4dC9qYXZhc2NyaXB0JzsgZ2EuYXN5bmMgPSB0cnVlO1xuICBnYS5zcmMgPSAoJ2h0dHBzOicgPT0gZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPyAnaHR0cHM6Ly9zc2wnIDogJ2h0dHA6Ly93d3cnKSArICcuZ29vZ2xlLWFuYWx5dGljcy5jb20vZ2EuanMnO1xuICB2YXIgcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTsgcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShnYSwgcyk7XG59KSgpO1xuLyoganNoaW50IGlnbm9yZTplbmQgKi9cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==