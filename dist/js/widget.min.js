var WIDGET_COMMON_CONFIG={AUTH_PATH_URL:"v1/widget/auth",LOGGER_CLIENT_ID:"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com",LOGGER_CLIENT_SECRET:"nlZyrcPLg6oEwO9f9Wfn29Wh",LOGGER_REFRESH_TOKEN:"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT",STORAGE_ENV:"prod",STORE_URL:"https://store-dot-rvaserver2.appspot.com/"},RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(e){"use strict";function n(e,n){Array.isArray(e)&&e.length>0&&Array.isArray(n)&&n.length>0&&("companyId"===e[0]&&(l=n[0]),"displayId"===e[1]&&(a=n[1]?n[1]:"preview"),u(l,a))}function t(t){t&&"function"==typeof t&&(u=t,l&&a?u(l,a):r&&""!==r&&(e.rpc.register("rsparam_set_"+r,n),e.rpc.call("","rsparam_get",null,r,["companyId","displayId"])))}function i(e){var n,t=/[?#&]/;return e&&"string"==typeof e?(n=e.substr(e.lastIndexOf(".")+1),t.test(n)&&(n=n.substr(0,-1!==n.indexOf("?")?n.indexOf("?"):n.length),n=n.substr(0,-1!==n.indexOf("#")?n.indexOf("#"):n.length),n=n.substr(0,-1!==n.indexOf("&")?n.indexOf("&"):n.length)),n.toLowerCase()):null}function o(e){var n=JSON.parse(JSON.stringify(c));return n.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),n.rows[0].json=JSON.parse(JSON.stringify(e)),n.rows[0].json.ts=(new Date).toISOString(),n}function s(e){var n=new Date,t=n.getUTCFullYear(),i=n.getUTCMonth()+1,o=n.getUTCDate();return 10>i&&(i="0"+i),10>o&&(o="0"+o),e+t+i+o}var r=(new e.Prefs).getString("id"),a="",l="",u=null,c={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,rows:[{insertId:""}]};return{getIds:t,getInsertData:o,getFileFormat:i,getTable:s}}(gadgets),RiseVision.Common.Logger=function(e){"use strict";function n(e){var n=new XMLHttpRequest;return new Date-u<358e4?e({}):(n.open("POST",o,!0),n.onloadend=function(){var t=JSON.parse(n.response);e({token:t.access_token,refreshedAt:new Date})},n.send(),void 0)}function t(e){return r&&l===e}function i(i,o){function d(n){var t,r,a=new XMLHttpRequest;r=s.replace("TABLE_ID",e.getTable(i)),u=n.refreshedAt||u,c=n.token||c,t=e.getInsertData(o),a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer "+c),o.cb&&"function"==typeof o.cb&&(a.onloadend=function(){o.cb(a.response)}),a.send(JSON.stringify(t))}if(i&&o&&o.event&&!t(o.event))return r=!0,l=o.event,setTimeout(function(){r=!1},a),n(d)}var o="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",s="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",r=!1,a=1e3,l="",u=0,c="";return{log:i}}(RiseVision.Common.LoggerUtils);var RiseVision=RiseVision||{};if(RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseCache=function(){"use strict";function e(e){var n=new XMLHttpRequest;e&&"function"==typeof e&&(n.open("GET",t+"ping?callback=_",!0),n.onreadystatechange=function(){try{4===n.readyState&&(i=!0,200===n.status?(o=!0,e(!0,n.responseText)):(console.debug("Rise Cache is not running"),o=!1,e(!1,null)))}catch(t){console.debug("Caught exception: ",t.description)}},n.send())}function n(e,n,s){function r(i){var o,r,a,l,u=new XMLHttpRequest;i?(o=s?t+"?url="+encodeURIComponent(e):t+"cb="+(new Date).getTime()+"?url="+encodeURIComponent(e),l={xhr:u,url:o},u.open("GET",o,!0),u.addEventListener("loadend",function(){var e=u.status||0;0===e||e>=200&&300>e?n(l):n(l,new Error("The request failed with status code: "+e))}),u.send()):(s?o=e:(r=e.split("?"),a=1===r.length?"?":"&",o=e+a+"cb="+(new Date).getTime()),l={xhr:null,url:o},n(l))}if(e&&n&&"function"==typeof n)return i?r(o):this.ping(r)}var t="http://localhost:9494/",i=!1,o=!1;return{getFile:n,ping:e}}(),"undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function n(){e.rpc.call("","rsevent_done",null,y.getString("id")),null!==O&&a(O,!0),a({event:"done"},!1)}function t(){e.rpc.call("","rsevent_ready",null,y.getString("id"),!0,!0,!0,!0,!0)}function i(){clearTimeout(T),T=null}function o(){i(),T=setTimeout(function(){n()},5e3)}function s(e,n){var t={},i=RiseVision.Common.LoggerUtils,o=null;e.event&&(t.event=e.event),e.event_details&&(t.event_details=e.event_details),e.url?o=e.url:b&&(o=b),t.file_url=o,t.file_format=i.getFileFormat(o),i.getIds(function(e,i){t.company_id=e,t.display_id=i,n(t)})}function r(e){S=!0,E.show(e),_.remove(I,function(){w||o()})}function a(e,n){n&&(O=e),s(e,function(e){A.log("video_events",e)})}function l(e){b=e,E.hide(),w||d()}function u(e){b=e,C=!1,O=null}function c(){var e=_.getFrameObject(I);return w=!0,S?(i(),void 0):(e&&e.pause(),void 0)}function d(){var e=_.getFrameObject(I);return w=!1,a({event:"play"},!1),S?(o(),void 0):(C||(e?e.play():b&&""!==b&&(_.add(0),_.createFramePlayer(0,R,b,config.SKIN,"player.html"))),void 0)}function g(){_.remove(I,function(){n()})}function m(){var e;E.hide(),w||(e=_.getFrameObject(I),e&&e.play())}function f(n,i){var o;Array.isArray(n)&&n.length>0&&"additionalParams"===n[0]&&Array.isArray(i)&&i.length>0&&(R=JSON.parse(i[0]),y=new e.Prefs,document.getElementById("videoContainer").style.height=y.getInt("rsH")+"px",R.width=y.getInt("rsW"),R.height=y.getInt("rsH"),E=new RiseVision.Common.Message(document.getElementById("videoContainer"),document.getElementById("messageContainer")),E.show("Please wait while your video is downloaded."),_=new RiseVision.Common.Video.FrameController,o=0!==Object.keys(R.storage).length,o?(V=new RiseVision.Video.Storage(R),V.init()):(h=new RiseVision.Video.NonStorage(R),h.init()),t())}function p(e){var n=null,t={};C=!0,e&&(e.type&&e.message?n=e.type+" - "+e.message:e.type?n=e.type:e.message&&(n=e.message)),t.event="player error",t.event_details=n,a(t,!0),r("Sorry, there was a problem playing the video.")}function v(){c()}var R,y=null,V=null,h=null,E=null,_=null,C=!1,w=!0,I=0,b="",O=null,T=null,S=!1,A=RiseVision.Common.Logger;return{logEvent:a,onFileInit:l,onFileRefresh:u,pause:c,play:d,setAdditionalParams:f,showError:r,playerEnded:g,playerReady:m,playerError:p,stop:v}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function n(){var n=document.getElementById("videoStorage");n&&(n.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(t?(t=!1,RiseVision.Video.onFileInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onFileRefresh(e.detail.url))}),n.addEventListener("rise-storage-no-file",function(){var e={event:"storage file not found"};RiseVision.Video.logEvent(e,!0),RiseVision.Video.showError("The selected video does not exist.")}),n.addEventListener("rise-storage-file-throttled",function(){var e={event:"storage file unavailable"};RiseVision.Video.logEvent(e,!0),RiseVision.Video.showError("The selected video is temporarily unavailable.")}),n.addEventListener("rise-storage-error",function(){var e={event:"storage error"};RiseVision.Video.logEvent(e,!0),RiseVision.Video.showError("Sorry, there was a problem playing the video from Storage.")}),n.setAttribute("folder",e.storage.folder),n.setAttribute("fileName",e.storage.fileName),n.setAttribute("companyId",e.storage.companyId),n.setAttribute("env",config.STORAGE_ENV),n.go())}var t=!0;return{init:n}};var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.NonStorage=function(e){"use strict";function n(){o.getFile(e.url,function(e,n){n?RiseVision.Video.logEvent({event:"non-storage error",event_details:n.message,url:e.url}):a?(a=!1,RiseVision.Video.onFileInit(e.url),t()):RiseVision.Video.onFileRefresh(e.url)})}function t(){null===r&&(r=setInterval(function(){n()},s))}function i(){n()}var o=RiseVision.Common.RiseCache,s=9e5,r=null,a=!0;return{init:i}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function n(n){var t,i=e(n);return t=i.querySelector("iframe"),t?t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument:null}function t(t){var i,o=e(t),s=n(t);s&&(i=o.querySelector("iframe"),s.remove(),i.setAttribute("src","about:blank"))}function i(n){var t=e(n),i=document.createElement("iframe");i.setAttribute("allowTransparency",!0),i.setAttribute("frameborder","0"),i.setAttribute("scrolling","no"),t.appendChild(i)}function o(t,i,o,s,r){var a,l=e(t),u=n(t);u&&(a=l.querySelector("iframe"),a.onload=function(){a.onload=null,u.init(i,o,s),u.load()},a.setAttribute("src",r))}function s(n){var t=e(n);t.style.visibility="hidden"}function r(e,n){var i=document.getElementById(l+e);t(e),setTimeout(function(){for(;i.firstChild;)i.removeChild(i.firstChild);n&&"function"==typeof n&&n()},200)}function a(n){var t=e(n);t.style.visibility="visible"}var l="if_";return{add:i,createFramePlayer:o,getFrameContainer:e,getFrameObject:n,hide:s,remove:r,show:a}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,n){"use strict";function t(){try{n.style.height=e.style.height}catch(t){console.warn("Can't initialize Message - ",t.message)}}function i(){if(s){for(;n.firstChild;)n.removeChild(n.firstChild);n.style.display="none",e.style.visibility="visible",s=!1}}function o(t){var i,o=document.createDocumentFragment();s?(i=n.querySelector(".message"),i.innerHTML=t):(e.style.visibility="hidden",n.style.display="block",i=document.createElement("p"),i.innerHTML=t,i.setAttribute("class","message"),i.style.lineHeight=n.style.height,o.appendChild(i),n.appendChild(o),s=!0)}var s=!1;return t(),{hide:i,show:o}},function(e,n){"use strict";function t(){RiseVision.Video.play()}function i(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function s(){e.removeEventListener("WebComponentsReady",s),a&&""!==a&&(n.rpc.register("rscmd_play_"+a,t),n.rpc.register("rscmd_pause_"+a,i),n.rpc.register("rscmd_stop_"+a,o),n.rpc.register("rsparam_set_"+a,RiseVision.Video.setAdditionalParams),n.rpc.call("","rsparam_get",null,a,["additionalParams"]))}var r=new n.Prefs,a=r.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",s)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiV0lER0VUX0NPTU1PTl9DT05GSUciLCJBVVRIX1BBVEhfVVJMIiwiTE9HR0VSX0NMSUVOVF9JRCIsIkxPR0dFUl9DTElFTlRfU0VDUkVUIiwiTE9HR0VSX1JFRlJFU0hfVE9LRU4iLCJTVE9SQUdFX0VOViIsIlNUT1JFX1VSTCIsIlJpc2VWaXNpb24iLCJDb21tb24iLCJMb2dnZXJVdGlscyIsImdhZGdldHMiLCJzZXRJZHMiLCJuYW1lcyIsInZhbHVlcyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImNvbXBhbnlJZCIsImRpc3BsYXlJZCIsImNhbGxiYWNrIiwiZ2V0SWRzIiwiY2IiLCJpZCIsInJwYyIsInJlZ2lzdGVyIiwiY2FsbCIsImdldEZpbGVGb3JtYXQiLCJ1cmwiLCJzdHIiLCJoYXNQYXJhbXMiLCJzdWJzdHIiLCJsYXN0SW5kZXhPZiIsInRlc3QiLCJpbmRleE9mIiwidG9Mb3dlckNhc2UiLCJnZXRJbnNlcnREYXRhIiwicGFyYW1zIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsIkJBU0VfSU5TRVJUX1NDSEVNQSIsInJvd3MiLCJpbnNlcnRJZCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIiwianNvbiIsInRzIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZ2V0VGFibGUiLCJuYW1lIiwiZGF0ZSIsInllYXIiLCJnZXRVVENGdWxsWWVhciIsIm1vbnRoIiwiZ2V0VVRDTW9udGgiLCJkYXkiLCJnZXRVVENEYXRlIiwiUHJlZnMiLCJnZXRTdHJpbmciLCJraW5kIiwic2tpcEludmFsaWRSb3dzIiwiaWdub3JlVW5rbm93blZhbHVlcyIsIkxvZ2dlciIsInV0aWxzIiwicmVmcmVzaFRva2VuIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJyZWZyZXNoRGF0ZSIsIm9wZW4iLCJSRUZSRVNIX1VSTCIsIm9ubG9hZGVuZCIsInJlc3AiLCJyZXNwb25zZSIsInRva2VuIiwiYWNjZXNzX3Rva2VuIiwicmVmcmVzaGVkQXQiLCJzZW5kIiwiaXNUaHJvdHRsZWQiLCJldmVudCIsInRocm90dGxlIiwibGFzdEV2ZW50IiwibG9nIiwidGFibGVOYW1lIiwiaW5zZXJ0V2l0aFRva2VuIiwicmVmcmVzaERhdGEiLCJpbnNlcnREYXRhIiwic2VydmljZVVybCIsInJlcGxhY2UiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2V0VGltZW91dCIsInRocm90dGxlRGVsYXkiLCJSaXNlQ2FjaGUiLCJwaW5nIiwiciIsIkJBU0VfQ0FDSEVfVVJMIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsIl9waW5nUmVjZWl2ZWQiLCJzdGF0dXMiLCJfaXNDYWNoZVJ1bm5pbmciLCJyZXNwb25zZVRleHQiLCJjb25zb2xlIiwiZGVidWciLCJlIiwiZGVzY3JpcHRpb24iLCJnZXRGaWxlIiwiZmlsZVVybCIsIm5vY2FjaGVidXN0ZXIiLCJmaWxlUmVxdWVzdCIsImlzQ2FjaGVSdW5uaW5nIiwic2VwYXJhdG9yIiwicmVxdWVzdCIsImVuY29kZVVSSUNvbXBvbmVudCIsImdldFRpbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiRXJyb3IiLCJzcGxpdCIsInRoaXMiLCJjb25maWciLCJTS0lOIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiVmlkZW8iLCJfZG9uZSIsIl9wcmVmcyIsIl9lcnJvciIsImxvZ0V2ZW50IiwiX3JlYWR5IiwiX2NsZWFyRXJyb3JUaW1lciIsImNsZWFyVGltZW91dCIsIl9lcnJvclRpbWVyIiwiX3N0YXJ0RXJyb3JUaW1lciIsIl9nZXRMb2dnZXJQYXJhbXMiLCJldmVudF9kZXRhaWxzIiwiX2N1cnJlbnRGaWxlIiwiZmlsZV91cmwiLCJmaWxlX2Zvcm1hdCIsImNvbXBhbnlfaWQiLCJkaXNwbGF5X2lkIiwic2hvd0Vycm9yIiwibWVzc2FnZSIsIl9lcnJvckZsYWciLCJfbWVzc2FnZSIsInNob3ciLCJfZnJhbWVDb250cm9sbGVyIiwicmVtb3ZlIiwiX2N1cnJlbnRGcmFtZSIsIl92aWV3ZXJQYXVzZWQiLCJpc0Vycm9yIiwiX2xvZ2dlciIsIm9uRmlsZUluaXQiLCJoaWRlIiwicGxheSIsIm9uRmlsZVJlZnJlc2giLCJfcGxheWJhY2tFcnJvciIsInBhdXNlIiwiZnJhbWVPYmoiLCJnZXRGcmFtZU9iamVjdCIsImFkZCIsImNyZWF0ZUZyYW1lUGxheWVyIiwiX2FkZGl0aW9uYWxQYXJhbXMiLCJwbGF5ZXJFbmRlZCIsInBsYXllclJlYWR5Iiwic2V0QWRkaXRpb25hbFBhcmFtcyIsImlzU3RvcmFnZUZpbGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJoZWlnaHQiLCJnZXRJbnQiLCJ3aWR0aCIsIk1lc3NhZ2UiLCJGcmFtZUNvbnRyb2xsZXIiLCJPYmplY3QiLCJrZXlzIiwic3RvcmFnZSIsIl9zdG9yYWdlIiwiU3RvcmFnZSIsImluaXQiLCJfbm9uU3RvcmFnZSIsIk5vblN0b3JhZ2UiLCJwbGF5ZXJFcnJvciIsImVycm9yIiwiZGV0YWlscyIsInR5cGUiLCJzdG9wIiwiZGV0YWlsIiwiX2luaXRpYWxMb2FkIiwiaGFzT3duUHJvcGVydHkiLCJjaGFuZ2VkIiwic2V0QXR0cmlidXRlIiwiZm9sZGVyIiwiZmlsZU5hbWUiLCJnbyIsIl9nZXRGaWxlIiwicmlzZUNhY2hlIiwiX2lzTG9hZGluZyIsIl9zdGFydFJlZnJlc2hJbnRlcnZhbCIsIl9yZWZyZXNoSW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiX3JlZnJlc2hEdXJhdGlvbiIsImdldEZyYW1lQ29udGFpbmVyIiwiaW5kZXgiLCJQUkVGSVgiLCJpZnJhbWUiLCJmcmFtZUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50V2luZG93IiwiY29udGVudERvY3VtZW50IiwiX2NsZWFyIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiZmlsZXMiLCJza2luIiwic3JjIiwib25sb2FkIiwibG9hZCIsInZpc2liaWxpdHkiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJtYWluQ29udGFpbmVyIiwibWVzc2FnZUNvbnRhaW5lciIsIl9pbml0Iiwid2FybiIsIl9hY3RpdmUiLCJkaXNwbGF5IiwicCIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImlubmVySFRNTCIsImxpbmVIZWlnaHQiLCJ3aW5kb3ciLCJwb2x5bWVyUmVhZHkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicHJlZnMiLCJvbmNvbnRleHRtZW51IiwiX2dhcSIsInB1c2giLCJnYSIsImFzeW5jIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLHVCQUNGQyxjQUFlLGlCQUNmQyxpQkFBa0IsNEVBQ2xCQyxxQkFBc0IsMkJBQ3RCQyxxQkFBc0IscUVBQ3RCQyxZQUFhLE9BQ2JDLFVBQVcsNkNBSVRDLFdBQWFBLGNBQ2pCQSxZQUFXQyxPQUFTRCxXQUFXQyxXQUUvQkQsV0FBV0MsT0FBT0MsWUFBYyxTQUFVQyxHQUN4QyxZQXNCQSxTQUFTQyxHQUFPQyxFQUFPQyxHQUNqQkMsTUFBTUMsUUFBUUgsSUFBVUEsRUFBTUksT0FBUyxHQUNyQ0YsTUFBTUMsUUFBUUYsSUFBV0EsRUFBT0csT0FBUyxJQUMxQixjQUFiSixFQUFNLEtBQ1JLLEVBQVlKLEVBQU8sSUFHSixjQUFiRCxFQUFNLEtBRU5NLEVBREVMLEVBQU8sR0FDR0EsRUFBTyxHQUdQLFdBSWhCTSxFQUFTRixFQUFXQyxJQVExQixRQUFTRSxHQUFPQyxHQUNUQSxHQUFvQixrQkFBUEEsS0FJaEJGLEVBQVdFLEVBR1RKLEdBQWFDLEVBQ2ZDLEVBQVNGLEVBQVdDLEdBR2hCSSxHQUFhLEtBQVBBLElBQ1JaLEVBQVFhLElBQUlDLFNBQVMsZUFBaUJGLEVBQUlYLEdBQzFDRCxFQUFRYSxJQUFJRSxLQUFLLEdBQUksY0FBZSxLQUFNSCxHQUFLLFlBQWEsZ0JBS2xFLFFBQVNJLEdB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QUN0QnZDLEVBQUt5TixFQUFNakwsVUFBVSxLQUd2QjhLLEdBQU9JLGNBQWdCLFdBQ3JCLE9BQU8sR0E0QlRKLEVBQU90SCxpQkFBaUIscUJBQXNCdUgsSUFFN0NELE9BQVFsTyxRQUtYLElBQUl1TyxNQUFPQSxRQUVYQSxNQUFLQyxNQUFNLGNBQWUsa0JBQzFCRCxLQUFLQyxNQUFNLG1CQUVYLFdBQ0UsR0FBSUMsR0FBS3pFLFNBQVM2QyxjQUFjLFNBQVc0QixHQUFHdEQsS0FBTyxrQkFBbUJzRCxFQUFHQyxPQUFRLEVBQ25GRCxFQUFHeEIsS0FBTyxVQUFZakQsU0FBUzJFLFNBQVNDLFNBQVcsY0FBZ0IsY0FBZ0IsNkJBQ25GLElBQUlDLEdBQUk3RSxTQUFTOEUscUJBQXFCLFVBQVUsRUFBSUQsR0FBRUUsV0FBV0MsYUFBYVAsRUFBSUkiLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBXSURHRVRfQ09NTU9OX0NPTkZJRyA9IHtcbiAgQVVUSF9QQVRIX1VSTDogXCJ2MS93aWRnZXQvYXV0aFwiLFxuICBMT0dHRVJfQ0xJRU5UX0lEOiBcIjEwODg1MjcxNDcxMDktNnExbzJ2dGlobjM0MjkycGp0NGNraG1oY2swcmswbzcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb21cIixcbiAgTE9HR0VSX0NMSUVOVF9TRUNSRVQ6IFwibmxaeXJjUExnNm9Fd085ZjlXZm4yOVdoXCIsXG4gIExPR0dFUl9SRUZSRVNIX1RPS0VOOiBcIjEveHp0NGt3ekUxSDdXOVZuS0I4Y0FhQ3g2emI0RXM0bktFb3FhWUhkVEQxNUlnT3JKRHRkdW42eks2WGlBVENLVFwiLFxuICBTVE9SQUdFX0VOVjogXCJwcm9kXCIsXG4gIFNUT1JFX1VSTDogXCJodHRwczovL3N0b3JlLWRvdC1ydmFzZXJ2ZXIyLmFwcHNwb3QuY29tL1wiXG59O1xuLyogZ2xvYmFsIGdhZGdldHMgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMgPSAoZnVuY3Rpb24oZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICAgdmFyIGlkID0gbmV3IGdhZGdldHMuUHJlZnMoKS5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICBkaXNwbGF5SWQgPSBcIlwiLFxuICAgIGNvbXBhbnlJZCA9IFwiXCIsXG4gICAgY2FsbGJhY2sgPSBudWxsO1xuXG4gIHZhciBCQVNFX0lOU0VSVF9TQ0hFTUEgPVxuICB7XG4gICAgXCJraW5kXCI6IFwiYmlncXVlcnkjdGFibGVEYXRhSW5zZXJ0QWxsUmVxdWVzdFwiLFxuICAgIFwic2tpcEludmFsaWRSb3dzXCI6IGZhbHNlLFxuICAgIFwiaWdub3JlVW5rbm93blZhbHVlc1wiOiBmYWxzZSxcbiAgICBcInJvd3NcIjogW3tcbiAgICAgIFwiaW5zZXJ0SWRcIjogXCJcIlxuICAgIH1dXG4gIH07XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cblxuICAvKiBTZXQgdGhlIENvbXBhbnkgYW5kIERpc3BsYXkgSURzLiAqL1xuICBmdW5jdGlvbiBzZXRJZHMobmFtZXMsIHZhbHVlcykge1xuICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWVzKSAmJiBuYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGlmIChuYW1lc1swXSA9PT0gXCJjb21wYW55SWRcIikge1xuICAgICAgICAgIGNvbXBhbnlJZCA9IHZhbHVlc1swXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuYW1lc1sxXSA9PT0gXCJkaXNwbGF5SWRcIikge1xuICAgICAgICAgIGlmICh2YWx1ZXNbMV0pIHtcbiAgICAgICAgICAgIGRpc3BsYXlJZCA9IHZhbHVlc1sxXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkaXNwbGF5SWQgPSBcInByZXZpZXdcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjYWxsYmFjayhjb21wYW55SWQsIGRpc3BsYXlJZCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBnZXRJZHMoY2IpIHtcbiAgICBpZiAoIWNiIHx8IHR5cGVvZiBjYiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY2FsbGJhY2sgPSBjYjtcbiAgICB9XG5cbiAgICBpZiAoY29tcGFueUlkICYmIGRpc3BsYXlJZCkge1xuICAgICAgY2FsbGJhY2soY29tcGFueUlkLCBkaXNwbGF5SWQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIHNldElkcyk7XG4gICAgICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc3BhcmFtX2dldFwiLCBudWxsLCBpZCwgW1wiY29tcGFueUlkXCIsIFwiZGlzcGxheUlkXCJdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRGaWxlRm9ybWF0KHVybCkge1xuICAgIHZhciBoYXNQYXJhbXMgPSAvWz8jJl0vLFxuICAgICAgc3RyO1xuXG4gICAgaWYgKCF1cmwgfHwgdHlwZW9mIHVybCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgc3RyID0gdXJsLnN1YnN0cih1cmwubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG5cbiAgICAvLyBkb24ndCBpbmNsdWRlIGFueSBwYXJhbXMgYWZ0ZXIgdGhlIGZpbGVuYW1lXG4gICAgaWYgKGhhc1BhcmFtcy50ZXN0KHN0cikpIHtcbiAgICAgIHN0ciA9IHN0ci5zdWJzdHIoMCAsKHN0ci5pbmRleE9mKFwiP1wiKSAhPT0gLTEpID8gc3RyLmluZGV4T2YoXCI/XCIpIDogc3RyLmxlbmd0aCk7XG5cbiAgICAgIHN0ciA9IHN0ci5zdWJzdHIoMCwgKHN0ci5pbmRleE9mKFwiI1wiKSAhPT0gLTEpID8gc3RyLmluZGV4T2YoXCIjXCIpIDogc3RyLmxlbmd0aCk7XG5cbiAgICAgIHN0ciA9IHN0ci5zdWJzdHIoMCwgKHN0ci5pbmRleE9mKFwiJlwiKSAhPT0gLTEpID8gc3RyLmluZGV4T2YoXCImXCIpIDogc3RyLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0ci50b0xvd2VyQ2FzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SW5zZXJ0RGF0YShwYXJhbXMpIHtcbiAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoQkFTRV9JTlNFUlRfU0NIRU1BKSk7XG5cbiAgICBkYXRhLnJvd3NbMF0uaW5zZXJ0SWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMikudG9VcHBlckNhc2UoKTtcbiAgICBkYXRhLnJvd3NbMF0uanNvbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gICAgZGF0YS5yb3dzWzBdLmpzb24udHMgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFRhYmxlKG5hbWUpIHtcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCksXG4gICAgICB5ZWFyID0gZGF0ZS5nZXRVVENGdWxsWWVhcigpLFxuICAgICAgbW9udGggPSBkYXRlLmdldFVUQ01vbnRoKCkgKyAxLFxuICAgICAgZGF5ID0gZGF0ZS5nZXRVVENEYXRlKCk7XG5cbiAgICBpZiAobW9udGggPCAxMCkge1xuICAgICAgbW9udGggPSBcIjBcIiArIG1vbnRoO1xuICAgIH1cblxuICAgIGlmIChkYXkgPCAxMCkge1xuICAgICAgZGF5ID0gXCIwXCIgKyBkYXk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5hbWUgKyB5ZWFyICsgbW9udGggKyBkYXk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiZ2V0SWRzXCI6IGdldElkcyxcbiAgICBcImdldEluc2VydERhdGFcIjogZ2V0SW5zZXJ0RGF0YSxcbiAgICBcImdldEZpbGVGb3JtYXRcIjogZ2V0RmlsZUZvcm1hdCxcbiAgICBcImdldFRhYmxlXCI6IGdldFRhYmxlXG4gIH07XG59KShnYWRnZXRzKTtcblxuUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyID0gKGZ1bmN0aW9uKHV0aWxzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBSRUZSRVNIX1VSTCA9IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YzL3Rva2VuP2NsaWVudF9pZD1cIiArIFdJREdFVF9DT01NT05fQ09ORklHLkxPR0dFUl9DTElFTlRfSUQgK1xuICAgICAgXCImY2xpZW50X3NlY3JldD1cIiArIFdJREdFVF9DT01NT05fQ09ORklHLkxPR0dFUl9DTElFTlRfU0VDUkVUICtcbiAgICAgIFwiJnJlZnJlc2hfdG9rZW49XCIgKyBXSURHRVRfQ09NTU9OX0NPTkZJRy5MT0dHRVJfUkVGUkVTSF9UT0tFTiArXG4gICAgICBcIiZncmFudF90eXBlPXJlZnJlc2hfdG9rZW5cIjtcblxuICB2YXIgc2VydmljZVVybCA9IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYmlncXVlcnkvdjIvcHJvamVjdHMvY2xpZW50LXNpZGUtZXZlbnRzL2RhdGFzZXRzL1dpZGdldF9FdmVudHMvdGFibGVzL1RBQkxFX0lEL2luc2VydEFsbFwiLFxuICAgIHRocm90dGxlID0gZmFsc2UsXG4gICAgdGhyb3R0bGVEZWxheSA9IDEwMDAsXG4gICAgbGFzdEV2ZW50ID0gXCJcIixcbiAgICByZWZyZXNoRGF0ZSA9IDAsXG4gICAgdG9rZW4gPSBcIlwiO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIHJlZnJlc2hUb2tlbihjYikge1xuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIGlmIChuZXcgRGF0ZSgpIC0gcmVmcmVzaERhdGUgPCAzNTgwMDAwKSB7XG4gICAgICByZXR1cm4gY2Ioe30pO1xuICAgIH1cblxuICAgIHhoci5vcGVuKFwiUE9TVFwiLCBSRUZSRVNIX1VSTCwgdHJ1ZSk7XG4gICAgeGhyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlc3AgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZSk7XG5cbiAgICAgIGNiKHsgdG9rZW46IHJlc3AuYWNjZXNzX3Rva2VuLCByZWZyZXNoZWRBdDogbmV3IERhdGUoKSB9KTtcbiAgICB9O1xuXG4gICAgeGhyLnNlbmQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzVGhyb3R0bGVkKGV2ZW50KSB7XG4gICAgcmV0dXJuIHRocm90dGxlICYmIChsYXN0RXZlbnQgPT09IGV2ZW50KTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gbG9nKHRhYmxlTmFtZSwgcGFyYW1zKSB7XG4gICAgaWYgKCF0YWJsZU5hbWUgfHwgIXBhcmFtcyB8fCAhcGFyYW1zLmV2ZW50IHx8IGlzVGhyb3R0bGVkKHBhcmFtcy5ldmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aHJvdHRsZSA9IHRydWU7XG4gICAgbGFzdEV2ZW50ID0gcGFyYW1zLmV2ZW50O1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB0aHJvdHRsZSA9IGZhbHNlO1xuICAgIH0sIHRocm90dGxlRGVsYXkpO1xuXG4gICAgZnVuY3Rpb24gaW5zZXJ0V2l0aFRva2VuKHJlZnJlc2hEYXRhKSB7XG4gICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgIGluc2VydERhdGEsIHVybDtcblxuICAgICAgdXJsID0gc2VydmljZVVybC5yZXBsYWNlKFwiVEFCTEVfSURcIiwgdXRpbHMuZ2V0VGFibGUodGFibGVOYW1lKSk7XG4gICAgICByZWZyZXNoRGF0ZSA9IHJlZnJlc2hEYXRhLnJlZnJlc2hlZEF0IHx8IHJlZnJlc2hEYXRlO1xuICAgICAgdG9rZW4gPSByZWZyZXNoRGF0YS50b2tlbiB8fCB0b2tlbjtcbiAgICAgIGluc2VydERhdGEgPSB1dGlscy5nZXRJbnNlcnREYXRhKHBhcmFtcyk7XG5cbiAgICAgIC8vIEluc2VydCB0aGUgZGF0YS5cbiAgICAgIHhoci5vcGVuKFwiUE9TVFwiLCB1cmwsIHRydWUpO1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBdXRob3JpemF0aW9uXCIsIFwiQmVhcmVyIFwiICsgdG9rZW4pO1xuXG4gICAgICBpZiAocGFyYW1zLmNiICYmIHR5cGVvZiBwYXJhbXMuY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB4aHIub25sb2FkZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGFyYW1zLmNiKHhoci5yZXNwb25zZSk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHhoci5zZW5kKEpTT04uc3RyaW5naWZ5KGluc2VydERhdGEpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVmcmVzaFRva2VuKGluc2VydFdpdGhUb2tlbik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwibG9nXCI6IGxvZ1xuICB9O1xufSkoUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMpO1xudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uUmlzZUNhY2hlID0gKGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIEJBU0VfQ0FDSEVfVVJMID0gXCJodHRwOi8vbG9jYWxob3N0Ojk0OTQvXCI7XG5cbiAgdmFyIF9waW5nUmVjZWl2ZWQgPSBmYWxzZSxcbiAgICBfaXNDYWNoZVJ1bm5pbmcgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBwaW5nKGNhbGxiYWNrKSB7XG4gICAgdmFyIHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIGlmICghY2FsbGJhY2sgfHwgdHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICByLm9wZW4oXCJHRVRcIiwgQkFTRV9DQUNIRV9VUkwgKyBcInBpbmc/Y2FsbGJhY2s9X1wiLCB0cnVlKTtcbiAgICByLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChyLnJlYWR5U3RhdGUgPT09IDQgKSB7XG4gICAgICAgICAgLy8gc2F2ZSB0aGlzIHJlc3VsdCBmb3IgdXNlIGluIGdldEZpbGUoKVxuICAgICAgICAgIF9waW5nUmVjZWl2ZWQgPSB0cnVlO1xuXG4gICAgICAgICAgaWYoci5zdGF0dXMgPT09IDIwMCl7XG4gICAgICAgICAgICBfaXNDYWNoZVJ1bm5pbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBjYWxsYmFjayh0cnVlLCByLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJSaXNlIENhY2hlIGlzIG5vdCBydW5uaW5nXCIpO1xuICAgICAgICAgICAgX2lzQ2FjaGVSdW5uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlLCBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoXCJDYXVnaHQgZXhjZXB0aW9uOiBcIiwgZS5kZXNjcmlwdGlvbik7XG4gICAgICB9XG5cbiAgICB9O1xuICAgIHIuc2VuZCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RmlsZShmaWxlVXJsLCBjYWxsYmFjaywgbm9jYWNoZWJ1c3Rlcikge1xuICAgIGlmICghZmlsZVVybCB8fCAhY2FsbGJhY2sgfHwgdHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxlUmVxdWVzdChpc0NhY2hlUnVubmluZykge1xuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICB1cmwsIHN0ciwgc2VwYXJhdG9yLCByZXF1ZXN0O1xuXG4gICAgICBpZiAoaXNDYWNoZVJ1bm5pbmcpIHtcbiAgICAgICAgLy8gY29uZmlndXJlIHVybCB3aXRoIGNhY2hlYnVzdGVyIG9yIG5vdFxuICAgICAgICB1cmwgPSAobm9jYWNoZWJ1c3RlcikgPyBCQVNFX0NBQ0hFX1VSTCArIFwiP3VybD1cIiArIGVuY29kZVVSSUNvbXBvbmVudChmaWxlVXJsKSA6XG4gICAgICAgICAgQkFTRV9DQUNIRV9VUkwgKyBcImNiPVwiICsgbmV3IERhdGUoKS5nZXRUaW1lKCkgKyBcIj91cmw9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsZVVybCk7XG5cbiAgICAgICAgLy8gY3VzdG9tIHJlcXVlc3Qgb2JqZWN0IHRvIHByb3ZpZGUgaW4gcmVzcG9uc2VcbiAgICAgICAgcmVxdWVzdCA9IHtcbiAgICAgICAgICB4aHI6IHhocixcbiAgICAgICAgICB1cmw6IHVybFxuICAgICAgICB9O1xuXG4gICAgICAgIHhoci5vcGVuKFwiR0VUXCIsIHVybCwgdHJ1ZSk7XG5cbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHN0YXR1cyA9IHhoci5zdGF0dXMgfHwgMDtcblxuICAgICAgICAgIGlmIChzdGF0dXMgPT09IDAgfHwgKHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwKSkge1xuICAgICAgICAgICAgY2FsbGJhY2socmVxdWVzdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlcXVlc3QsIG5ldyBFcnJvcihcIlRoZSByZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlOiBcIiArIHN0YXR1cykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgeGhyLnNlbmQoKTtcblxuICAgICAgfSBlbHNlIHtcblxuICAgICAgICBpZiAobm9jYWNoZWJ1c3Rlcikge1xuICAgICAgICAgIHVybCA9IGZpbGVVcmw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RyID0gZmlsZVVybC5zcGxpdChcIj9cIik7XG4gICAgICAgICAgc2VwYXJhdG9yID0gKHN0ci5sZW5ndGggPT09IDEpID8gXCI/XCIgOiBcIiZcIjtcblxuICAgICAgICAgIHVybCA9IGZpbGVVcmwgKyBzZXBhcmF0b3IgKyBcImNiPVwiICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjdXN0b20gcmVxdWVzdCBvYmplY3QgdG8gcHJvdmlkZSBpbiByZXNwb25zZVxuICAgICAgICByZXF1ZXN0ID0ge1xuICAgICAgICAgIHhocjogbnVsbCxcbiAgICAgICAgICB1cmw6IHVybFxuICAgICAgICB9O1xuXG4gICAgICAgIGNhbGxiYWNrKHJlcXVlc3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghX3BpbmdSZWNlaXZlZCkge1xuICAgICAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgcmV0dXJuIHRoaXMucGluZyhmaWxlUmVxdWVzdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmaWxlUmVxdWVzdChfaXNDYWNoZVJ1bm5pbmcpO1xuICAgIH1cblxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRGaWxlOiBnZXRGaWxlLFxuICAgIHBpbmc6IHBpbmdcbiAgfTtcblxufSkoKTtcblxuLyogZ2xvYmFsIGNvbmZpZzogdHJ1ZSAqL1xuLyogZXhwb3J0ZWQgY29uZmlnICovXG5pZiAodHlwZW9mIGNvbmZpZyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICB2YXIgY29uZmlnID0ge1xuICAgIFNLSU46IFwic2tpbi9SVlNraW4ueG1sXCIsXG4gICAgU1RPUkFHRV9FTlY6IFwicHJvZFwiXG4gIH07XG5cbiAgaWYgKHR5cGVvZiBhbmd1bGFyICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoXCJyaXNldmlzaW9uLmNvbW1vbi5pMThuLmNvbmZpZ1wiLCBbXSlcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfUFJFRklYXCIsIFwibG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcbiAgfVxufVxuXG4vKiBnbG9iYWwgZ2FkZ2V0cywgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSB7fTtcblxuUmlzZVZpc2lvbi5WaWRlbyA9IChmdW5jdGlvbiAoZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2FkZGl0aW9uYWxQYXJhbXM7XG5cbiAgdmFyIF9wcmVmcyA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsLFxuICAgIF9ub25TdG9yYWdlID0gbnVsbCxcbiAgICBfbWVzc2FnZSA9IG51bGwsXG4gICAgX2ZyYW1lQ29udHJvbGxlciA9IG51bGw7XG5cbiAgdmFyIF9wbGF5YmFja0Vycm9yID0gZmFsc2UsXG4gICAgX3ZpZXdlclBhdXNlZCA9IHRydWU7XG5cbiAgdmFyIF9jdXJyZW50RnJhbWUgPSAwO1xuXG4gIHZhciBfY3VycmVudEZpbGUgPSBcIlwiO1xuXG4gIHZhciBfZXJyb3IgPSBudWxsLFxuICAgIF9lcnJvclRpbWVyID0gbnVsbCxcbiAgICBfZXJyb3JGbGFnID0gZmFsc2U7XG5cbiAgdmFyIF9sb2dnZXIgPSBSaXNlVmlzaW9uLkNvbW1vbi5Mb2dnZXI7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2RvbmUoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfZG9uZVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIikpO1xuXG4gICAgLy8gQW55IGVycm9ycyBuZWVkIHRvIGJlIGxvZ2dlZCBiZWZvcmUgdGhlIGRvbmUgZXZlbnQuXG4gICAgaWYgKF9lcnJvciAhPT0gbnVsbCkge1xuICAgICAgbG9nRXZlbnQoX2Vycm9yLCB0cnVlKTtcbiAgICB9XG5cbiAgICBsb2dFdmVudCh7IFwiZXZlbnRcIjogXCJkb25lXCIgfSwgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X3JlYWR5XCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICAgIHRydWUsIHRydWUsIHRydWUsIHRydWUsIHRydWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2NsZWFyRXJyb3JUaW1lcigpIHtcbiAgICBjbGVhclRpbWVvdXQoX2Vycm9yVGltZXIpO1xuICAgIF9lcnJvclRpbWVyID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdGFydEVycm9yVGltZXIoKSB7XG4gICAgX2NsZWFyRXJyb3JUaW1lcigpO1xuXG4gICAgX2Vycm9yVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIG5vdGlmeSBWaWV3ZXIgd2lkZ2V0IGlzIGRvbmVcbiAgICAgIF9kb25lKCk7XG4gICAgfSwgNTAwMCk7XG4gIH1cblxuICAvLyBHZXQgdGhlIHBhcmFtZXRlcnMgdG8gcGFzcyB0byB0aGUgZXZlbnQgbG9nZ2VyLlxuICBmdW5jdGlvbiBfZ2V0TG9nZ2VyUGFyYW1zKHBhcmFtcywgY2IpIHtcbiAgICB2YXIganNvbiA9IHt9LFxuICAgICAgdXRpbHMgPSBSaXNlVmlzaW9uLkNvbW1vbi5Mb2dnZXJVdGlscyxcbiAgICAgIHVybCA9IG51bGw7XG5cbiAgICBpZiAocGFyYW1zLmV2ZW50KSB7XG4gICAgICBqc29uLmV2ZW50ID0gcGFyYW1zLmV2ZW50O1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMuZXZlbnRfZGV0YWlscykge1xuICAgICAganNvbi5ldmVudF9kZXRhaWxzID0gcGFyYW1zLmV2ZW50X2RldGFpbHM7XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy51cmwpIHtcbiAgICAgIHVybCA9IHBhcmFtcy51cmw7XG4gICAgfVxuICAgIGVsc2UgaWYgKF9jdXJyZW50RmlsZSkge1xuICAgICAgdXJsID0gX2N1cnJlbnRGaWxlO1xuICAgIH1cblxuICAgIGpzb24uZmlsZV91cmwgPSB1cmw7XG4gICAganNvbi5maWxlX2Zvcm1hdCA9IHV0aWxzLmdldEZpbGVGb3JtYXQodXJsKTtcblxuICAgIHV0aWxzLmdldElkcyhmdW5jdGlvbihjb21wYW55SWQsIGRpc3BsYXlJZCkge1xuICAgICAganNvbi5jb21wYW55X2lkID0gY29tcGFueUlkO1xuICAgICAganNvbi5kaXNwbGF5X2lkID0gZGlzcGxheUlkO1xuXG4gICAgICBjYihqc29uKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gc2hvd0Vycm9yKG1lc3NhZ2UpIHtcbiAgICBfZXJyb3JGbGFnID0gdHJ1ZTtcblxuICAgIF9tZXNzYWdlLnNob3cobWVzc2FnZSk7XG5cbiAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBpZiBXaWRnZXQgaXMgcGxheWluZyByaWdodCBub3csIHJ1biB0aGUgdGltZXJcbiAgICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgICBfc3RhcnRFcnJvclRpbWVyKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBsb2dFdmVudChwYXJhbXMsIGlzRXJyb3IpIHtcbiAgICBpZiAoaXNFcnJvcikge1xuICAgICAgX2Vycm9yID0gcGFyYW1zO1xuICAgIH1cblxuICAgIF9nZXRMb2dnZXJQYXJhbXMocGFyYW1zLCBmdW5jdGlvbihqc29uKSB7XG4gICAgICBfbG9nZ2VyLmxvZyhcInZpZGVvX2V2ZW50c1wiLCBqc29uKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uRmlsZUluaXQodXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgX21lc3NhZ2UuaGlkZSgpO1xuXG4gICAgaWYgKCFfdmlld2VyUGF1c2VkKSB7XG4gICAgICBwbGF5KCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25GaWxlUmVmcmVzaCh1cmwpIHtcbiAgICBfY3VycmVudEZpbGUgPSB1cmw7XG5cbiAgICAvLyBpbiBjYXNlIHJlZnJlc2hlZCBmaWxlIGZpeGVzIGFuIGVycm9yIHdpdGggcHJldmlvdXMgZmlsZSwgZW5zdXJlIGZsYWcgaXMgcmVtb3ZlZCBzbyBwbGF5YmFjayBpcyBhdHRlbXB0ZWQgYWdhaW5cbiAgICBfcGxheWJhY2tFcnJvciA9IGZhbHNlO1xuICAgIF9lcnJvciA9IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgX3ZpZXdlclBhdXNlZCA9IHRydWU7XG5cbiAgICBpZiAoX2Vycm9yRmxhZykge1xuICAgICAgX2NsZWFyRXJyb3JUaW1lcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgZnJhbWVPYmoucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIHZhciBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICBfdmlld2VyUGF1c2VkID0gZmFsc2U7XG5cbiAgICBsb2dFdmVudCh7IFwiZXZlbnRcIjogXCJwbGF5XCIgfSwgZmFsc2UpO1xuXG4gICAgaWYgKF9lcnJvckZsYWcpIHtcbiAgICAgIF9zdGFydEVycm9yVGltZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIV9wbGF5YmFja0Vycm9yKSB7XG4gICAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgICAgZnJhbWVPYmoucGxheSgpO1xuICAgICAgfSBlbHNlIHtcblxuICAgICAgICBpZiAoX2N1cnJlbnRGaWxlICYmIF9jdXJyZW50RmlsZSAhPT0gXCJcIikge1xuICAgICAgICAgIC8vIGFkZCBmcmFtZSBhbmQgY3JlYXRlIHRoZSBwbGF5ZXJcbiAgICAgICAgICBfZnJhbWVDb250cm9sbGVyLmFkZCgwKTtcbiAgICAgICAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGUsIGNvbmZpZy5TS0lOLCBcInBsYXllci5odG1sXCIpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFbmRlZCgpIHtcbiAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfZG9uZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyUmVhZHkoKSB7XG4gICAgdmFyIGZyYW1lT2JqO1xuXG4gICAgLy8gRW5zdXJlcyBtZXNzYWdpbmcgaXMgaGlkZGVuIGZvciBub24tc3RvcmFnZSB2aWRlbyBmaWxlXG4gICAgX21lc3NhZ2UuaGlkZSgpO1xuXG4gICAgaWYgKCFfdmlld2VyUGF1c2VkKSB7XG4gICAgICBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgICBmcmFtZU9iai5wbGF5KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc2V0QWRkaXRpb25hbFBhcmFtcyhuYW1lcywgdmFsdWVzKSB7XG4gICAgdmFyIGlzU3RvcmFnZUZpbGU7XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCAmJiBuYW1lc1swXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBKU09OLnBhcnNlKHZhbHVlc1swXSk7XG4gICAgICAgIF9wcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCk7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0NvbnRhaW5lclwiKS5zdHlsZS5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpICsgXCJweFwiO1xuXG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLndpZHRoID0gX3ByZWZzLmdldEludChcInJzV1wiKTtcbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKTtcblxuICAgICAgICBfbWVzc2FnZSA9IG5ldyBSaXNlVmlzaW9uLkNvbW1vbi5NZXNzYWdlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIiksXG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZXNzYWdlQ29udGFpbmVyXCIpKTtcblxuICAgICAgICAvLyBzaG93IHdhaXQgbWVzc2FnZSB3aGlsZSBTdG9yYWdlIGluaXRpYWxpemVzXG4gICAgICAgIF9tZXNzYWdlLnNob3coXCJQbGVhc2Ugd2FpdCB3aGlsZSB5b3VyIHZpZGVvIGlzIGRvd25sb2FkZWQuXCIpO1xuXG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uVmlkZW8uRnJhbWVDb250cm9sbGVyKCk7XG5cbiAgICAgICAgaXNTdG9yYWdlRmlsZSA9IChPYmplY3Qua2V5cyhfYWRkaXRpb25hbFBhcmFtcy5zdG9yYWdlKS5sZW5ndGggIT09IDApO1xuXG4gICAgICAgIGlmICghaXNTdG9yYWdlRmlsZSkge1xuICAgICAgICAgIF9ub25TdG9yYWdlID0gbmV3IFJpc2VWaXNpb24uVmlkZW8uTm9uU3RvcmFnZShfYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICAgICAgX25vblN0b3JhZ2UuaW5pdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGNyZWF0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgU3RvcmFnZSBtb2R1bGUgaW5zdGFuY2VcbiAgICAgICAgICBfc3RvcmFnZSA9IG5ldyBSaXNlVmlzaW9uLlZpZGVvLlN0b3JhZ2UoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgICAgIF9zdG9yYWdlLmluaXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF9yZWFkeSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEFuIGVycm9yIG9jY3VycmVkIHdpdGggSlcgUGxheWVyLlxuICBmdW5jdGlvbiBwbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIHZhciBkZXRhaWxzID0gbnVsbCxcbiAgICAgIHBhcmFtcyA9IHt9O1xuXG4gICAgX3BsYXliYWNrRXJyb3IgPSB0cnVlO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IudHlwZSAmJiBlcnJvci5tZXNzYWdlKSB7XG4gICAgICAgIGRldGFpbHMgPSBlcnJvci50eXBlICsgXCIgLSBcIiArIGVycm9yLm1lc3NhZ2U7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChlcnJvci50eXBlKSB7XG4gICAgICAgIGRldGFpbHMgPSBlcnJvci50eXBlO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZXJyb3IubWVzc2FnZSkge1xuICAgICAgICBkZXRhaWxzID0gZXJyb3IubWVzc2FnZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBwYXJhbXMuZXZlbnQgPSBcInBsYXllciBlcnJvclwiO1xuICAgIHBhcmFtcy5ldmVudF9kZXRhaWxzID0gZGV0YWlscztcblxuICAgIGxvZ0V2ZW50KHBhcmFtcywgdHJ1ZSk7XG4gICAgc2hvd0Vycm9yKFwiU29ycnksIHRoZXJlIHdhcyBhIHByb2JsZW0gcGxheWluZyB0aGUgdmlkZW8uXCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImxvZ0V2ZW50XCI6IGxvZ0V2ZW50LFxuICAgIFwib25GaWxlSW5pdFwiOiBvbkZpbGVJbml0LFxuICAgIFwib25GaWxlUmVmcmVzaFwiOiBvbkZpbGVSZWZyZXNoLFxuICAgIFwicGF1c2VcIjogcGF1c2UsXG4gICAgXCJwbGF5XCI6IHBsYXksXG4gICAgXCJzZXRBZGRpdGlvbmFsUGFyYW1zXCI6IHNldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgXCJzaG93RXJyb3JcIjogc2hvd0Vycm9yLFxuICAgIFwicGxheWVyRW5kZWRcIjogcGxheWVyRW5kZWQsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInBsYXllckVycm9yXCI6IHBsYXllckVycm9yLFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGdhZGdldHMpO1xuXG4vKiBnbG9iYWwgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSBSaXNlVmlzaW9uLlZpZGVvIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvLlN0b3JhZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2luaXRpYWxMb2FkID0gdHJ1ZTtcblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIHN0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvU3RvcmFnZVwiKTtcblxuICAgIGlmICghc3RvcmFnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5kZXRhaWwgJiYgZS5kZXRhaWwudXJsKSB7XG5cbiAgICAgICAgaWYgKF9pbml0aWFsTG9hZCkge1xuICAgICAgICAgIF9pbml0aWFsTG9hZCA9IGZhbHNlO1xuXG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5vbkZpbGVJbml0KGUuZGV0YWlsLnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gY2hlY2sgZm9yIFwiY2hhbmdlZFwiIHByb3BlcnR5IGFuZCBlbnN1cmUgaXQgaXMgdHJ1ZVxuICAgICAgICAgIGlmIChlLmRldGFpbC5oYXNPd25Qcm9wZXJ0eShcImNoYW5nZWRcIikgJiYgZS5kZXRhaWwuY2hhbmdlZCkge1xuICAgICAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5vbkZpbGVSZWZyZXNoKGUuZGV0YWlsLnVybCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2Utbm8tZmlsZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7IFwiZXZlbnRcIjogXCJzdG9yYWdlIGZpbGUgbm90IGZvdW5kXCIgfTtcblxuICAgICAgUmlzZVZpc2lvbi5WaWRlby5sb2dFdmVudChwYXJhbXMsIHRydWUpO1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5zaG93RXJyb3IoXCJUaGUgc2VsZWN0ZWQgdmlkZW8gZG9lcyBub3QgZXhpc3QuXCIpO1xuICAgIH0pO1xuXG4gICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLWZpbGUtdGhyb3R0bGVkXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBhcmFtcyA9IHsgXCJldmVudFwiOiBcInN0b3JhZ2UgZmlsZSB1bmF2YWlsYWJsZVwiIH07XG5cbiAgICAgIFJpc2VWaXNpb24uVmlkZW8ubG9nRXZlbnQocGFyYW1zLCB0cnVlKTtcbiAgICAgIFJpc2VWaXNpb24uVmlkZW8uc2hvd0Vycm9yKFwiVGhlIHNlbGVjdGVkIHZpZGVvIGlzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlLlwiKTtcbiAgICB9KTtcblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1lcnJvclwiLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7IFwiZXZlbnRcIjogXCJzdG9yYWdlIGVycm9yXCIgfTtcblxuICAgICAgUmlzZVZpc2lvbi5WaWRlby5sb2dFdmVudChwYXJhbXMsIHRydWUpO1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5zaG93RXJyb3IoXCJTb3JyeSwgdGhlcmUgd2FzIGEgcHJvYmxlbSBwbGF5aW5nIHRoZSB2aWRlbyBmcm9tIFN0b3JhZ2UuXCIpO1xuICAgIH0pO1xuXG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5zdG9yYWdlLmZvbGRlcik7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLnN0b3JhZ2UuZmlsZU5hbWUpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuc3RvcmFnZS5jb21wYW55SWQpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZW52XCIsIGNvbmZpZy5TVE9SQUdFX0VOVik7XG4gICAgc3RvcmFnZS5nbygpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IFJpc2VWaXNpb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uVmlkZW8uTm9uU3RvcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciByaXNlQ2FjaGUgPSBSaXNlVmlzaW9uLkNvbW1vbi5SaXNlQ2FjaGU7XG5cbiAgdmFyIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsICAvLyAxNSBtaW51dGVzXG4gICAgX3JlZnJlc2hJbnRlcnZhbElkID0gbnVsbDtcblxuICB2YXIgX2lzTG9hZGluZyA9IHRydWU7XG5cbiAgZnVuY3Rpb24gX2dldEZpbGUoKSB7XG4gICAgcmlzZUNhY2hlLmdldEZpbGUoZGF0YS51cmwsIGZ1bmN0aW9uIChyZXNwb25zZSwgZXJyb3IpIHtcbiAgICAgIGlmICghZXJyb3IpIHtcblxuICAgICAgICBpZiAoX2lzTG9hZGluZykge1xuICAgICAgICAgIF9pc0xvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8ub25GaWxlSW5pdChyZXNwb25zZS51cmwpO1xuXG4gICAgICAgICAgLy8gc3RhcnQgdGhlIHJlZnJlc2ggaW50ZXJ2YWxcbiAgICAgICAgICBfc3RhcnRSZWZyZXNoSW50ZXJ2YWwoKTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8ub25GaWxlUmVmcmVzaChyZXNwb25zZS51cmwpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGVycm9yIG9jY3VycmVkXG4gICAgICAgIFJpc2VWaXNpb24uVmlkZW8ubG9nRXZlbnQoe1xuICAgICAgICAgIFwiZXZlbnRcIjogXCJub24tc3RvcmFnZSBlcnJvclwiLFxuICAgICAgICAgIFwiZXZlbnRfZGV0YWlsc1wiOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIFwidXJsXCI6IHJlc3BvbnNlLnVybFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdGFydFJlZnJlc2hJbnRlcnZhbCgpIHtcbiAgICBpZiAoX3JlZnJlc2hJbnRlcnZhbElkID09PSBudWxsKSB7XG4gICAgICBfcmVmcmVzaEludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9nZXRGaWxlKCk7XG4gICAgICB9LCBfcmVmcmVzaER1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgX2dldEZpbGUoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXRcbiAgfTtcbn07XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvID0gUmlzZVZpc2lvbi5Db21tb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvLkZyYW1lQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIFBSRUZJWCA9IFwiaWZfXCI7XG5cbiAgZnVuY3Rpb24gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RnJhbWVPYmplY3QoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuXG4gICAgaWYgKGlmcmFtZSkge1xuICAgICAgcmV0dXJuIChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XG4gICAgICAgIChpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50KSA/IGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQgOiBpZnJhbWUuY29udGVudERvY3VtZW50O1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gX2NsZWFyKGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG4gICAgICBmcmFtZU9iai5yZW1vdmUoKTtcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJhYm91dDpibGFua1wiKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBhZGQoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuXG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImFsbG93VHJhbnNwYXJlbmN5XCIsIHRydWUpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJmcmFtZWJvcmRlclwiLCBcIjBcIik7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNjcm9sbGluZ1wiLCBcIm5vXCIpO1xuXG4gICAgZnJhbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUZyYW1lUGxheWVyKGluZGV4LCBwYXJhbXMsIGZpbGVzLCBza2luLCBzcmMpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBmcmFtZU9iaiA9IGdldEZyYW1lT2JqZWN0KGluZGV4KSxcbiAgICAgIGlmcmFtZTtcblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcblxuICAgICAgaWZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9IG51bGw7XG5cbiAgICAgICAgLy8gaW5pdGlhbGl6ZSBhbmQgbG9hZCB0aGUgcGxheWVyIGluc2lkZSB0aGUgaWZyYW1lXG4gICAgICAgIGZyYW1lT2JqLmluaXQocGFyYW1zLCBmaWxlcywgc2tpbik7XG4gICAgICAgIGZyYW1lT2JqLmxvYWQoKTtcbiAgICAgIH07XG5cbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgc3JjKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGUoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCk7XG5cbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZShpbmRleCwgY2FsbGJhY2spIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XG5cbiAgICBfY2xlYXIoaW5kZXgpO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyByZW1vdmUgdGhlIGlmcmFtZSBieSBjbGVhcmluZyBhbGwgZWxlbWVudHMgaW5zaWRlIGRpdiBjb250YWluZXJcbiAgICAgIHdoaWxlIChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgIGZyYW1lQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9LCAyMDApO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvdyhpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcblxuICAgIGZyYW1lQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWRkOiBhZGQsXG4gICAgY3JlYXRlRnJhbWVQbGF5ZXI6IGNyZWF0ZUZyYW1lUGxheWVyLFxuICAgIGdldEZyYW1lQ29udGFpbmVyOiBnZXRGcmFtZUNvbnRhaW5lcixcbiAgICBnZXRGcmFtZU9iamVjdDogZ2V0RnJhbWVPYmplY3QsXG4gICAgaGlkZTogaGlkZSxcbiAgICByZW1vdmU6IHJlbW92ZSxcbiAgICBzaG93OiBzaG93XG4gIH07XG59O1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5NZXNzYWdlID0gZnVuY3Rpb24gKG1haW5Db250YWluZXIsIG1lc3NhZ2VDb250YWluZXIpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hY3RpdmUgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBfaW5pdCgpIHtcbiAgICB0cnkge1xuICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBtYWluQ29udGFpbmVyLnN0eWxlLmhlaWdodDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJDYW4ndCBpbml0aWFsaXplIE1lc3NhZ2UgLSBcIiwgZS5tZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgaWYgKF9hY3RpdmUpIHtcbiAgICAgIC8vIGNsZWFyIGNvbnRlbnQgb2YgbWVzc2FnZSBjb250YWluZXJcbiAgICAgIHdoaWxlIChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5yZW1vdmVDaGlsZChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgfVxuXG4gICAgICAvLyBoaWRlIG1lc3NhZ2UgY29udGFpbmVyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgLy8gc2hvdyBtYWluIGNvbnRhaW5lclxuICAgICAgbWFpbkNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG5cbiAgICAgIF9hY3RpdmUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzaG93KG1lc3NhZ2UpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG4gICAgICBwO1xuXG4gICAgaWYgKCFfYWN0aXZlKSB7XG4gICAgICAvLyBoaWRlIG1haW4gY29udGFpbmVyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cbiAgICAgIC8vIGNyZWF0ZSBtZXNzYWdlIGVsZW1lbnRcbiAgICAgIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICAgIHAuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJtZXNzYWdlXCIpO1xuICAgICAgcC5zdHlsZS5saW5lSGVpZ2h0ID0gbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XG5cbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHApO1xuICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG5cbiAgICAgIF9hY3RpdmUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBtZXNzYWdlIGFscmVhZHkgYmVpbmcgc2hvd24sIHVwZGF0ZSBtZXNzYWdlIHRleHRcbiAgICAgIHAgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICB9XG4gIH1cblxuICBfaW5pdCgpO1xuXG4gIHJldHVybiB7XG4gICAgXCJoaWRlXCI6IGhpZGUsXG4gICAgXCJzaG93XCI6IHNob3dcbiAgfTtcbn07XG5cbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8uc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbiAgICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIFJpc2VWaXNpb24uVmlkZW8uc2V0QWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTInXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
