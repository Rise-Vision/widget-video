var WIDGET_COMMON_CONFIG={AUTH_PATH_URL:"v1/widget/auth",LOGGER_CLIENT_ID:"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com",LOGGER_CLIENT_SECRET:"nlZyrcPLg6oEwO9f9Wfn29Wh",LOGGER_REFRESH_TOKEN:"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT",STORAGE_ENV:"prod",STORE_URL:"https://store-dot-rvaserver2.appspot.com/"},RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(e){"use strict";function n(e,n){Array.isArray(e)&&e.length>0&&Array.isArray(n)&&n.length>0&&("companyId"===e[0]&&(l=n[0]),"displayId"===e[1]&&(a=n[1]?n[1]:"preview"),u(l,a))}function t(t){t&&"function"==typeof t&&(u=t,l&&a?u(l,a):r&&""!==r&&(e.rpc.register("rsparam_set_"+r,n),e.rpc.call("","rsparam_get",null,r,["companyId","displayId"])))}function i(e){var n,t=/[?#&]/;return e&&"string"==typeof e?(n=e.substr(e.lastIndexOf(".")+1),t.test(n)&&(n=n.substr(0,-1!==n.indexOf("?")?n.indexOf("?"):n.length),n=n.substr(0,-1!==n.indexOf("#")?n.indexOf("#"):n.length),n=n.substr(0,-1!==n.indexOf("&")?n.indexOf("&"):n.length)),n.toLowerCase()):null}function o(e){var n=JSON.parse(JSON.stringify(c));return n.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),n.rows[0].json=JSON.parse(JSON.stringify(e)),n.rows[0].json.ts=(new Date).toISOString(),n}function s(e){var n=new Date,t=n.getUTCFullYear(),i=n.getUTCMonth()+1,o=n.getUTCDate();return 10>i&&(i="0"+i),10>o&&(o="0"+o),e+t+i+o}var r=(new e.Prefs).getString("id"),a="",l="",u=null,c={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,rows:[{insertId:""}]};return{getIds:t,getInsertData:o,getFileFormat:i,getTable:s}}(gadgets),RiseVision.Common.Logger=function(e){"use strict";function n(e){var n=new XMLHttpRequest;return new Date-u<358e4?e({}):(n.open("POST",o,!0),n.onloadend=function(){var t=JSON.parse(n.response);e({token:t.access_token,refreshedAt:new Date})},n.send(),void 0)}function t(e){return r&&l===e}function i(i,o){function d(n){var t,r,a=new XMLHttpRequest;r=s.replace("TABLE_ID",e.getTable(i)),u=n.refreshedAt||u,c=n.token||c,t=e.getInsertData(o),a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer "+c),o.cb&&"function"==typeof o.cb&&(a.onloadend=function(){o.cb(a.response)}),a.send(JSON.stringify(t))}if(i&&o&&o.event&&!t(o.event))return r=!0,l=o.event,setTimeout(function(){r=!1},a),n(d)}var o="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",s="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",r=!1,a=1e3,l="",u=0,c="";return{log:i}}(RiseVision.Common.LoggerUtils);var RiseVision=RiseVision||{};if(RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseCache=function(){"use strict";function e(e){var n=new XMLHttpRequest;e&&"function"==typeof e&&(n.open("GET",t+"ping?callback=_",!0),n.onreadystatechange=function(){try{4===n.readyState&&(i=!0,200===n.status?(o=!0,e(!0,n.responseText)):(console.debug("Rise Cache is not running"),o=!1,e(!1,null)))}catch(t){console.debug("Caught exception: ",t.description)}},n.send())}function n(e,n,s){function r(i){var o,r,a,l,u=new XMLHttpRequest;i?(o=s?t+"?url="+encodeURIComponent(e):t+"cb="+(new Date).getTime()+"?url="+encodeURIComponent(e),l={xhr:u,url:o},u.open("GET",o,!0),u.addEventListener("loadend",function(){var e=u.status||0;0===e||e>=200&&300>e?n(l):n(l,new Error("The request failed with status code: "+e))}),u.send()):(s?o=e:(r=e.split("?"),a=1===r.length?"?":"&",o=e+a+"cb="+(new Date).getTime()),l={xhr:null,url:o},n(l))}if(e&&n&&"function"==typeof n)return i?r(o):this.ping(r)}var t="http://localhost:9494/",i=!1,o=!1;return{getFile:n,ping:e}}(),"undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function n(){e.rpc.call("","rsevent_done",null,y.getString("id")),null!==b&&a(b,!0),a({event:"done"},!1)}function t(){e.rpc.call("","rsevent_ready",null,y.getString("id"),!0,!0,!0,!0,!0)}function i(){clearTimeout(T),T=null}function o(){i(),T=setTimeout(function(){n()},5e3)}function s(e,n){var t={},i=RiseVision.Common.LoggerUtils,o=null;e.event&&(t.event=e.event),e.event_details&&(t.event_details=e.event_details),e.url?o=e.url:O&&(o=O),t.file_url=o,t.file_format=i.getFileFormat(o),i.getIds(function(e,i){t.company_id=e,t.display_id=i,n(t)})}function r(e){S=!0,_.show(e),C.remove(I,function(){w||o()})}function a(e,n){n&&(b=e),s(e,function(e){A.log("video_events",e)})}function l(e){O=e,_.hide(),w||d()}function u(e){O=e,E=!1,b=null}function c(){var e=C.getFrameObject(I);return w=!0,S?(i(),void 0):(e&&e.pause(),void 0)}function d(){var e=C.getFrameObject(I);return w=!1,a({event:"play"},!1),S?(o(),void 0):(E||(e?e.play():O&&""!==O&&(C.add(0),C.createFramePlayer(0,R,O,config.SKIN,"player.html"))),void 0)}function g(){C.remove(I,function(){n()})}function m(){var e;_.hide(),w||(e=C.getFrameObject(I),e&&e.play())}function f(n,i){var o;Array.isArray(n)&&n.length>0&&"additionalParams"===n[0]&&Array.isArray(i)&&i.length>0&&(R=JSON.parse(i[0]),y=new e.Prefs,document.getElementById("videoContainer").style.height=y.getInt("rsH")+"px",R.width=y.getInt("rsW"),R.height=y.getInt("rsH"),_=new RiseVision.Common.Message(document.getElementById("videoContainer"),document.getElementById("messageContainer")),_.show("Please wait while your video is downloaded."),C=new RiseVision.Common.Video.FrameController,o=0!==Object.keys(R.storage).length,o?(h=new RiseVision.Video.Storage(R),h.init()):(V=new RiseVision.Video.NonStorage(R),V.init()),t())}function p(e){var n=null,t={};E=!0,e&&(e.type&&e.message?n=e.type+" - "+e.message:e.type?n=e.type:e.message&&(n=e.message)),t.event="player error",t.event_details=n,a(t,!0),r("Sorry, there was a problem playing the video.")}function v(){c()}var R,y=null,h=null,V=null,_=null,C=null,E=!1,w=!0,I=0,O="",b=null,T=null,S=!1,A=RiseVision.Common.Logger;return{logEvent:a,onFileInit:l,onFileRefresh:u,pause:c,play:d,setAdditionalParams:f,showError:r,playerEnded:g,playerReady:m,playerError:p,stop:v}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function n(){var n=document.getElementById("videoStorage");n&&(n.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(t?(t=!1,RiseVision.Video.onFileInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onFileRefresh(e.detail.url))}),n.addEventListener("rise-storage-no-file",function(){var e={event:"storage file not found"};RiseVision.Video.logEvent(e,!0),RiseVision.Video.showError("The selected video does not exist.")}),n.addEventListener("rise-storage-error",function(){var e={event:"storage error"};RiseVision.Video.logEvent(e,!0),RiseVision.Video.showError("Sorry, there was a problem playing the video from Storage.")}),n.setAttribute("folder",e.storage.folder),n.setAttribute("fileName",e.storage.fileName),n.setAttribute("companyId",e.storage.companyId),n.setAttribute("env",config.STORAGE_ENV),n.go())}var t=!0;return{init:n}};var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.NonStorage=function(e){"use strict";function n(){o.getFile(e.url,function(e,n){n?RiseVision.Video.logEvent({event:"non-storage error",event_details:n.message,url:e.url}):a?(a=!1,RiseVision.Video.onFileInit(e.url),t()):RiseVision.Video.onFileRefresh(e.url)})}function t(){null===r&&(r=setInterval(function(){n()},s))}function i(){n()}var o=RiseVision.Common.RiseCache,s=9e5,r=null,a=!0;return{init:i}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function n(n){var t,i=e(n);return t=i.querySelector("iframe"),t?t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument:null}function t(t){var i,o=e(t),s=n(t);s&&(i=o.querySelector("iframe"),s.remove(),i.setAttribute("src","about:blank"))}function i(n){var t=e(n),i=document.createElement("iframe");i.setAttribute("allowTransparency",!0),i.setAttribute("frameborder","0"),i.setAttribute("scrolling","no"),t.appendChild(i)}function o(t,i,o,s,r){var a,l=e(t),u=n(t);u&&(a=l.querySelector("iframe"),a.onload=function(){a.onload=null,u.init(i,o,s),u.load()},a.setAttribute("src",r))}function s(n){var t=e(n);t.style.visibility="hidden"}function r(e,n){var i=document.getElementById(l+e);t(e),setTimeout(function(){for(;i.firstChild;)i.removeChild(i.firstChild);n&&"function"==typeof n&&n()},200)}function a(n){var t=e(n);t.style.visibility="visible"}var l="if_";return{add:i,createFramePlayer:o,getFrameContainer:e,getFrameObject:n,hide:s,remove:r,show:a}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,n){"use strict";function t(){try{n.style.height=e.style.height}catch(t){console.warn("Can't initialize Message - ",t.message)}}function i(){if(s){for(;n.firstChild;)n.removeChild(n.firstChild);n.style.display="none",e.style.visibility="visible",s=!1}}function o(t){var i,o=document.createDocumentFragment();s?(i=n.querySelector(".message"),i.innerHTML=t):(e.style.visibility="hidden",n.style.display="block",i=document.createElement("p"),i.innerHTML=t,i.setAttribute("class","message"),i.style.lineHeight=n.style.height,o.appendChild(i),n.appendChild(o),s=!0)}var s=!1;return t(),{hide:i,show:o}},function(e,n){"use strict";function t(){RiseVision.Video.play()}function i(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function s(){e.removeEventListener("WebComponentsReady",s),a&&""!==a&&(n.rpc.register("rscmd_play_"+a,t),n.rpc.register("rscmd_pause_"+a,i),n.rpc.register("rscmd_stop_"+a,o),n.rpc.register("rsparam_set_"+a,RiseVision.Video.setAdditionalParams),n.rpc.call("","rsparam_get",null,a,["additionalParams"]))}var r=new n.Prefs,a=r.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",s)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiV0lER0VUX0NPTU1PTl9DT05GSUciLCJBVVRIX1BBVEhfVVJMIiwiTE9HR0VSX0NMSUVOVF9JRCIsIkxPR0dFUl9DTElFTlRfU0VDUkVUIiwiTE9HR0VSX1JFRlJFU0hfVE9LRU4iLCJTVE9SQUdFX0VOViIsIlNUT1JFX1VSTCIsIlJpc2VWaXNpb24iLCJDb21tb24iLCJMb2dnZXJVdGlscyIsImdhZGdldHMiLCJzZXRJZHMiLCJuYW1lcyIsInZhbHVlcyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImNvbXBhbnlJZCIsImRpc3BsYXlJZCIsImNhbGxiYWNrIiwiZ2V0SWRzIiwiY2IiLCJpZCIsInJwYyIsInJlZ2lzdGVyIiwiY2FsbCIsImdldEZpbGVGb3JtYXQiLCJ1cmwiLCJzdHIiLCJoYXNQYXJhbXMiLCJzdWJzdHIiLCJsYXN0SW5kZXhPZiIsInRlc3QiLCJpbmRleE9mIiwidG9Mb3dlckNhc2UiLCJnZXRJbnNlcnREYXRhIiwicGFyYW1zIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsIkJBU0VfSU5TRVJUX1NDSEVNQSIsInJvd3MiLCJpbnNlcnRJZCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIiwianNvbiIsInRzIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZ2V0VGFibGUiLCJuYW1lIiwiZGF0ZSIsInllYXIiLCJnZXRVVENGdWxsWWVhciIsIm1vbnRoIiwiZ2V0VVRDTW9udGgiLCJkYXkiLCJnZXRVVENEYXRlIiwiUHJlZnMiLCJnZXRTdHJpbmciLCJraW5kIiwic2tpcEludmFsaWRSb3dzIiwiaWdub3JlVW5rbm93blZhbHVlcyIsIkxvZ2dlciIsInV0aWxzIiwicmVmcmVzaFRva2VuIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJyZWZyZXNoRGF0ZSIsIm9wZW4iLCJSRUZSRVNIX1VSTCIsIm9ubG9hZGVuZCIsInJlc3AiLCJyZXNwb25zZSIsInRva2VuIiwiYWNjZXNzX3Rva2VuIiwicmVmcmVzaGVkQXQiLCJzZW5kIiwiaXNUaHJvdHRsZWQiLCJldmVudCIsInRocm90dGxlIiwibGFzdEV2ZW50IiwibG9nIiwidGFibGVOYW1lIiwiaW5zZXJ0V2l0aFRva2VuIiwicmVmcmVzaERhdGEiLCJpbnNlcnREYXRhIiwic2VydmljZVVybCIsInJlcGxhY2UiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2V0VGltZW91dCIsInRocm90dGxlRGVsYXkiLCJSaXNlQ2FjaGUiLCJwaW5nIiwiciIsIkJBU0VfQ0FDSEVfVVJMIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsIl9waW5nUmVjZWl2ZWQiLCJzdGF0dXMiLCJfaXNDYWNoZVJ1bm5pbmciLCJyZXNwb25zZVRleHQiLCJjb25zb2xlIiwiZGVidWciLCJlIiwiZGVzY3JpcHRpb24iLCJnZXRGaWxlIiwiZmlsZVVybCIsIm5vY2FjaGVidXN0ZXIiLCJmaWxlUmVxdWVzdCIsImlzQ2FjaGVSdW5uaW5nIiwic2VwYXJhdG9yIiwicmVxdWVzdCIsImVuY29kZVVSSUNvbXBvbmVudCIsImdldFRpbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiRXJyb3IiLCJzcGxpdCIsInRoaXMiLCJjb25maWciLCJTS0lOIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiVmlkZW8iLCJfZG9uZSIsIl9wcmVmcyIsIl9lcnJvciIsImxvZ0V2ZW50IiwiX3JlYWR5IiwiX2NsZWFyRXJyb3JUaW1lciIsImNsZWFyVGltZW91dCIsIl9lcnJvclRpbWVyIiwiX3N0YXJ0RXJyb3JUaW1lciIsIl9nZXRMb2dnZXJQYXJhbXMiLCJldmVudF9kZXRhaWxzIiwiX2N1cnJlbnRGaWxlIiwiZmlsZV91cmwiLCJmaWxlX2Zvcm1hdCIsImNvbXBhbnlfaWQiLCJkaXNwbGF5X2lkIiwic2hvd0Vycm9yIiwibWVzc2FnZSIsIl9lcnJvckZsYWciLCJfbWVzc2FnZSIsInNob3ciLCJfZnJhbWVDb250cm9sbGVyIiwicmVtb3ZlIiwiX2N1cnJlbnRGcmFtZSIsIl92aWV3ZXJQYXVzZWQiLCJpc0Vycm9yIiwiX2xvZ2dlciIsIm9uRmlsZUluaXQiLCJoaWRlIiwicGxheSIsIm9uRmlsZVJlZnJlc2giLCJfcGxheWJhY2tFcnJvciIsInBhdXNlIiwiZnJhbWVPYmoiLCJnZXRGcmFtZU9iamVjdCIsImFkZCIsImNyZWF0ZUZyYW1lUGxheWVyIiwiX2FkZGl0aW9uYWxQYXJhbXMiLCJwbGF5ZXJFbmRlZCIsInBsYXllclJlYWR5Iiwic2V0QWRkaXRpb25hbFBhcmFtcyIsImlzU3RvcmFnZUZpbGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJoZWlnaHQiLCJnZXRJbnQiLCJ3aWR0aCIsIk1lc3NhZ2UiLCJGcmFtZUNvbnRyb2xsZXIiLCJPYmplY3QiLCJrZXlzIiwic3RvcmFnZSIsIl9zdG9yYWdlIiwiU3RvcmFnZSIsImluaXQiLCJfbm9uU3RvcmFnZSIsIk5vblN0b3JhZ2UiLCJwbGF5ZXJFcnJvciIsImVycm9yIiwiZGV0YWlscyIsInR5cGUiLCJzdG9wIiwiZGV0YWlsIiwiX2luaXRpYWxMb2FkIiwiaGFzT3duUHJvcGVydHkiLCJjaGFuZ2VkIiwic2V0QXR0cmlidXRlIiwiZm9sZGVyIiwiZmlsZU5hbWUiLCJnbyIsIl9nZXRGaWxlIiwicmlzZUNhY2hlIiwiX2lzTG9hZGluZyIsIl9zdGFydFJlZnJlc2hJbnRlcnZhbCIsIl9yZWZyZXNoSW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiX3JlZnJlc2hEdXJhdGlvbiIsImdldEZyYW1lQ29udGFpbmVyIiwiaW5kZXgiLCJQUkVGSVgiLCJpZnJhbWUiLCJmcmFtZUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50V2luZG93IiwiY29udGVudERvY3VtZW50IiwiX2NsZWFyIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiZmlsZXMiLCJza2luIiwic3JjIiwib25sb2FkIiwibG9hZCIsInZpc2liaWxpdHkiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJtYWluQ29udGFpbmVyIiwibWVzc2FnZUNvbnRhaW5lciIsIl9pbml0Iiwid2FybiIsIl9hY3RpdmUiLCJkaXNwbGF5IiwicCIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImlubmVySFRNTCIsImxpbmVIZWlnaHQiLCJ3aW5kb3ciLCJwb2x5bWVyUmVhZHkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicHJlZnMiLCJvbmNvbnRleHRtZW51IiwiX2dhcSIsInB1c2giLCJnYSIsImFzeW5jIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLHVCQUNGQyxjQUFlLGlCQUNmQyxpQkFBa0IsNEVBQ2xCQyxxQkFBc0IsMkJBQ3RCQyxxQkFBc0IscUVBQ3RCQyxZQUFhLE9BQ2JDLFVBQVcsNkNBSVRDLFdBQWFBLGNBQ2pCQSxZQUFXQyxPQUFTRCxXQUFXQyxXQUUvQkQsV0FBV0MsT0FBT0MsWUFBYyxTQUFVQyxHQUN4QyxZQXNCQSxTQUFTQyxHQUFPQyxFQUFPQyxHQUNqQkMsTUFBTUMsUUFBUUgsSUFBVUEsRUFBTUksT0FBUyxHQUNyQ0YsTUFBTUMsUUFBUUYsSUFBV0EsRUFBT0csT0FBUyxJQUMxQixjQUFiSixFQUFNLEtBQ1JLLEVBQVlKLEVBQU8sSUFHSixjQUFiRCxFQUFNLEtBRU5NLEVBREVMLEVBQU8sR0FDR0EsRUFBTyxHQUdQLFdBSWhCTSxFQUFTRixFQUFXQyxJQVExQixRQUFTRSxHQUFPQyxHQUNUQSxHQUFvQixrQkFBUEEsS0FJaEJGLEVBQVdFLEVBR1RKLEdBQWFDLEVBQ2ZDLEVBQVNGLEVBQVdDLEdBR2hCSSxHQUFhLEtBQVBBLElBQ1JaLEVBQVFhLElBQUlDLFNBQVMsZUFBaUJGLEVBQUlYLEdBQzFDRCxFQUFRYSxJQUFJRSxLQUFLLEdBQUksY0FBZSxLQUFNSCxHQUFLLFlBQWEsZ0JBS2xFLFFBQVNJLEdB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T0EsUUFFWEEsTUFBS0MsTUFBTSxjQUFlLGtCQUMxQkQsS0FBS0MsTUFBTSxtQkFFWCxXQUNFLEdBQUlDLEdBQUt6RSxTQUFTNkMsY0FBYyxTQUFXNEIsR0FBR3RELEtBQU8sa0JBQW1Cc0QsRUFBR0MsT0FBUSxFQUNuRkQsRUFBR3hCLEtBQU8sVUFBWWpELFNBQVMyRSxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJN0UsU0FBUzhFLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFQLEVBQUlJIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgV0lER0VUX0NPTU1PTl9DT05GSUcgPSB7XG4gIEFVVEhfUEFUSF9VUkw6IFwidjEvd2lkZ2V0L2F1dGhcIixcbiAgTE9HR0VSX0NMSUVOVF9JRDogXCIxMDg4NTI3MTQ3MTA5LTZxMW8ydnRpaG4zNDI5MnBqdDRja2htaGNrMHJrMG83LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tXCIsXG4gIExPR0dFUl9DTElFTlRfU0VDUkVUOiBcIm5sWnlyY1BMZzZvRXdPOWY5V2ZuMjlXaFwiLFxuICBMT0dHRVJfUkVGUkVTSF9UT0tFTjogXCIxL3h6dDRrd3pFMUg3VzlWbktCOGNBYUN4NnpiNEVzNG5LRW9xYVlIZFREMTVJZ09ySkR0ZHVuNnpLNlhpQVRDS1RcIixcbiAgU1RPUkFHRV9FTlY6IFwicHJvZFwiLFxuICBTVE9SRV9VUkw6IFwiaHR0cHM6Ly9zdG9yZS1kb3QtcnZhc2VydmVyMi5hcHBzcG90LmNvbS9cIlxufTtcbi8qIGdsb2JhbCBnYWRnZXRzICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLkxvZ2dlclV0aWxzID0gKGZ1bmN0aW9uKGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgIHZhciBpZCA9IG5ldyBnYWRnZXRzLlByZWZzKCkuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgZGlzcGxheUlkID0gXCJcIixcbiAgICBjb21wYW55SWQgPSBcIlwiLFxuICAgIGNhbGxiYWNrID0gbnVsbDtcblxuICB2YXIgQkFTRV9JTlNFUlRfU0NIRU1BID1cbiAge1xuICAgIFwia2luZFwiOiBcImJpZ3F1ZXJ5I3RhYmxlRGF0YUluc2VydEFsbFJlcXVlc3RcIixcbiAgICBcInNraXBJbnZhbGlkUm93c1wiOiBmYWxzZSxcbiAgICBcImlnbm9yZVVua25vd25WYWx1ZXNcIjogZmFsc2UsXG4gICAgXCJyb3dzXCI6IFt7XG4gICAgICBcImluc2VydElkXCI6IFwiXCJcbiAgICB9XVxuICB9O1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG5cbiAgLyogU2V0IHRoZSBDb21wYW55IGFuZCBEaXNwbGF5IElEcy4gKi9cbiAgZnVuY3Rpb24gc2V0SWRzKG5hbWVzLCB2YWx1ZXMpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzKSAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBpZiAobmFtZXNbMF0gPT09IFwiY29tcGFueUlkXCIpIHtcbiAgICAgICAgICBjb21wYW55SWQgPSB2YWx1ZXNbMF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmFtZXNbMV0gPT09IFwiZGlzcGxheUlkXCIpIHtcbiAgICAgICAgICBpZiAodmFsdWVzWzFdKSB7XG4gICAgICAgICAgICBkaXNwbGF5SWQgPSB2YWx1ZXNbMV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheUlkID0gXCJwcmV2aWV3XCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY2FsbGJhY2soY29tcGFueUlkLCBkaXNwbGF5SWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gZ2V0SWRzKGNiKSB7XG4gICAgaWYgKCFjYiB8fCB0eXBlb2YgY2IgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNhbGxiYWNrID0gY2I7XG4gICAgfVxuXG4gICAgaWYgKGNvbXBhbnlJZCAmJiBkaXNwbGF5SWQpIHtcbiAgICAgIGNhbGxiYWNrKGNvbXBhbnlJZCwgZGlzcGxheUlkKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBzZXRJZHMpO1xuICAgICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImNvbXBhbnlJZFwiLCBcImRpc3BsYXlJZFwiXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RmlsZUZvcm1hdCh1cmwpIHtcbiAgICB2YXIgaGFzUGFyYW1zID0gL1s/IyZdLyxcbiAgICAgIHN0cjtcblxuICAgIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHN0ciA9IHVybC5zdWJzdHIodXJsLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpO1xuXG4gICAgLy8gZG9uJ3QgaW5jbHVkZSBhbnkgcGFyYW1zIGFmdGVyIHRoZSBmaWxlbmFtZVxuICAgIGlmIChoYXNQYXJhbXMudGVzdChzdHIpKSB7XG4gICAgICBzdHIgPSBzdHIuc3Vic3RyKDAgLChzdHIuaW5kZXhPZihcIj9cIikgIT09IC0xKSA/IHN0ci5pbmRleE9mKFwiP1wiKSA6IHN0ci5sZW5ndGgpO1xuXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyKDAsIChzdHIuaW5kZXhPZihcIiNcIikgIT09IC0xKSA/IHN0ci5pbmRleE9mKFwiI1wiKSA6IHN0ci5sZW5ndGgpO1xuXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyKDAsIChzdHIuaW5kZXhPZihcIiZcIikgIT09IC0xKSA/IHN0ci5pbmRleE9mKFwiJlwiKSA6IHN0ci5sZW5ndGgpO1xuICAgIH1cblxuICAgIHJldHVybiBzdHIudG9Mb3dlckNhc2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEluc2VydERhdGEocGFyYW1zKSB7XG4gICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KEJBU0VfSU5TRVJUX1NDSEVNQSkpO1xuXG4gICAgZGF0YS5yb3dzWzBdLmluc2VydElkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIpLnRvVXBwZXJDYXNlKCk7XG4gICAgZGF0YS5yb3dzWzBdLmpzb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHBhcmFtcykpO1xuICAgIGRhdGEucm93c1swXS5qc29uLnRzID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRUYWJsZShuYW1lKSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpLFxuICAgICAgeWVhciA9IGRhdGUuZ2V0VVRDRnVsbFllYXIoKSxcbiAgICAgIG1vbnRoID0gZGF0ZS5nZXRVVENNb250aCgpICsgMSxcbiAgICAgIGRheSA9IGRhdGUuZ2V0VVRDRGF0ZSgpO1xuXG4gICAgaWYgKG1vbnRoIDwgMTApIHtcbiAgICAgIG1vbnRoID0gXCIwXCIgKyBtb250aDtcbiAgICB9XG5cbiAgICBpZiAoZGF5IDwgMTApIHtcbiAgICAgIGRheSA9IFwiMFwiICsgZGF5O1xuICAgIH1cblxuICAgIHJldHVybiBuYW1lICsgeWVhciArIG1vbnRoICsgZGF5O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImdldElkc1wiOiBnZXRJZHMsXG4gICAgXCJnZXRJbnNlcnREYXRhXCI6IGdldEluc2VydERhdGEsXG4gICAgXCJnZXRGaWxlRm9ybWF0XCI6IGdldEZpbGVGb3JtYXQsXG4gICAgXCJnZXRUYWJsZVwiOiBnZXRUYWJsZVxuICB9O1xufSkoZ2FkZ2V0cyk7XG5cblJpc2VWaXNpb24uQ29tbW9uLkxvZ2dlciA9IChmdW5jdGlvbih1dGlscykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgUkVGUkVTSF9VUkwgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92My90b2tlbj9jbGllbnRfaWQ9XCIgKyBXSURHRVRfQ09NTU9OX0NPTkZJRy5MT0dHRVJfQ0xJRU5UX0lEICtcbiAgICAgIFwiJmNsaWVudF9zZWNyZXQ9XCIgKyBXSURHRVRfQ09NTU9OX0NPTkZJRy5MT0dHRVJfQ0xJRU5UX1NFQ1JFVCArXG4gICAgICBcIiZyZWZyZXNoX3Rva2VuPVwiICsgV0lER0VUX0NPTU1PTl9DT05GSUcuTE9HR0VSX1JFRlJFU0hfVE9LRU4gK1xuICAgICAgXCImZ3JhbnRfdHlwZT1yZWZyZXNoX3Rva2VuXCI7XG5cbiAgdmFyIHNlcnZpY2VVcmwgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2JpZ3F1ZXJ5L3YyL3Byb2plY3RzL2NsaWVudC1zaWRlLWV2ZW50cy9kYXRhc2V0cy9XaWRnZXRfRXZlbnRzL3RhYmxlcy9UQUJMRV9JRC9pbnNlcnRBbGxcIixcbiAgICB0aHJvdHRsZSA9IGZhbHNlLFxuICAgIHRocm90dGxlRGVsYXkgPSAxMDAwLFxuICAgIGxhc3RFdmVudCA9IFwiXCIsXG4gICAgcmVmcmVzaERhdGUgPSAwLFxuICAgIHRva2VuID0gXCJcIjtcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiByZWZyZXNoVG9rZW4oY2IpIHtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICBpZiAobmV3IERhdGUoKSAtIHJlZnJlc2hEYXRlIDwgMzU4MDAwMCkge1xuICAgICAgcmV0dXJuIGNiKHt9KTtcbiAgICB9XG5cbiAgICB4aHIub3BlbihcIlBPU1RcIiwgUkVGUkVTSF9VUkwsIHRydWUpO1xuICAgIHhoci5vbmxvYWRlbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZXNwID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2UpO1xuXG4gICAgICBjYih7IHRva2VuOiByZXNwLmFjY2Vzc190b2tlbiwgcmVmcmVzaGVkQXQ6IG5ldyBEYXRlKCkgfSk7XG4gICAgfTtcblxuICAgIHhoci5zZW5kKCk7XG4gIH1cblxuICBmdW5jdGlvbiBpc1Rocm90dGxlZChldmVudCkge1xuICAgIHJldHVybiB0aHJvdHRsZSAmJiAobGFzdEV2ZW50ID09PSBldmVudCk7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGxvZyh0YWJsZU5hbWUsIHBhcmFtcykge1xuICAgIGlmICghdGFibGVOYW1lIHx8ICFwYXJhbXMgfHwgIXBhcmFtcy5ldmVudCB8fCBpc1Rocm90dGxlZChwYXJhbXMuZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhyb3R0bGUgPSB0cnVlO1xuICAgIGxhc3RFdmVudCA9IHBhcmFtcy5ldmVudDtcblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdGhyb3R0bGUgPSBmYWxzZTtcbiAgICB9LCB0aHJvdHRsZURlbGF5KTtcblxuICAgIGZ1bmN0aW9uIGluc2VydFdpdGhUb2tlbihyZWZyZXNoRGF0YSkge1xuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICBpbnNlcnREYXRhLCB1cmw7XG5cbiAgICAgIHVybCA9IHNlcnZpY2VVcmwucmVwbGFjZShcIlRBQkxFX0lEXCIsIHV0aWxzLmdldFRhYmxlKHRhYmxlTmFtZSkpO1xuICAgICAgcmVmcmVzaERhdGUgPSByZWZyZXNoRGF0YS5yZWZyZXNoZWRBdCB8fCByZWZyZXNoRGF0ZTtcbiAgICAgIHRva2VuID0gcmVmcmVzaERhdGEudG9rZW4gfHwgdG9rZW47XG4gICAgICBpbnNlcnREYXRhID0gdXRpbHMuZ2V0SW5zZXJ0RGF0YShwYXJhbXMpO1xuXG4gICAgICAvLyBJbnNlcnQgdGhlIGRhdGEuXG4gICAgICB4aHIub3BlbihcIlBPU1RcIiwgdXJsLCB0cnVlKTtcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQXV0aG9yaXphdGlvblwiLCBcIkJlYXJlciBcIiArIHRva2VuKTtcblxuICAgICAgaWYgKHBhcmFtcy5jYiAmJiB0eXBlb2YgcGFyYW1zLmNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgeGhyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHBhcmFtcy5jYih4aHIucmVzcG9uc2UpO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICB4aHIuc2VuZChKU09OLnN0cmluZ2lmeShpbnNlcnREYXRhKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlZnJlc2hUb2tlbihpbnNlcnRXaXRoVG9rZW4pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImxvZ1wiOiBsb2dcbiAgfTtcbn0pKFJpc2VWaXNpb24uQ29tbW9uLkxvZ2dlclV0aWxzKTtcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLlJpc2VDYWNoZSA9IChmdW5jdGlvbiAoKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBCQVNFX0NBQ0hFX1VSTCA9IFwiaHR0cDovL2xvY2FsaG9zdDo5NDk0L1wiO1xuXG4gIHZhciBfcGluZ1JlY2VpdmVkID0gZmFsc2UsXG4gICAgX2lzQ2FjaGVSdW5uaW5nID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gcGluZyhjYWxsYmFjaykge1xuICAgIHZhciByID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICBpZiAoIWNhbGxiYWNrIHx8IHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgci5vcGVuKFwiR0VUXCIsIEJBU0VfQ0FDSEVfVVJMICsgXCJwaW5nP2NhbGxiYWNrPV9cIiwgdHJ1ZSk7XG4gICAgci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoci5yZWFkeVN0YXRlID09PSA0ICkge1xuICAgICAgICAgIC8vIHNhdmUgdGhpcyByZXN1bHQgZm9yIHVzZSBpbiBnZXRGaWxlKClcbiAgICAgICAgICBfcGluZ1JlY2VpdmVkID0gdHJ1ZTtcblxuICAgICAgICAgIGlmKHIuc3RhdHVzID09PSAyMDApe1xuICAgICAgICAgICAgX2lzQ2FjaGVSdW5uaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSwgci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwiUmlzZSBDYWNoZSBpcyBub3QgcnVubmluZ1wiKTtcbiAgICAgICAgICAgIF9pc0NhY2hlUnVubmluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICBjYWxsYmFjayhmYWxzZSwgbnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmRlYnVnKFwiQ2F1Z2h0IGV4Y2VwdGlvbjogXCIsIGUuZGVzY3JpcHRpb24pO1xuICAgICAgfVxuXG4gICAgfTtcbiAgICByLnNlbmQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEZpbGUoZmlsZVVybCwgY2FsbGJhY2ssIG5vY2FjaGVidXN0ZXIpIHtcbiAgICBpZiAoIWZpbGVVcmwgfHwgIWNhbGxiYWNrIHx8IHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsZVJlcXVlc3QoaXNDYWNoZVJ1bm5pbmcpIHtcbiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKSxcbiAgICAgICAgdXJsLCBzdHIsIHNlcGFyYXRvciwgcmVxdWVzdDtcblxuICAgICAgaWYgKGlzQ2FjaGVSdW5uaW5nKSB7XG4gICAgICAgIC8vIGNvbmZpZ3VyZSB1cmwgd2l0aCBjYWNoZWJ1c3RlciBvciBub3RcbiAgICAgICAgdXJsID0gKG5vY2FjaGVidXN0ZXIpID8gQkFTRV9DQUNIRV9VUkwgKyBcIj91cmw9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsZVVybCkgOlxuICAgICAgICAgIEJBU0VfQ0FDSEVfVVJMICsgXCJjYj1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgXCI/dXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVVcmwpO1xuXG4gICAgICAgIC8vIGN1c3RvbSByZXF1ZXN0IG9iamVjdCB0byBwcm92aWRlIGluIHJlc3BvbnNlXG4gICAgICAgIHJlcXVlc3QgPSB7XG4gICAgICAgICAgeGhyOiB4aHIsXG4gICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgfTtcblxuICAgICAgICB4aHIub3BlbihcIkdFVFwiLCB1cmwsIHRydWUpO1xuXG4gICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdsb2FkZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBzdGF0dXMgPSB4aHIuc3RhdHVzIHx8IDA7XG5cbiAgICAgICAgICBpZiAoc3RhdHVzID09PSAwIHx8IChzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCkpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlcXVlc3QpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LCBuZXcgRXJyb3IoXCJUaGUgcmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgY29kZTogXCIgKyBzdGF0dXMpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHhoci5zZW5kKCk7XG5cbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgaWYgKG5vY2FjaGVidXN0ZXIpIHtcbiAgICAgICAgICB1cmwgPSBmaWxlVXJsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0ciA9IGZpbGVVcmwuc3BsaXQoXCI/XCIpO1xuICAgICAgICAgIHNlcGFyYXRvciA9IChzdHIubGVuZ3RoID09PSAxKSA/IFwiP1wiIDogXCImXCI7XG5cbiAgICAgICAgICB1cmwgPSBmaWxlVXJsICsgc2VwYXJhdG9yICsgXCJjYj1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY3VzdG9tIHJlcXVlc3Qgb2JqZWN0IHRvIHByb3ZpZGUgaW4gcmVzcG9uc2VcbiAgICAgICAgcmVxdWVzdCA9IHtcbiAgICAgICAgICB4aHI6IG51bGwsXG4gICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgfTtcblxuICAgICAgICBjYWxsYmFjayhyZXF1ZXN0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIV9waW5nUmVjZWl2ZWQpIHtcbiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgIHJldHVybiB0aGlzLnBpbmcoZmlsZVJlcXVlc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmlsZVJlcXVlc3QoX2lzQ2FjaGVSdW5uaW5nKTtcbiAgICB9XG5cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZ2V0RmlsZTogZ2V0RmlsZSxcbiAgICBwaW5nOiBwaW5nXG4gIH07XG5cbn0pKCk7XG5cbi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBTS0lOOiBcInNraW4vUlZTa2luLnhtbFwiLFxuICAgIFNUT1JBR0VfRU5WOiBcInByb2RcIlxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImxvY2FsZXMvdHJhbnNsYXRpb25fXCIpXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1NVRklYXCIsIFwiLmpzb25cIik7XG4gIH1cbn1cblxuLyogZ2xvYmFsIGdhZGdldHMsIGNvbmZpZyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvID0ge307XG5cblJpc2VWaXNpb24uVmlkZW8gPSAoZnVuY3Rpb24gKGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hZGRpdGlvbmFsUGFyYW1zO1xuXG4gIHZhciBfcHJlZnMgPSBudWxsLFxuICAgIF9zdG9yYWdlID0gbnVsbCxcbiAgICBfbm9uU3RvcmFnZSA9IG51bGwsXG4gICAgX21lc3NhZ2UgPSBudWxsLFxuICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBudWxsO1xuXG4gIHZhciBfcGxheWJhY2tFcnJvciA9IGZhbHNlLFxuICAgIF92aWV3ZXJQYXVzZWQgPSB0cnVlO1xuXG4gIHZhciBfY3VycmVudEZyYW1lID0gMDtcblxuICB2YXIgX2N1cnJlbnRGaWxlID0gXCJcIjtcblxuICB2YXIgX2Vycm9yID0gbnVsbCxcbiAgICBfZXJyb3JUaW1lciA9IG51bGwsXG4gICAgX2Vycm9yRmxhZyA9IGZhbHNlO1xuXG4gIHZhciBfbG9nZ2VyID0gUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9kb25lKCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X2RvbmVcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpKTtcblxuICAgIC8vIEFueSBlcnJvcnMgbmVlZCB0byBiZSBsb2dnZWQgYmVmb3JlIHRoZSBkb25lIGV2ZW50LlxuICAgIGlmIChfZXJyb3IgIT09IG51bGwpIHtcbiAgICAgIGxvZ0V2ZW50KF9lcnJvciwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgbG9nRXZlbnQoeyBcImV2ZW50XCI6IFwiZG9uZVwiIH0sIGZhbHNlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jbGVhckVycm9yVGltZXIoKSB7XG4gICAgY2xlYXJUaW1lb3V0KF9lcnJvclRpbWVyKTtcbiAgICBfZXJyb3JUaW1lciA9IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RhcnRFcnJvclRpbWVyKCkge1xuICAgIF9jbGVhckVycm9yVGltZXIoKTtcblxuICAgIF9lcnJvclRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBub3RpZnkgVmlld2VyIHdpZGdldCBpcyBkb25lXG4gICAgICBfZG9uZSgpO1xuICAgIH0sIDUwMDApO1xuICB9XG5cbiAgLy8gR2V0IHRoZSBwYXJhbWV0ZXJzIHRvIHBhc3MgdG8gdGhlIGV2ZW50IGxvZ2dlci5cbiAgZnVuY3Rpb24gX2dldExvZ2dlclBhcmFtcyhwYXJhbXMsIGNiKSB7XG4gICAgdmFyIGpzb24gPSB7fSxcbiAgICAgIHV0aWxzID0gUmlzZVZpc2lvbi5Db21tb24uTG9nZ2VyVXRpbHMsXG4gICAgICB1cmwgPSBudWxsO1xuXG4gICAgaWYgKHBhcmFtcy5ldmVudCkge1xuICAgICAganNvbi5ldmVudCA9IHBhcmFtcy5ldmVudDtcbiAgICB9XG5cbiAgICBpZiAocGFyYW1zLmV2ZW50X2RldGFpbHMpIHtcbiAgICAgIGpzb24uZXZlbnRfZGV0YWlscyA9IHBhcmFtcy5ldmVudF9kZXRhaWxzO1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMudXJsKSB7XG4gICAgICB1cmwgPSBwYXJhbXMudXJsO1xuICAgIH1cbiAgICBlbHNlIGlmIChfY3VycmVudEZpbGUpIHtcbiAgICAgIHVybCA9IF9jdXJyZW50RmlsZTtcbiAgICB9XG5cbiAgICBqc29uLmZpbGVfdXJsID0gdXJsO1xuICAgIGpzb24uZmlsZV9mb3JtYXQgPSB1dGlscy5nZXRGaWxlRm9ybWF0KHVybCk7XG5cbiAgICB1dGlscy5nZXRJZHMoZnVuY3Rpb24oY29tcGFueUlkLCBkaXNwbGF5SWQpIHtcbiAgICAgIGpzb24uY29tcGFueV9pZCA9IGNvbXBhbnlJZDtcbiAgICAgIGpzb24uZGlzcGxheV9pZCA9IGRpc3BsYXlJZDtcblxuICAgICAgY2IoanNvbik7XG4gICAgfSk7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIHNob3dFcnJvcihtZXNzYWdlKSB7XG4gICAgX2Vycm9yRmxhZyA9IHRydWU7XG5cbiAgICBfbWVzc2FnZS5zaG93KG1lc3NhZ2UpO1xuXG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgLy8gaWYgV2lkZ2V0IGlzIHBsYXlpbmcgcmlnaHQgbm93LCBydW4gdGhlIHRpbWVyXG4gICAgICBpZiAoIV92aWV3ZXJQYXVzZWQpIHtcbiAgICAgICAgX3N0YXJ0RXJyb3JUaW1lcigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gbG9nRXZlbnQocGFyYW1zLCBpc0Vycm9yKSB7XG4gICAgaWYgKGlzRXJyb3IpIHtcbiAgICAgIF9lcnJvciA9IHBhcmFtcztcbiAgICB9XG5cbiAgICBfZ2V0TG9nZ2VyUGFyYW1zKHBhcmFtcywgZnVuY3Rpb24oanNvbikge1xuICAgICAgX2xvZ2dlci5sb2coXCJ2aWRlb19ldmVudHNcIiwganNvbik7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBvbkZpbGVJbml0KHVybCkge1xuICAgIF9jdXJyZW50RmlsZSA9IHVybDtcblxuICAgIF9tZXNzYWdlLmhpZGUoKTtcblxuICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgcGxheSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uRmlsZVJlZnJlc2godXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgLy8gaW4gY2FzZSByZWZyZXNoZWQgZmlsZSBmaXhlcyBhbiBlcnJvciB3aXRoIHByZXZpb3VzIGZpbGUsIGVuc3VyZSBmbGFnIGlzIHJlbW92ZWQgc28gcGxheWJhY2sgaXMgYXR0ZW1wdGVkIGFnYWluXG4gICAgX3BsYXliYWNrRXJyb3IgPSBmYWxzZTtcbiAgICBfZXJyb3IgPSBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIF92aWV3ZXJQYXVzZWQgPSB0cnVlO1xuXG4gICAgaWYgKF9lcnJvckZsYWcpIHtcbiAgICAgIF9jbGVhckVycm9yVGltZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGZyYW1lT2JqLnBhdXNlKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgX3ZpZXdlclBhdXNlZCA9IGZhbHNlO1xuXG4gICAgbG9nRXZlbnQoeyBcImV2ZW50XCI6IFwicGxheVwiIH0sIGZhbHNlKTtcblxuICAgIGlmIChfZXJyb3JGbGFnKSB7XG4gICAgICBfc3RhcnRFcnJvclRpbWVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFfcGxheWJhY2tFcnJvcikge1xuICAgICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICAgIGZyYW1lT2JqLnBsYXkoKTtcbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgaWYgKF9jdXJyZW50RmlsZSAmJiBfY3VycmVudEZpbGUgIT09IFwiXCIpIHtcbiAgICAgICAgICAvLyBhZGQgZnJhbWUgYW5kIGNyZWF0ZSB0aGUgcGxheWVyXG4gICAgICAgICAgX2ZyYW1lQ29udHJvbGxlci5hZGQoMCk7XG4gICAgICAgICAgX2ZyYW1lQ29udHJvbGxlci5jcmVhdGVGcmFtZVBsYXllcigwLCBfYWRkaXRpb25hbFBhcmFtcywgX2N1cnJlbnRGaWxlLCBjb25maWcuU0tJTiwgXCJwbGF5ZXIuaHRtbFwiKTtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRW5kZWQoKSB7XG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgX2RvbmUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllclJlYWR5KCkge1xuICAgIHZhciBmcmFtZU9iajtcblxuICAgIC8vIEVuc3VyZXMgbWVzc2FnaW5nIGlzIGhpZGRlbiBmb3Igbm9uLXN0b3JhZ2UgdmlkZW8gZmlsZVxuICAgIF9tZXNzYWdlLmhpZGUoKTtcblxuICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgICAgZnJhbWVPYmoucGxheSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMobmFtZXMsIHZhbHVlcykge1xuICAgIHZhciBpc1N0b3JhZ2VGaWxlO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZSh2YWx1ZXNbMF0pO1xuICAgICAgICBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpO1xuXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIikuc3R5bGUuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKSArIFwicHhcIjtcblxuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCA9IF9wcmVmcy5nZXRJbnQoXCJyc1dcIik7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIik7XG5cbiAgICAgICAgX21lc3NhZ2UgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uTWVzc2FnZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLFxuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVzc2FnZUNvbnRhaW5lclwiKSk7XG5cbiAgICAgICAgLy8gc2hvdyB3YWl0IG1lc3NhZ2Ugd2hpbGUgU3RvcmFnZSBpbml0aWFsaXplc1xuICAgICAgICBfbWVzc2FnZS5zaG93KFwiUGxlYXNlIHdhaXQgd2hpbGUgeW91ciB2aWRlbyBpcyBkb3dubG9hZGVkLlwiKTtcblxuICAgICAgICBfZnJhbWVDb250cm9sbGVyID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLlZpZGVvLkZyYW1lQ29udHJvbGxlcigpO1xuXG4gICAgICAgIGlzU3RvcmFnZUZpbGUgPSAoT2JqZWN0LmtleXMoX2FkZGl0aW9uYWxQYXJhbXMuc3RvcmFnZSkubGVuZ3RoICE9PSAwKTtcblxuICAgICAgICBpZiAoIWlzU3RvcmFnZUZpbGUpIHtcbiAgICAgICAgICBfbm9uU3RvcmFnZSA9IG5ldyBSaXNlVmlzaW9uLlZpZGVvLk5vblN0b3JhZ2UoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgICAgIF9ub25TdG9yYWdlLmluaXQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBjcmVhdGUgYW5kIGluaXRpYWxpemUgdGhlIFN0b3JhZ2UgbW9kdWxlIGluc3RhbmNlXG4gICAgICAgICAgX3N0b3JhZ2UgPSBuZXcgUmlzZVZpc2lvbi5WaWRlby5TdG9yYWdlKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgICBfc3RvcmFnZS5pbml0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBfcmVhZHkoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBBbiBlcnJvciBvY2N1cnJlZCB3aXRoIEpXIFBsYXllci5cbiAgZnVuY3Rpb24gcGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICB2YXIgZGV0YWlscyA9IG51bGwsXG4gICAgICBwYXJhbXMgPSB7fTtcblxuICAgIF9wbGF5YmFja0Vycm9yID0gdHJ1ZTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLnR5cGUgJiYgZXJyb3IubWVzc2FnZSkge1xuICAgICAgICBkZXRhaWxzID0gZXJyb3IudHlwZSArIFwiIC0gXCIgKyBlcnJvci5tZXNzYWdlO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZXJyb3IudHlwZSkge1xuICAgICAgICBkZXRhaWxzID0gZXJyb3IudHlwZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZGV0YWlscyA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGFyYW1zLmV2ZW50ID0gXCJwbGF5ZXIgZXJyb3JcIjtcbiAgICBwYXJhbXMuZXZlbnRfZGV0YWlscyA9IGRldGFpbHM7XG5cbiAgICBsb2dFdmVudChwYXJhbXMsIHRydWUpO1xuICAgIHNob3dFcnJvcihcIlNvcnJ5LCB0aGVyZSB3YXMgYSBwcm9ibGVtIHBsYXlpbmcgdGhlIHZpZGVvLlwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJsb2dFdmVudFwiOiBsb2dFdmVudCxcbiAgICBcIm9uRmlsZUluaXRcIjogb25GaWxlSW5pdCxcbiAgICBcIm9uRmlsZVJlZnJlc2hcIjogb25GaWxlUmVmcmVzaCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwic2hvd0Vycm9yXCI6IHNob3dFcnJvcixcbiAgICBcInBsYXllckVuZGVkXCI6IHBsYXllckVuZGVkLFxuICAgIFwicGxheWVyUmVhZHlcIjogcGxheWVyUmVhZHksXG4gICAgXCJwbGF5ZXJFcnJvclwiOiBwbGF5ZXJFcnJvcixcbiAgICBcInN0b3BcIjogc3RvcFxuICB9O1xuXG59KShnYWRnZXRzKTtcblxuLyogZ2xvYmFsIGNvbmZpZyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvID0gUmlzZVZpc2lvbi5WaWRlbyB8fCB7fTtcblxuUmlzZVZpc2lvbi5WaWRlby5TdG9yYWdlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9pbml0aWFsTG9hZCA9IHRydWU7XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBpbml0KCkge1xuICAgIHZhciBzdG9yYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb1N0b3JhZ2VcIik7XG5cbiAgICBpZiAoIXN0b3JhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGUuZGV0YWlsICYmIGUuZGV0YWlsLnVybCkge1xuXG4gICAgICAgIGlmIChfaW5pdGlhbExvYWQpIHtcbiAgICAgICAgICBfaW5pdGlhbExvYWQgPSBmYWxzZTtcblxuICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8ub25GaWxlSW5pdChlLmRldGFpbC51cmwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIC8vIGNoZWNrIGZvciBcImNoYW5nZWRcIiBwcm9wZXJ0eSBhbmQgZW5zdXJlIGl0IGlzIHRydWVcbiAgICAgICAgICBpZiAoZS5kZXRhaWwuaGFzT3duUHJvcGVydHkoXCJjaGFuZ2VkXCIpICYmIGUuZGV0YWlsLmNoYW5nZWQpIHtcbiAgICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8ub25GaWxlUmVmcmVzaChlLmRldGFpbC51cmwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLW5vLWZpbGVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGFyYW1zID0geyBcImV2ZW50XCI6IFwic3RvcmFnZSBmaWxlIG5vdCBmb3VuZFwiIH07XG5cbiAgICAgIFJpc2VWaXNpb24uVmlkZW8ubG9nRXZlbnQocGFyYW1zLCB0cnVlKTtcbiAgICAgIFJpc2VWaXNpb24uVmlkZW8uc2hvd0Vycm9yKFwiVGhlIHNlbGVjdGVkIHZpZGVvIGRvZXMgbm90IGV4aXN0LlwiKTtcbiAgICB9KTtcblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1lcnJvclwiLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7IFwiZXZlbnRcIjogXCJzdG9yYWdlIGVycm9yXCIgfTtcblxuICAgICAgUmlzZVZpc2lvbi5WaWRlby5sb2dFdmVudChwYXJhbXMsIHRydWUpO1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5zaG93RXJyb3IoXCJTb3JyeSwgdGhlcmUgd2FzIGEgcHJvYmxlbSBwbGF5aW5nIHRoZSB2aWRlbyBmcm9tIFN0b3JhZ2UuXCIpO1xuICAgIH0pO1xuXG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5zdG9yYWdlLmZvbGRlcik7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLnN0b3JhZ2UuZmlsZU5hbWUpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuc3RvcmFnZS5jb21wYW55SWQpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZW52XCIsIGNvbmZpZy5TVE9SQUdFX0VOVik7XG4gICAgc3RvcmFnZS5nbygpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IFJpc2VWaXNpb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uVmlkZW8uTm9uU3RvcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciByaXNlQ2FjaGUgPSBSaXNlVmlzaW9uLkNvbW1vbi5SaXNlQ2FjaGU7XG5cbiAgdmFyIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsICAvLyAxNSBtaW51dGVzXG4gICAgX3JlZnJlc2hJbnRlcnZhbElkID0gbnVsbDtcblxuICB2YXIgX2lzTG9hZGluZyA9IHRydWU7XG5cbiAgZnVuY3Rpb24gX2dldEZpbGUoKSB7XG4gICAgcmlzZUNhY2hlLmdldEZpbGUoZGF0YS51cmwsIGZ1bmN0aW9uIChyZXNwb25zZSwgZXJyb3IpIHtcbiAgICAgIGlmICghZXJyb3IpIHtcblxuICAgICAgICBpZiAoX2lzTG9hZGluZykge1xuICAgICAgICAgIF9pc0xvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8ub25GaWxlSW5pdChyZXNwb25zZS51cmwpO1xuXG4gICAgICAgICAgLy8gc3RhcnQgdGhlIHJlZnJlc2ggaW50ZXJ2YWxcbiAgICAgICAgICBfc3RhcnRSZWZyZXNoSW50ZXJ2YWwoKTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIFJpc2VWaXNpb24uVmlkZW8ub25GaWxlUmVmcmVzaChyZXNwb25zZS51cmwpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGVycm9yIG9jY3VycmVkXG4gICAgICAgIFJpc2VWaXNpb24uVmlkZW8ubG9nRXZlbnQoe1xuICAgICAgICAgIFwiZXZlbnRcIjogXCJub24tc3RvcmFnZSBlcnJvclwiLFxuICAgICAgICAgIFwiZXZlbnRfZGV0YWlsc1wiOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIFwidXJsXCI6IHJlc3BvbnNlLnVybFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdGFydFJlZnJlc2hJbnRlcnZhbCgpIHtcbiAgICBpZiAoX3JlZnJlc2hJbnRlcnZhbElkID09PSBudWxsKSB7XG4gICAgICBfcmVmcmVzaEludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9nZXRGaWxlKCk7XG4gICAgICB9LCBfcmVmcmVzaER1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgX2dldEZpbGUoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXRcbiAgfTtcbn07XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvID0gUmlzZVZpc2lvbi5Db21tb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvLkZyYW1lQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIFBSRUZJWCA9IFwiaWZfXCI7XG5cbiAgZnVuY3Rpb24gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RnJhbWVPYmplY3QoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuXG4gICAgaWYgKGlmcmFtZSkge1xuICAgICAgcmV0dXJuIChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XG4gICAgICAgIChpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50KSA/IGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQgOiBpZnJhbWUuY29udGVudERvY3VtZW50O1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gX2NsZWFyKGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG4gICAgICBmcmFtZU9iai5yZW1vdmUoKTtcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJhYm91dDpibGFua1wiKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBhZGQoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuXG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImFsbG93VHJhbnNwYXJlbmN5XCIsIHRydWUpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJmcmFtZWJvcmRlclwiLCBcIjBcIik7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNjcm9sbGluZ1wiLCBcIm5vXCIpO1xuXG4gICAgZnJhbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUZyYW1lUGxheWVyKGluZGV4LCBwYXJhbXMsIGZpbGVzLCBza2luLCBzcmMpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBmcmFtZU9iaiA9IGdldEZyYW1lT2JqZWN0KGluZGV4KSxcbiAgICAgIGlmcmFtZTtcblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcblxuICAgICAgaWZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9IG51bGw7XG5cbiAgICAgICAgLy8gaW5pdGlhbGl6ZSBhbmQgbG9hZCB0aGUgcGxheWVyIGluc2lkZSB0aGUgaWZyYW1lXG4gICAgICAgIGZyYW1lT2JqLmluaXQocGFyYW1zLCBmaWxlcywgc2tpbik7XG4gICAgICAgIGZyYW1lT2JqLmxvYWQoKTtcbiAgICAgIH07XG5cbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgc3JjKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGUoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCk7XG5cbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZShpbmRleCwgY2FsbGJhY2spIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XG5cbiAgICBfY2xlYXIoaW5kZXgpO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyByZW1vdmUgdGhlIGlmcmFtZSBieSBjbGVhcmluZyBhbGwgZWxlbWVudHMgaW5zaWRlIGRpdiBjb250YWluZXJcbiAgICAgIHdoaWxlIChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgIGZyYW1lQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9LCAyMDApO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvdyhpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcblxuICAgIGZyYW1lQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWRkOiBhZGQsXG4gICAgY3JlYXRlRnJhbWVQbGF5ZXI6IGNyZWF0ZUZyYW1lUGxheWVyLFxuICAgIGdldEZyYW1lQ29udGFpbmVyOiBnZXRGcmFtZUNvbnRhaW5lcixcbiAgICBnZXRGcmFtZU9iamVjdDogZ2V0RnJhbWVPYmplY3QsXG4gICAgaGlkZTogaGlkZSxcbiAgICByZW1vdmU6IHJlbW92ZSxcbiAgICBzaG93OiBzaG93XG4gIH07XG59O1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5NZXNzYWdlID0gZnVuY3Rpb24gKG1haW5Db250YWluZXIsIG1lc3NhZ2VDb250YWluZXIpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hY3RpdmUgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBfaW5pdCgpIHtcbiAgICB0cnkge1xuICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBtYWluQ29udGFpbmVyLnN0eWxlLmhlaWdodDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJDYW4ndCBpbml0aWFsaXplIE1lc3NhZ2UgLSBcIiwgZS5tZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgaWYgKF9hY3RpdmUpIHtcbiAgICAgIC8vIGNsZWFyIGNvbnRlbnQgb2YgbWVzc2FnZSBjb250YWluZXJcbiAgICAgIHdoaWxlIChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5yZW1vdmVDaGlsZChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgfVxuXG4gICAgICAvLyBoaWRlIG1lc3NhZ2UgY29udGFpbmVyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgLy8gc2hvdyBtYWluIGNvbnRhaW5lclxuICAgICAgbWFpbkNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG5cbiAgICAgIF9hY3RpdmUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzaG93KG1lc3NhZ2UpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG4gICAgICBwO1xuXG4gICAgaWYgKCFfYWN0aXZlKSB7XG4gICAgICAvLyBoaWRlIG1haW4gY29udGFpbmVyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cbiAgICAgIC8vIGNyZWF0ZSBtZXNzYWdlIGVsZW1lbnRcbiAgICAgIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICAgIHAuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJtZXNzYWdlXCIpO1xuICAgICAgcC5zdHlsZS5saW5lSGVpZ2h0ID0gbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XG5cbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHApO1xuICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG5cbiAgICAgIF9hY3RpdmUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBtZXNzYWdlIGFscmVhZHkgYmVpbmcgc2hvd24sIHVwZGF0ZSBtZXNzYWdlIHRleHRcbiAgICAgIHAgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcbiAgICB9XG4gIH1cblxuICBfaW5pdCgpO1xuXG4gIHJldHVybiB7XG4gICAgXCJoaWRlXCI6IGhpZGUsXG4gICAgXCJzaG93XCI6IHNob3dcbiAgfTtcbn07XG5cbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8uc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbiAgICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIFJpc2VWaXNpb24uVmlkZW8uc2V0QWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTInXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
