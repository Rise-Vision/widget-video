if("undefined"==typeof config){var config={};"undefined"!=typeof angular&&(angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","components/rv-common-i18n/dist/locales/translation_").constant("LOCALES_SUFIX",".json"),angular.module("risevision.widget.common.storage-selector.config").value("STORAGE_MODAL","http://storage.risevision.com/~rvi/storage-client-rva-test/storage-modal.html#/files/"))}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e,t){"use strict";function n(){t.rpc.call("","rsevent_done",null,l.getString("id"))}function i(){t.rpc.call("","rsevent_ready",null,l.getString("id"),!0,!0,!0,!0,!0)}function o(){p=new RiseVision.Video.Player(g),p.init()}function a(){p.pause()}function r(){p.isInitialPlay()?g.video.autoplay&&p.play():p.userPaused()||p.play()}function s(){i()}function d(n){l=new t.Prefs,g=n,e.getElementById("videoContainer").style.height=l.getInt("rsH")+"px",m=new RiseVision.Common.Background(g),m.init(o)}function u(){a()}function c(){n()}var l=null,g={},m=null,p=null;return{pause:a,play:r,setAdditionalParams:d,playerReady:s,stop:u,videoEnded:c}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function t(){r=!0,a&&"function"==typeof a&&a()}function n(e){d.removeEventListener("rise-storage-response",n),s.style.backgroundImage=Array.isArray(e.detail)?"url("+e.detail[0]+")":"url("+e.detail+")",t()}function i(){s=document.getElementById("background"),d=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,s?e.background.useImage?(s.className=e.background.image.position,s.className=e.background.image.scale?s.className+" scale-to-fit":s.className,0===Object.keys(e.backgroundStorage).length?(s.style.backgroundImage="url("+e.background.image.url+")",t()):d?(d.addEventListener("rise-storage-response",n),d.setAttribute("folder",e.backgroundStorage.folder),d.setAttribute("fileName",e.backgroundStorage.fileName),d.setAttribute("companyId",e.backgroundStorage.companyId),d.go()):console.log("Missing element with id value of 'backgroundStorage'")):t():console.log("Missing element with id value of 'background'")}function o(e){r?e&&"function"==typeof e&&e():(e&&(a=e),i())}var a=null,r=!1,s=null,d=null;return{init:o}};var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Player=function(e){"use strict";function t(){var t=e.url.substr(e.url.lastIndexOf(".")+1);return"ogv"===t&&(t="ogg"),t}function n(){m.style.visibility="visible",g.removeEventListener("loadeddata",n,!1)}function i(){RiseVision.Video.playerReady(),g.removeEventListener("canplay",i,!1)}function o(){f=!1,RiseVision.Video.videoEnded()}function a(){f=!v}function r(){p=!1,f=!1}function s(){return p}function d(){var s=document.getElementById("videoStorage"),d=document.createDocumentFragment(),u=d.appendChild(document.createElement("source")),c=document.createAttribute("src"),l=document.createAttribute("type");g.volume=e.video.volume/100,l.value="video/"+t(),u.setAttributeNode(l),g.addEventListener("loadeddata",n,!1),g.addEventListener("canplay",i,!1),g.addEventListener("ended",o,!1),g.addEventListener("pause",a,!1),g.addEventListener("play",r,!1),0===Object.keys(e.videoStorage).length?(c.value=e.url,u.setAttributeNode(c),g.appendChild(d)):(s.addEventListener("rise-storage-response",function(e){c.value=e.detail[0],u.setAttributeNode(c),g.appendChild(d)}),s.setAttribute("folder",e.videoStorage.folder),s.setAttribute("fileName",e.videoStorage.fileName),s.setAttribute("companyId",e.videoStorage.companyId),s.go())}function u(){v=!0,g.pause()}function c(){p=!1,v=!1,g.play()}function l(){return f}var g=document.getElementById("video"),m=document.getElementById("videoContainer"),p=!0,f=!1,v=!1;return{isInitialPlay:s,init:d,pause:u,play:c,userPaused:l}},function(e,t){"use strict";function n(){RiseVision.Video.play()}function i(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function a(e,t){Array.isArray(e)&&e.length>0&&"additionalParams"===e[0]&&Array.isArray(t)&&t.length>0&&RiseVision.Video.setAdditionalParams(JSON.parse(t[0]))}var r=new t.Prefs,s=r.getString("id");e.oncontextmenu=function(){return!1},s&&""!==s&&(t.rpc.register("rscmd_play_"+s,n),t.rpc.register("rscmd_pause_"+s,i),t.rpc.register("rscmd_stop_"+s,o),t.rpc.register("rsparam_set_"+s,a),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFsdWUiLCJSaXNlVmlzaW9uIiwiVmlkZW8iLCJkb2N1bWVudCIsImdhZGdldHMiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJfYmFja2dyb3VuZFJlYWR5IiwiX3BsYXllciIsIlBsYXllciIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiaW5pdCIsInBhdXNlIiwicGxheSIsImlzSW5pdGlhbFBsYXkiLCJ2aWRlbyIsImF1dG9wbGF5IiwidXNlclBhdXNlZCIsInBsYXllclJlYWR5Iiwic2V0QWRkaXRpb25hbFBhcmFtcyIsInBhcmFtcyIsIlByZWZzIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImhlaWdodCIsImdldEludCIsIl9iYWNrZ3JvdW5kIiwiQ29tbW9uIiwiQmFja2dyb3VuZCIsInN0b3AiLCJ2aWRlb0VuZGVkIiwiZGF0YSIsIl9jYWxsYmFjayIsIl9zdG9yYWdlUmVzcG9uc2UiLCJlIiwiX3N0b3JhZ2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYmFja2dyb3VuZEltYWdlIiwiQXJyYXkiLCJpc0FycmF5IiwiZGV0YWlsIiwiX2NvbmZpZ3VyZSIsImJvZHkiLCJiYWNrZ3JvdW5kIiwiY29sb3IiLCJ1c2VJbWFnZSIsImNsYXNzTmFtZSIsImltYWdlIiwicG9zaXRpb24iLCJzY2FsZSIsIk9iamVjdCIsImtleXMiLCJiYWNrZ3JvdW5kU3RvcmFnZSIsImxlbmd0aCIsInVybCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRBdHRyaWJ1dGUiLCJmb2xkZXIiLCJmaWxlTmFtZSIsImNvbXBhbnlJZCIsImdvIiwiY29uc29sZSIsImxvZyIsImNiIiwiX2dldFZpZGVvRmlsZVR5cGUiLCJ0eXBlIiwic3Vic3RyIiwibGFzdEluZGV4T2YiLCJfb25Mb2FkZWREYXRhIiwiX3ZpZGVvQ29udGFpbmVyIiwidmlzaWJpbGl0eSIsIl92aWRlbyIsIl9vbkNhblBsYXkiLCJfb25FbmRlZCIsIl91c2VyUGF1c2VkIiwiX29uUGF1c2UiLCJfdmlld2VyUGF1c2VkIiwiX29uUGxheSIsIl9pbml0aWFsUGxheSIsInN0b3JhZ2UiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJzb3VyY2UiLCJhcHBlbmRDaGlsZCIsImNyZWF0ZUVsZW1lbnQiLCJzcmNBdHRyIiwiY3JlYXRlQXR0cmlidXRlIiwidHlwZUF0dHIiLCJ2b2x1bWUiLCJzZXRBdHRyaWJ1dGVOb2RlIiwidmlkZW9TdG9yYWdlIiwid2luZG93IiwiYWRkaXRpb25hbFBhcmFtcyIsIm5hbWVzIiwidmFsdWVzIiwiSlNPTiIsInBhcnNlIiwicHJlZnMiLCJpZCIsIm9uY29udGV4dG1lbnUiLCJyZWdpc3RlciIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJhc3luYyIsInNyYyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIl0sIm1hcHBpbmdzIjoiQUFFQSxHQUFzQixtQkFBWEEsUUFBd0IsQ0FDakMsR0FBSUEsVUFJbUIsb0JBQVpDLFdBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHVEQUMzQkEsU0FBUyxnQkFBaUIsU0FFN0JGLFFBQVFDLE9BQU8sb0RBQ1pFLE1BQU0sZ0JBQWlCLDBGQU05QixHQUFJQyxZQUFhQSxjQUNqQkEsWUFBV0MsU0FFWEQsV0FBV0MsTUFBUSxTQUFXQyxFQUFVQyxHQUN0QyxZQVVBLFNBQVNDLEtBQ1BELEVBQVFFLElBQUlDLEtBQUssR0FBSSxlQUFnQixLQUFNQyxFQUFPQyxVQUFVLE9BSTlELFFBQVNDLEtBQ1BOLEVBQVFFLElBQUlDLEtBQUssR0FBSSxnQkFBaUIsS0FBTUMsRUFBT0MsVUFBVSxPQUMzRCxHQUFNLEdBQU0sR0FBTSxHQUFNLEdBRzVCLFFBQVNFLEtBRVBDLEVBQVUsR0FB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QWUsS0FBTStGLEdBQUssdUJBSWhEUCxPQUFRM0YsUUFLWCxJQUFJcUcsTUFBT0EsUUFFWEEsTUFBS0MsTUFBTSxjQUFlLGtCQUMxQkQsS0FBS0MsTUFBTSxtQkFFWCxXQUNFLEdBQUlDLEdBQUt4RyxTQUFTcUYsY0FBYyxTQUFXbUIsR0FBR3RDLEtBQU8sa0JBQW1Cc0MsRUFBR0MsT0FBUSxFQUNuRkQsRUFBR0UsS0FBTyxVQUFZMUcsU0FBUzJHLFNBQVNDLFNBQVcsY0FBZ0IsY0FBZ0IsNkJBQ25GLElBQUlDLEdBQUk3RyxTQUFTOEcscUJBQXFCLFVBQVUsRUFBSUQsR0FBRUUsV0FBV0MsYUFBYVIsRUFBSUsiLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICAvLyB2YXJpYWJsZXMgZ28gaGVyZVxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImNvbXBvbmVudHMvcnYtY29tbW9uLWkxOG4vZGlzdC9sb2NhbGVzL3RyYW5zbGF0aW9uX1wiKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19TVUZJWFwiLCBcIi5qc29uXCIpO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJyaXNldmlzaW9uLndpZGdldC5jb21tb24uc3RvcmFnZS1zZWxlY3Rvci5jb25maWdcIilcbiAgICAgIC52YWx1ZShcIlNUT1JBR0VfTU9EQUxcIiwgXCJodHRwOi8vc3RvcmFnZS5yaXNldmlzaW9uLmNvbS9+cnZpL3N0b3JhZ2UtY2xpZW50LXJ2YS10ZXN0L3N0b3JhZ2UtbW9kYWwuaHRtbCMvZmlsZXMvXCIpO1xuICB9XG59XG5cbi8qIGdsb2JhbCBnYWRnZXRzICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSB7fTtcblxuUmlzZVZpc2lvbi5WaWRlbyA9IChmdW5jdGlvbiAoZG9jdW1lbnQsIGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9wcmVmcyA9IG51bGwsXG4gICAgX2FkZGl0aW9uYWxQYXJhbXMgPSB7fSxcbiAgICBfYmFja2dyb3VuZCA9IG51bGwsXG4gICAgX3BsYXllciA9IG51bGw7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2RvbmUoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfZG9uZVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIikpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBfcmVhZHkoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfcmVhZHlcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpLFxuICAgICAgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfYmFja2dyb3VuZFJlYWR5KCkge1xuICAgIC8vIGNyZWF0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgUGxheWVyIGluc3RhbmNlXG4gICAgX3BsYXllciA9IG5ldyBSaXNlVmlzaW9uLlZpZGVvLlBsYXllcihfYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgX3BsYXllci5pbml0KCk7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIF9wbGF5ZXIucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgaWYgKF9wbGF5ZXIuaXNJbml0aWFsUGxheSgpKSB7XG4gICAgICAvLyBcImF1dG9wbGF5XCIgd2FzIHNlbGVjdGVkIGluIHNldHRpbmdzXG4gICAgICBpZiAoX2FkZGl0aW9uYWxQYXJhbXMudmlkZW8uYXV0b3BsYXkpIHtcbiAgICAgICAgX3BsYXllci5wbGF5KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghX3BsYXllci51c2VyUGF1c2VkKCkpIHtcbiAgICAgICAgX3BsYXllci5wbGF5KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyUmVhZHkoKSB7XG4gICAgX3JlYWR5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRBZGRpdGlvbmFsUGFyYW1zKHBhcmFtcykge1xuICAgIF9wcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCk7XG4gICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBwYXJhbXM7XG5cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgKyBcInB4XCI7XG5cbiAgICAvLyBjcmVhdGUgYW5kIGluaXRpYWxpemUgdGhlIEJhY2tncm91bmQgaW5zdGFuY2VcbiAgICBfYmFja2dyb3VuZCA9IG5ldyBSaXNlVmlzaW9uLkNvbW1vbi5CYWNrZ3JvdW5kKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICBfYmFja2dyb3VuZC5pbml0KF9iYWNrZ3JvdW5kUmVhZHkpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vUmlzZS1WaXNpb24vdmlld2VyL2lzc3Vlcy8zMFxuICAgIC8vIEhhdmUgdG8gY2FsbCBwYXVzZSgpIGR1ZSB0byBWaWV3ZXIgaXNzdWVcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gdmlkZW9FbmRlZCgpIHtcbiAgICBfZG9uZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyUmVhZHlcIjogcGxheWVyUmVhZHksXG4gICAgXCJzdG9wXCI6IHN0b3AsXG4gICAgXCJ2aWRlb0VuZGVkXCI6IHZpZGVvRW5kZWRcbiAgfTtcblxufSkoZG9jdW1lbnQsIGdhZGdldHMpO1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLkNvbW1vbiA9IFJpc2VWaXNpb24uQ29tbW9uIHx8IHt9O1xuXG5SaXNlVmlzaW9uLkNvbW1vbi5CYWNrZ3JvdW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9jYWxsYmFjayA9IG51bGwsXG4gICAgX3JlYWR5ID0gZmFsc2UsXG4gICAgX2JhY2tncm91bmQgPSBudWxsLFxuICAgIF9zdG9yYWdlID0gbnVsbDtcblxuICAvKlxuICAgKiBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9iYWNrZ3JvdW5kUmVhZHkoKSB7XG4gICAgX3JlYWR5ID0gdHJ1ZTtcblxuICAgIGlmIChfY2FsbGJhY2sgJiYgdHlwZW9mIF9jYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBfY2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfc3RvcmFnZVJlc3BvbnNlKGUpIHtcbiAgICBfc3RvcmFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIF9zdG9yYWdlUmVzcG9uc2UpO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZS5kZXRhaWwpKSB7XG4gICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGUuZGV0YWlsWzBdICsgXCIpXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZS5kZXRhaWwgKyBcIilcIjtcbiAgICB9XG4gICAgX2JhY2tncm91bmRSZWFkeSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2NvbmZpZ3VyZSgpIHtcbiAgICBfYmFja2dyb3VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZFwiKTtcbiAgICBfc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZFN0b3JhZ2VcIik7XG5cbiAgICAvLyBzZXQgdGhlIGRvY3VtZW50IGJhY2tncm91bmRcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmQgPSBkYXRhLmJhY2tncm91bmQuY29sb3I7XG5cbiAgICBpZiAoX2JhY2tncm91bmQpIHtcbiAgICAgIGlmIChkYXRhLmJhY2tncm91bmQudXNlSW1hZ2UpIHtcbiAgICAgICAgX2JhY2tncm91bmQuY2xhc3NOYW1lID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnBvc2l0aW9uO1xuICAgICAgICBfYmFja2dyb3VuZC5jbGFzc05hbWUgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2Uuc2NhbGUgPyBfYmFja2dyb3VuZC5jbGFzc05hbWUgKyBcIiBzY2FsZS10by1maXRcIlxuICAgICAgICAgIDogX2JhY2tncm91bmQuY2xhc3NOYW1lO1xuXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhkYXRhLmJhY2tncm91bmRTdG9yYWdlKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwgKyBcIilcIjtcbiAgICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF9zdG9yYWdlKSB7XG4gICAgICAgICAgICAvLyBSaXNlIFN0b3JhZ2VcbiAgICAgICAgICAgIF9zdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgX3N0b3JhZ2VSZXNwb25zZSk7XG5cbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZvbGRlcik7XG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImNvbXBhbnlJZFwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgICAgICAgICBfc3RvcmFnZS5nbygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZWxlbWVudCB3aXRoIGlkIHZhbHVlIG9mICdiYWNrZ3JvdW5kU3RvcmFnZSdcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiTWlzc2luZyBlbGVtZW50IHdpdGggaWQgdmFsdWUgb2YgJ2JhY2tncm91bmQnXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdChjYikge1xuICAgIGlmICghX3JlYWR5KSB7XG4gICAgICBpZiAoY2IpIHtcbiAgICAgICAgX2NhbGxiYWNrID0gY2I7XG4gICAgICB9XG5cbiAgICAgIF9jb25maWd1cmUoKTtcblxuICAgIH0gZWxzZSBpZiAoY2IgJiYgdHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGNiKCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IFJpc2VWaXNpb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uVmlkZW8uUGxheWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF92aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9cIiksXG4gICAgX3ZpZGVvQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0NvbnRhaW5lclwiKSxcbiAgICBfaW5pdGlhbFBsYXkgPSB0cnVlLFxuICAgIF91c2VyUGF1c2VkID0gZmFsc2UsXG4gICAgX3ZpZXdlclBhdXNlZCA9IGZhbHNlO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2dldFZpZGVvRmlsZVR5cGUoKSB7XG4gICAgdmFyIHR5cGUgPSBkYXRhLnVybC5zdWJzdHIoZGF0YS51cmwubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJvZ3ZcIikge1xuICAgICAgdHlwZSA9IFwib2dnXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICBmdW5jdGlvbiBfb25Mb2FkZWREYXRhKCkge1xuICAgIC8vIGF0IGxlYXNlIDFzdCBmcmFtZSBvZiB2aWRlbyBoYXMgbG9hZGVkXG4gICAgX3ZpZGVvQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgICAvLyByZW1vdmUgdGhpcyBsaXN0ZW5lclxuICAgIF92aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZGVkZGF0YVwiLCBfb25Mb2FkZWREYXRhLCBmYWxzZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfb25DYW5QbGF5KCkge1xuICAgIC8vIGVub3VnaCBkYXRhIGhhcyBsb2FkZWQgdG8gc2FmZWx5IHBsYXkgd2l0aG91dCBpbnRlcnJ1cHRpb25cbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXllclJlYWR5KCk7XG4gICAgLy8gcmVtb3ZlIHRoaXMgbGlzdGVuZXJcbiAgICBfdmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNhbnBsYXlcIiwgX29uQ2FuUGxheSwgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gX29uRW5kZWQoKSB7XG4gICAgLy8gYSBcInBhdXNlXCIgZXZlbnQgaXMgYWx3YXlzIGZpcmVkIGJlZm9yZSBcImVuZGVkXCIgZXZlbnQsIGVuc3VyZSBfdXNlclBhdXNlZCBpcyBmYWxzZVxuICAgIF91c2VyUGF1c2VkID0gZmFsc2U7XG4gICAgLy8gdmlkZW8gZW5kZWRcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnZpZGVvRW5kZWQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBhdXNlKCkge1xuICAgIC8vIHRoaXMgaGFuZGxlciBhbHNvIGdldHMgY2FsbGVkIHZpYSBwdWJsaWMgXCJwYXVzZSgpXCIgZnVuY3Rpb24sIG9ubHkgc2V0IFwiX3VzZXJQYXVzZWQgPSB0cnVlXCIgaWYgbm90IHRoZSBjYXNlXG4gICAgX3VzZXJQYXVzZWQgPSAhX3ZpZXdlclBhdXNlZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBsYXkoKSB7XG4gICAgX2luaXRpYWxQbGF5ID0gZmFsc2U7XG4gICAgX3VzZXJQYXVzZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaXNJbml0aWFsUGxheSgpIHtcbiAgICByZXR1cm4gX2luaXRpYWxQbGF5O1xuICB9XG5cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9TdG9yYWdlXCIpLFxuICAgICAgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG4gICAgICBzb3VyY2UgPSBmcmFnbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic291cmNlXCIpKSxcbiAgICAgIHNyY0F0dHIgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoXCJzcmNcIiksXG4gICAgICB0eXBlQXR0ciA9IGRvY3VtZW50LmNyZWF0ZUF0dHJpYnV0ZShcInR5cGVcIik7XG5cbiAgICAvLyBzZXQgaW5pdGlhbCB2b2x1bWUgb24gPHZpZGVvPlxuICAgIF92aWRlby52b2x1bWUgPSBkYXRhLnZpZGVvLnZvbHVtZSAvIDEwMDtcblxuICAgIC8vIHNldCB0aGUgXCJ0eXBlXCIgYXR0cmlidXRlIG9uIDxzb3VyY2U+XG4gICAgdHlwZUF0dHIudmFsdWUgPSBcInZpZGVvL1wiICsgX2dldFZpZGVvRmlsZVR5cGUoKTtcbiAgICBzb3VyY2Uuc2V0QXR0cmlidXRlTm9kZSh0eXBlQXR0cik7XG5cbiAgICAvLyB2aWRlbyBldmVudHNcbiAgICBfdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRlZGRhdGFcIiwgX29uTG9hZGVkRGF0YSwgZmFsc2UpO1xuICAgIF92aWRlby5hZGRFdmVudExpc3RlbmVyKFwiY2FucGxheVwiLCBfb25DYW5QbGF5LCBmYWxzZSk7XG4gICAgX3ZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCBfb25FbmRlZCwgZmFsc2UpO1xuICAgIF92aWRlby5hZGRFdmVudExpc3RlbmVyKFwicGF1c2VcIiwgX29uUGF1c2UsIGZhbHNlKTtcbiAgICBfdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcInBsYXlcIiwgX29uUGxheSwgZmFsc2UpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGRhdGEudmlkZW9TdG9yYWdlKS5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIE5vbiBzdG9yYWdlIFVSTFxuICAgICAgc3JjQXR0ci52YWx1ZSA9IGRhdGEudXJsO1xuICAgICAgc291cmNlLnNldEF0dHJpYnV0ZU5vZGUoc3JjQXR0cik7XG4gICAgICBfdmlkZW8uYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHNyY0F0dHIudmFsdWUgPSBlLmRldGFpbFswXTtcbiAgICAgICAgc291cmNlLnNldEF0dHJpYnV0ZU5vZGUoc3JjQXR0cik7XG4gICAgICAgIF92aWRlby5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICB9KTtcblxuICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS52aWRlb1N0b3JhZ2UuZm9sZGVyKTtcbiAgICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZmlsZU5hbWVcIiwgZGF0YS52aWRlb1N0b3JhZ2UuZmlsZU5hbWUpO1xuICAgICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS52aWRlb1N0b3JhZ2UuY29tcGFueUlkKTtcbiAgICAgIHN0b3JhZ2UuZ28oKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBfdmlld2VyUGF1c2VkID0gdHJ1ZTtcbiAgICBfdmlkZW8ucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgX2luaXRpYWxQbGF5ID0gZmFsc2U7XG4gICAgX3ZpZXdlclBhdXNlZCA9IGZhbHNlO1xuICAgIF92aWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiB1c2VyUGF1c2VkKCkge1xuICAgIHJldHVybiBfdXNlclBhdXNlZDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpc0luaXRpYWxQbGF5XCI6IGlzSW5pdGlhbFBsYXksXG4gICAgXCJpbml0XCI6IGluaXQsXG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInVzZXJQYXVzZWRcIjogdXNlclBhdXNlZFxuICB9O1xufTtcblxuLyogZ2xvYmFsIGdhZGdldHMsIFJpc2VWaXNpb24gKi9cblxuKGZ1bmN0aW9uICh3aW5kb3csIGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIHByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKSxcbiAgICBpZCA9IHByZWZzLmdldFN0cmluZyhcImlkXCIpO1xuXG4gIC8vIERpc2FibGUgY29udGV4dCBtZW51IChyaWdodCBjbGljayBtZW51KVxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8ucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5zdG9wKCk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRpdGlvbmFsUGFyYW1zKG5hbWVzLCB2YWx1ZXMpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCAmJiBuYW1lc1swXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5zZXRBZGRpdGlvbmFsUGFyYW1zKEpTT04ucGFyc2UodmFsdWVzWzBdKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKGlkICYmIGlkICE9PSBcIlwiKSB7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wbGF5X1wiICsgaWQsIHBsYXkpO1xuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UpO1xuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfc3RvcF9cIiArIGlkLCBzdG9wKTtcblxuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNwYXJhbV9zZXRfXCIgKyBpZCwgYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbXCJhZGRpdGlvbmFsUGFyYW1zXCJdKTtcblxuICB9XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTInXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9