function configure(){}function doneEvent(){source.postMessage({event:"playerEnded"},origin)}function readyEvent(){source.postMessage({event:"playerReady"},origin)}function errorEvent(e){source.postMessage({event:"playerError",error:e},origin)}function playlistItemEvent(e){source.postMessage({event:"playerItemChange",index:e},origin)}function init(e,t){window.oncontextmenu=function(){return!1},width=e.width,height=e.height,controls=e.video.controls,volume=e.video.volume,stretching=e.video.scaleToFit?"uniform":"none",autoPlay=controls?e.video.autoplay:!0,e.video.pause?(e.video.pause="string"==typeof e.video.pause?parseInt(e.video.pause,10):e.video.pause,pauseDuration=isNaN(e.video.pause)?0:e.video.pause):pauseDuration=0,configure(t)}function load(){player.loadVideo()}function play(){player.play()}function pause(){"PLAYING"===player.getState().toUpperCase()&&player.pause()}function stop(){player.stop()}function remove(){player.remove()}function getVideoFileType(e){var t,n=[".mp4",".webm"],o=e.toLowerCase(),r=null;for(t=0;t<=n.length;t+=1)if(-1!==o.indexOf(n[t])){r=n[t].substr(n[t].lastIndexOf(".")+1);break}return r}function configure(e){files=e;var t=function(){var e=playerJW({playlist:getPlaylist(files),width:width,height:height,controls:!1,skin:{name:"rise"},stretching:stretching});return e.onPlayerError=function(e){e&&errorEvent({type:"video",index:jwplayer().getPlaylistIndex(),message:e.message})},e.onSetupError=function(e){e&&errorEvent({type:"setup",index:0,message:e.message})},e.getCurrentIndex=function(){return jwplayer().getPlaylistIndex()},e};player=t()}function getPlaylist(e){for(var t=[],n=0;n<e.length;n+=1)t.push({file:e[n],type:getVideoFileType(e[n])});return t}var controls,volume,autoPlay,stretching,pauseDuration,width,height,player=null,source=null,origin=null,playerJW=function(e){"use strict";function t(){doneEvent()}function n(){g||(clearTimeout(d),d=setTimeout(function(){jwplayer().play(),jwplayer().setControls(!1),jwplayer().setControls(!0)},1e3*pauseDuration))}function o(e){playlistItemEvent(e)}function r(e){e&&errorEvent({type:"video",message:e.message})}function a(e){e&&errorEvent({type:"setup",message:e.message})}function i(){jwplayer("player").setup(e),jwplayer().onSetupError(function(e){a(e)}),jwplayer().on("ready",function(){e.hasOwnProperty("playlist")?(jwplayer().on("playlistComplete",function(){t()}),jwplayer().on("playlistItem",function(e){o(e.index)})):e.hasOwnProperty("file")&&jwplayer().on("complete",function(){t()}),jwplayer().on("error",function(e){r(e)}),controls&&pauseDuration>1&&jwplayer().on("pause",function(){n()}),jwplayer().setVolume(volume),controls&&!autoPlay&&jwplayer().setControls(!0),readyEvent()})}function s(){g=!1,autoPlay&&(controls&&!jwplayer().getControls()&&jwplayer().setControls(!0),jwplayer().play(),controls&&(jwplayer().setControls(!1),jwplayer().setControls(!0)))}function l(){g=!0,clearTimeout(d),jwplayer().pause()}function u(){this.pause()}function p(){g=!1,clearTimeout(d),d=null,jwplayer().remove()}function c(){return jwplayer().getDuration()}function y(){return jwplayer().getPosition()}function f(){return jwplayer().getState()}var g=!1,d=null;return{getDuration:c,getPosition:y,getState:f,loadVideo:i,play:s,pause:l,onPlayerError:r,onSetupError:a,stop:u,remove:p}};window.addEventListener("message",function(e){if(origin=e.origin||e.originalEvent.origin,"http://s3.amazonaws.com"!==origin&&"http://localhost:8000"!==origin)return origin=null,void 0;if(source=e.source,e.data&&"object"==typeof e.data&&e.data.event)switch(e.data.event){case"init":init(e.data.params,e.data.files),load();break;case"play":play();break;case"pause":pause();break;case"stop":stop();break;case"remove":remove()}});var files;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3BsYXllci1mb2xkZXIubWluLmpzIl0sIm5hbWVzIjpbImNvbmZpZ3VyZSIsImRvbmVFdmVudCIsInNvdXJjZSIsInBvc3RNZXNzYWdlIiwiZXZlbnQiLCJvcmlnaW4iLCJyZWFkeUV2ZW50IiwiZXJyb3JFdmVudCIsImRhdGEiLCJlcnJvciIsInBsYXlsaXN0SXRlbUV2ZW50IiwiaW5kZXgiLCJpbml0IiwicGFyYW1zIiwidXJscyIsIndpbmRvdyIsIm9uY29udGV4dG1lbnUiLCJ3aWR0aCIsImhlaWdodCIsImNvbnRyb2xzIiwidmlkZW8iLCJ2b2x1bWUiLCJzdHJldGNoaW5nIiwiYXV0b1BsYXkiLCJhdXRvcGxheSIsInBhdXNlIiwicGFyc2VJbnQiLCJwYXVzZUR1cmF0aW9uIiwiaXNOYU4iLCJsb2FkIiwicGxheWVyIiwibG9hZFZpZGVvIiwicGxheSIsImdldFN0YXRlIiwidG9VcHBlckNhc2UiLCJzdG9wIiwicmVtb3ZlIiwiZ2V0VmlkZW9GaWxlVHlwZSIsInVybCIsImkiLCJleHRlbnNpb25zIiwidXJsTG93ZXJjYXNlIiwidG9Mb3dlckNhc2UiLCJ0eXBlIiwibGVuZ3RoIiwiaW5kZXhPZiIsInN1YnN0ciIsImxhc3RJbmRleE9mIiwiZmlsZXMiLCJmb2xkZXJQbGF5ZXIiLCJpbnN0YW5jZSIsInBsYXllckpXIiwicGxheWxpc3QiLCJnZXRQbGF5bGlzdCIsInNraW4iLCJuYW1lIiwib25QbGF5ZXJFcnJvciIsImp3cGxheWVyIiwiZ2V0UGxheWxpc3RJbmRleCIsIm1lc3NhZ2UiLCJvblNldHVwRXJyb3IiLCJnZXRDdXJyZW50SW5kZXgiLCJsaXN0IiwicHVzaCIsImZpbGUiLCJzZXR1cE9iaiIsIl9vbkNvbXBsZXRlIiwiX29uUGF1c2UiLCJ2aWV3ZXJQYXVzZWQiLCJjbGVhclRpbWVvdXQiLCJwYXVzZVRpbWVyIiwic2V0VGltZW91dCIsInNldENvbnRyb2xzIiwiX29uUGxheWxpc3RJdGVtIiwic2V0dXAiLCJvbiIsImhhc093blByb3BlcnR5Iiwic2V0Vm9sdW1lIiwiZ2V0Q29udHJvbHMiLCJ0aGlzIiwiZ2V0RHVyYXRpb24iLCJnZXRQb3NpdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJvcmlnaW5hbEV2ZW50Il0sIm1hcHBpbmdzIjoiQUFTQSxRQUFTQSxjQUVULFFBQVNDLGFBQ1BDLE9BQU9DLGFBQ0xDLE1BQU8sZUFDTkMsUUFHTCxRQUFTQyxjQUNQSixPQUFPQyxhQUNMQyxNQUFPLGVBQ05DLFFBSUwsUUFBU0UsWUFBV0MsR0FDbEJOLE9BQU9DLGFBQ0xDLE1BQU8sY0FDUEssTUFBT0QsR0FDTkgsUUFHTCxRQUFTSyxtQkFBa0JDLEdBQ3pCVCxPQUFPQyxhQUNMQyxNQUFPLG1CQUNQTyxNQUFPQSxHQUNOTixRQUdMLFFBQVNPLE1BQUtDLEVBQVFDLEdBQ3BCQyxPQUFPQyxjQUFnQixXQUNyQixPQUFPLEdBR1RDLE1BQVFKLEVBQU9JLE1BQ2ZDLE9BQVNMLEVBQU9LLE9BQ2hCQyxTQUFXTixFQUFPTyxNQUFNRCxTQUN4QkUsT0FBU1IsRUFBT08sTUFBTUMsT0FDdEJDLFdBQWNULEVBQU9PLE1BQWdCLFdBQUksVUFBWSxPQUdyREcsU0FBYUosU0FBbUJOLEVBQU9PLE1BQU1JLFVBQXBCLEVBR3JCWCxFQUFPTyxNQUFNSyxPQUVmWixFQUFPTyxNQUFNSyxNQUF1QyxnQkFBdkJaLEdBQU9PLE1BQU1LLE1BQXNCQyxTQUFTYixFQUFPTyxNQUFNSyxNQUFPLElBQU1aLEVBQU9PLE1BQU1LLE1BR2hIRSxjQUFpQkMsTUFBTWYsRUFBT08sTUFBTUssT0FBVSxFQUFJWixFQUFPTyxNQUFNSyxPQUcvREUsY0FBZ0IsRUFHbEIzQixVQUFVYyxHQUdaLFFBQVNlLFFBQ1BDLE9BQU9DLFlBR1QsUUFBU0MsUUFDUEYsT0FBT0UsT0FHVCxRQUFTUCxTQUVpQyxZQUFwQ0ssT0FBT0csV0FBV0MsZUFDcEJKLE9BQU9MLFFBSVgsUUFBU1UsUUFDUEwsT0FBT0ssT0FHVCxRQUFTQyxVQUNQTixPQUFPTSxTQUdULFFBQVNDLGtCQUFrQkMsR0FDekIs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LGFBQWFDLEdBQ2JBLEVBQWEsS0FDYmIsV0FBV3JCLFNBR2IsUUFBUzRDLEtBQ1AsTUFBT3ZCLFlBQVd1QixjQUdwQixRQUFTQyxLQUNQLE1BQU94QixZQUFXd0IsY0FHcEIsUUFBU2hELEtBQ1AsTUFBT3dCLFlBQVd4QixXQTVJcEIsR0FBSW1DLElBQWUsRUFDZkUsRUFBYSxJQThJakIsUUFDRVUsWUFBYUEsRUFDYkMsWUFBYUEsRUFDYmhELFNBQVVBLEVBQ1ZGLFVBQVdBLEVBQ1hDLEtBQU1BLEVBQ05QLE1BQU9BLEVBQ1ArQixjQUFlQSxFQUNmSSxhQUFjQSxFQUNkekIsS0FBTUEsRUFDTkMsT0FBUUEsR0FJWnJCLFFBQU9tRSxpQkFBaUIsVUFBVyxTQUFTOUUsR0FJMUMsR0FIQUMsT0FBU0QsRUFBTUMsUUFBVUQsRUFBTStFLGNBQWM5RSxPQUc5Qiw0QkFBWEEsUUFBbUQsMEJBQVhBLE9BRTFDLE1BREFBLFFBQVMsS0FDVCxNQUtGLElBRkFILE9BQVNFLEVBQU1GLE9BRVhFLEVBQU1JLE1BQThCLGdCQUFmSixHQUFNSSxNQUFxQkosRUFBTUksS0FBS0osTUFDN0QsT0FBUUEsRUFBTUksS0FBS0osT0FDakIsSUFBSyxPQUNIUSxLQUFLUixFQUFNSSxLQUFLSyxPQUFRVCxFQUFNSSxLQUFLd0MsT0FDbkNuQixNQUVBLE1BQ0YsS0FBSyxPQUNIRyxNQUNBLE1BQ0YsS0FBSyxRQUNIUCxPQUNBLE1BQ0YsS0FBSyxPQUNIVSxNQUNBLE1BQ0YsS0FBSyxTQUNIQyxXQU1SLElBQUlZIiwiZmlsZSI6ImpzL3BsYXllci1mb2xkZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNvbnRyb2xzLCB2b2x1bWUsIGF1dG9QbGF5LCBzdHJldGNoaW5nLCBwYXVzZUR1cmF0aW9uO1xudmFyIHdpZHRoLCBoZWlnaHQ7XG5cbnZhciBwbGF5ZXIgPSBudWxsO1xuXG52YXIgc291cmNlID0gbnVsbCxcbiAgb3JpZ2luID0gbnVsbDtcblxuLy8gT1ZFUlJJREU6IG1ldGhvZCB0byBkaXN0aW5ndWlzaCBjb25maWd1cmF0aW9ucyBiZXR3ZWVuIGZpbGUgYW5kIGZvbGRlclxuZnVuY3Rpb24gY29uZmlndXJlKHVybHMpe31cblxuZnVuY3Rpb24gZG9uZUV2ZW50KCkge1xuICBzb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgIGV2ZW50OiBcInBsYXllckVuZGVkXCJcbiAgfSwgb3JpZ2luKTtcbn1cblxuZnVuY3Rpb24gcmVhZHlFdmVudCgpIHtcbiAgc291cmNlLnBvc3RNZXNzYWdlKHtcbiAgICBldmVudDogXCJwbGF5ZXJSZWFkeVwiXG4gIH0sIG9yaWdpbik7XG5cbn1cblxuZnVuY3Rpb24gZXJyb3JFdmVudChkYXRhKSB7XG4gIHNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgZXZlbnQ6IFwicGxheWVyRXJyb3JcIixcbiAgICBlcnJvcjogZGF0YVxuICB9LCBvcmlnaW4pO1xufVxuXG5mdW5jdGlvbiBwbGF5bGlzdEl0ZW1FdmVudChpbmRleCkge1xuICBzb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgIGV2ZW50OiBcInBsYXllckl0ZW1DaGFuZ2VcIixcbiAgICBpbmRleDogaW5kZXhcbiAgfSwgb3JpZ2luKTtcbn1cblxuZnVuY3Rpb24gaW5pdChwYXJhbXMsIHVybHMpIHtcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgd2lkdGggPSBwYXJhbXMud2lkdGg7XG4gIGhlaWdodCA9IHBhcmFtcy5oZWlnaHQ7XG4gIGNvbnRyb2xzID0gcGFyYW1zLnZpZGVvLmNvbnRyb2xzO1xuICB2b2x1bWUgPSBwYXJhbXMudmlkZW8udm9sdW1lO1xuICBzdHJldGNoaW5nID0gKHBhcmFtcy52aWRlby5zY2FsZVRvRml0KSA/IFwidW5pZm9ybVwiIDogXCJub25lXCI7XG5cbiAgLy8gZW5zdXJlIGF1dG9QbGF5IGlzIHRydWUgaWYgY29udHJvbHMgdmFsdWUgaXMgZmFsc2UsIG90aGVyd2lzZSB1c2UgcGFyYW1zIHZhbHVlXG4gIGF1dG9QbGF5ID0gKCFjb250cm9scykgPyB0cnVlIDogcGFyYW1zLnZpZGVvLmF1dG9wbGF5O1xuXG4gIC8vIGNoZWNrIGlmIHRoaXMgc2V0dGluZyBleGlzdHMgZHVlIHRvIG1lcmdlIG9mIGZpbGUgYW5kIGZvbGRlclxuICBpZiAocGFyYW1zLnZpZGVvLnBhdXNlKSB7XG4gICAgLy8gY29udmVydCBwYXVzZSB2YWx1ZSB0byBudW1iZXIgaWYgdHlwZSBpcyBcInN0cmluZ1wiXG4gICAgcGFyYW1zLnZpZGVvLnBhdXNlID0gKHR5cGVvZiBwYXJhbXMudmlkZW8ucGF1c2UgPT09IFwic3RyaW5nXCIpID8gcGFyc2VJbnQocGFyYW1zLnZpZGVvLnBhdXNlLCAxMCkgOiBwYXJhbXMudmlkZW8ucGF1c2U7XG5cbiAgICAvLyBpZiBub3Qgb2YgdHlwZSBcIm51bWJlclwiLCBzZXQgaXRzIHZhbHVlIHRvIDAgc28gYSBwYXVzZSBkb2VzIG5vdCBnZXQgYXBwbGllZFxuICAgIHBhdXNlRHVyYXRpb24gPSAoaXNOYU4ocGFyYW1zLnZpZGVvLnBhdXNlKSkgPyAwIDogcGFyYW1zLnZpZGVvLnBhdXNlO1xuICB9IGVsc2Uge1xuICAgIC8vIGVuc3VyZSBubyBwYXVzZSBkdXJhdGlvbiBvY2N1cnNcbiAgICBwYXVzZUR1cmF0aW9uID0gMDtcbiAgfVxuXG4gIGNvbmZpZ3VyZSh1cmxzKTtcbn1cblxuZnVuY3Rpb24gbG9hZCgpIHtcbiAgcGxheWVyLmxvYWRWaWRlbygpO1xufVxuXG5mdW5jdGlvbiBwbGF5KCkge1xuICBwbGF5ZXIucGxheSgpO1xufVxuXG5mdW5jdGlvbiBwYXVzZSgpIHtcbiAgLy8gT25seSBwYXVzZSB2aWRlbyBpZiBpdCdzIGFjdHVhbGx5IHBsYXlpbmcuXG4gIGlmIChwbGF5ZXIuZ2V0U3RhdGUoKS50b1VwcGVyQ2FzZSgpID09PSBcIlBMQVlJTkdcIikge1xuICAgIHBsYXllci5wYXVzZSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHN0b3AoKSB7XG4gIHBsYXllci5zdG9wKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgcGxheWVyLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiBnZXRWaWRlb0ZpbGVUeXBlICh1cmwpIHtcbiAgdmFyIGV4dGVuc2lvbnMgPSBbXCIubXA0XCIsIFwiLndlYm1cIl0sXG4gICAgdXJsTG93ZXJjYXNlID0gdXJsLnRvTG93ZXJDYXNlKCksXG4gICAgdHlwZSA9IG51bGwsXG4gICAgaTtcblxuICBmb3IgKGkgPSAwOyBpIDw9IGV4dGVuc2lvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAodXJsTG93ZXJjYXNlLmluZGV4T2YoZXh0ZW5zaW9uc1tpXSkgIT09IC0xKSB7XG4gICAgICB0eXBlID0gZXh0ZW5zaW9uc1tpXS5zdWJzdHIoZXh0ZW5zaW9uc1tpXS5sYXN0SW5kZXhPZihcIi5cIikgKyAxKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0eXBlO1xufVxuXG4vLyBpbmhlcml0IGZyb20gcGxheWVySlcgZm9yIGEgY3VzdG9taXplZCBmaWxlIG9yIGZvbGRlciBwbGF5ZXJcbnZhciBwbGF5ZXJKVyA9IGZ1bmN0aW9uIChzZXR1cE9iaikge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgdmlld2VyUGF1c2VkID0gZmFsc2U7XG4gIHZhciBwYXVzZVRpbWVyID0gbnVsbDtcblxuICBmdW5jdGlvbiBfb25Db21wbGV0ZSgpIHtcbiAgICBkb25lRXZlbnQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBhdXNlKCkge1xuICAgIGlmICghdmlld2VyUGF1c2VkKSB7XG4gICAgICAvLyB1c2VyIGhhcyBwYXVzZWQsIHNldCBhIHRpbWVyIHRvIHBsYXkgYWdhaW5cbiAgICAgIGNsZWFyVGltZW91dChwYXVzZVRpbWVyKTtcblxuICAgICAgcGF1c2VUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBjb250aW51ZSBwbGF5aW5nIHRoZSBjdXJyZW50IHZpZGVvXG4gICAgICAgIGp3cGxheWVyKCkucGxheSgpO1xuXG4gICAgICAgIC8vIHdvcmthcm91bmQgZm9yIGNvbnRyb2xzIHJlbWFpbmluZyB2aXNpYmxlLCB0dXJuIHRoZW0gb2ZmIGFuZCBvbiBhZ2FpblxuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKGZhbHNlKTtcbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcblxuICAgICAgfSwgcGF1c2VEdXJhdGlvbiAqIDEwMDApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBsYXlsaXN0SXRlbShpbmRleCkge1xuICAgIHBsYXlsaXN0SXRlbUV2ZW50KGluZGV4KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yRXZlbnQoe1xuICAgICAgICB0eXBlOiBcInZpZGVvXCIsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU2V0dXBFcnJvcihlcnJvcikge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3JFdmVudCh7XG4gICAgICAgIHR5cGU6IFwic2V0dXBcIixcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbG9hZFZpZGVvKCkge1xuICAgIGp3cGxheWVyKFwicGxheWVyXCIpLnNldHVwKHNldHVwT2JqKTtcblxuICAgIGp3cGxheWVyKCkub25TZXR1cEVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgb25TZXR1cEVycm9yKGVycm9yKTtcbiAgICB9KTtcblxuICAgIGp3cGxheWVyKCkub24oXCJyZWFkeVwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgaWYgKHNldHVwT2JqLmhhc093blByb3BlcnR5KFwicGxheWxpc3RcIikpIHtcbiAgICAgICAgLy8gZm9sZGVyLCBsaXN0ZW4gZm9yIHBsYXlsaXN0IGNvbXBsZXRlIGV2ZW50XG4gICAgICAgIGp3cGxheWVyKCkub24oXCJwbGF5bGlzdENvbXBsZXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfb25Db21wbGV0ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBmb2xkZXIsIGxpc3RlbiBmb3Igd2hlbiBhIHBsYXlsaXN0IGl0ZW0gY2hhbmdlc1xuICAgICAgICBqd3BsYXllcigpLm9uKFwicGxheWxpc3RJdGVtXCIsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBfb25QbGF5bGlzdEl0ZW0oZGF0YS5pbmRleCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoc2V0dXBPYmouaGFzT3duUHJvcGVydHkoXCJmaWxlXCIpKSB7XG4gICAgICAgIC8vIGZpbGUsIGxpc3RlbiBmb3Igc2luZ2xlIGZpbGUgY29tcGxldGUgZXZlbnRcbiAgICAgICAgandwbGF5ZXIoKS5vbihcImNvbXBsZXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfb25Db21wbGV0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgandwbGF5ZXIoKS5vbihcImVycm9yXCIsIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBvblBsYXllckVycm9yKGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoY29udHJvbHMgJiYgcGF1c2VEdXJhdGlvbiA+IDEpIHtcbiAgICAgICAgandwbGF5ZXIoKS5vbihcInBhdXNlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfb25QYXVzZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgandwbGF5ZXIoKS5zZXRWb2x1bWUodm9sdW1lKTtcblxuICAgICAgaWYgKGNvbnRyb2xzICYmICFhdXRvUGxheSkge1xuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKHRydWUpO1xuICAgICAgfVxuXG4gICAgICByZWFkeUV2ZW50KCk7XG5cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgdmlld2VyUGF1c2VkID0gZmFsc2U7XG5cbiAgICBpZiAoYXV0b1BsYXkpIHtcbiAgICAgIGlmIChjb250cm9scyAmJiAhandwbGF5ZXIoKS5nZXRDb250cm9scygpKSB7XG4gICAgICAgIC8vIFdpbGwgYmUgZmlyc3QgdGltZSBwbGF5ZXIgaXMgYmVpbmcgdG9sZCB0byBwbGF5IHNvIGRvaW5nIHRoaXMgaGVyZSBhbmQgbm90IGluIHNldHVwIHNvIHRoYXQgY29udHJvbHNcbiAgICAgICAgLy8gYXJlbid0IHZpc2libGUgdXBvbiBwbGF5aW5nIGZvciB0aGUgZmlyc3QgdGltZS5cbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcbiAgICAgIH1cblxuICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG5cbiAgICAgIGlmIChjb250cm9scykge1xuICAgICAgICAvLyB3b3JrYXJvdW5kIGZvciBjb250cm9scyByZW1haW5pbmcgdmlzaWJsZSwgdHVybiB0aGVtIG9mZiBhbmQgb24gYWdhaW5cbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyhmYWxzZSk7XG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHModHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgdmlld2VyUGF1c2VkID0gdHJ1ZTtcbiAgICBjbGVhclRpbWVvdXQocGF1c2VUaW1lcik7XG4gICAgandwbGF5ZXIoKS5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICB0aGlzLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgdmlld2VyUGF1c2VkID0gZmFsc2U7XG4gICAgY2xlYXJUaW1lb3V0KHBhdXNlVGltZXIpO1xuICAgIHBhdXNlVGltZXIgPSBudWxsO1xuICAgIGp3cGxheWVyKCkucmVtb3ZlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXREdXJhdGlvbigpIHtcbiAgICByZXR1cm4gandwbGF5ZXIoKS5nZXREdXJhdGlvbigpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UG9zaXRpb24oKSB7XG4gICAgcmV0dXJuIGp3cGxheWVyKCkuZ2V0UG9zaXRpb24oKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFN0YXRlKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldFN0YXRlKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdldER1cmF0aW9uOiBnZXREdXJhdGlvbixcbiAgICBnZXRQb3NpdGlvbjogZ2V0UG9zaXRpb24sXG4gICAgZ2V0U3RhdGU6IGdldFN0YXRlLFxuICAgIGxvYWRWaWRlbzogbG9hZFZpZGVvLFxuICAgIHBsYXk6IHBsYXksXG4gICAgcGF1c2U6IHBhdXNlLFxuICAgIG9uUGxheWVyRXJyb3I6IG9uUGxheWVyRXJyb3IsXG4gICAgb25TZXR1cEVycm9yOiBvblNldHVwRXJyb3IsXG4gICAgc3RvcDogc3RvcCxcbiAgICByZW1vdmU6IHJlbW92ZVxuICB9XG59O1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgb3JpZ2luID0gZXZlbnQub3JpZ2luIHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQub3JpZ2luO1xuXG4gIC8vIGVuc3VyZSB0aGlzIG1lc3NhZ2UgaXMgY29taW5nIGZyb20gQW1hem9uIFMzICh3aWRnZXQpIG9yIHByZXZpZXcgYXBwIChsb2NhbCB3aWRnZXQpXG4gIGlmIChvcmlnaW4gIT09IFwiaHR0cDovL3MzLmFtYXpvbmF3cy5jb21cIiAmJiBvcmlnaW4gIT09IFwiaHR0cDovL2xvY2FsaG9zdDo4MDAwXCIpIHtcbiAgICBvcmlnaW4gPSBudWxsO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHNvdXJjZSA9IGV2ZW50LnNvdXJjZTtcblxuICBpZiAoZXZlbnQuZGF0YSAmJiB0eXBlb2YgZXZlbnQuZGF0YSA9PT0gXCJvYmplY3RcIiAmJiBldmVudC5kYXRhLmV2ZW50KSB7XG4gICAgc3dpdGNoIChldmVudC5kYXRhLmV2ZW50KSB7XG4gICAgICBjYXNlIFwiaW5pdFwiIDpcbiAgICAgICAgaW5pdChldmVudC5kYXRhLnBhcmFtcywgZXZlbnQuZGF0YS5maWxlcyk7XG4gICAgICAgIGxvYWQoKTtcblxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJwbGF5XCI6XG4gICAgICAgIHBsYXkoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicGF1c2VcIjpcbiAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwic3RvcFwiOlxuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInJlbW92ZVwiOlxuICAgICAgICByZW1vdmUoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59KTtcblxudmFyIGZpbGVzO1xuXG5mdW5jdGlvbiBjb25maWd1cmUodXJscykge1xuICBmaWxlcyA9IHVybHM7XG5cbiAgdmFyIGZvbGRlclBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBwbGF5ZXJKVyh7XG4gICAgICBwbGF5bGlzdDogZ2V0UGxheWxpc3QoZmlsZXMpLFxuICAgICAgd2lkdGggOiB3aWR0aCxcbiAgICAgIGhlaWdodCA6IGhlaWdodCxcbiAgICAgIGNvbnRyb2xzOiBmYWxzZSxcbiAgICAgIHNraW46IHtcbiAgICAgICAgbmFtZTogXCJyaXNlXCJcbiAgICAgIH0sXG4gICAgICBzdHJldGNoaW5nIDogc3RyZXRjaGluZ1xuICAgIH0pO1xuXG4gICAgaW5zdGFuY2Uub25QbGF5ZXJFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGVycm9yRXZlbnQoe1xuICAgICAgICAgIHR5cGU6IFwidmlkZW9cIixcbiAgICAgICAgICBpbmRleDogandwbGF5ZXIoKS5nZXRQbGF5bGlzdEluZGV4KCksXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaW5zdGFuY2Uub25TZXR1cEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgZXJyb3JFdmVudCh7XG4gICAgICAgICAgdHlwZTogXCJzZXR1cFwiLFxuICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGluc3RhbmNlLmdldEN1cnJlbnRJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGp3cGxheWVyKCkuZ2V0UGxheWxpc3RJbmRleCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG5cbiAgcGxheWVyID0gZm9sZGVyUGxheWVyKCk7XG59XG5cbmZ1bmN0aW9uIGdldFBsYXlsaXN0IChsaXN0KSB7XG4gIHZhciBwbGF5bGlzdCA9IFtdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkgKz0gMSkge1xuICAgIHBsYXlsaXN0LnB1c2goe1xuICAgICAgZmlsZTogbGlzdFtpXSxcbiAgICAgIHR5cGU6IGdldFZpZGVvRmlsZVR5cGUobGlzdFtpXSlcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBwbGF5bGlzdDtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
