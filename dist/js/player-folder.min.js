function configure(){}function doneEvent(){source.postMessage({event:"playerEnded"},origin)}function readyEvent(){source.postMessage({event:"playerReady"},origin)}function errorEvent(e){source.postMessage({event:"playerError",error:e},origin)}function playlistItemEvent(e){source.postMessage({event:"playerItemChange",index:e},origin)}function init(e,t,n){window.oncontextmenu=function(){return!1},width=e.width,height=e.height,skin=n,controls=e.video.controls,volume=e.video.volume,stretching=e.video.scaleToFit?"uniform":"none",autoPlay=controls?e.video.autoplay:!0,e.video.pause?(e.video.pause="string"==typeof e.video.pause?parseInt(e.video.pause,10):e.video.pause,pauseDuration=isNaN(e.video.pause)?0:e.video.pause):pauseDuration=0,configure(t)}function load(){player.loadVideo()}function play(){player.play()}function pause(){"PLAYING"===player.getState().toUpperCase()&&player.pause()}function stop(){player.stop()}function remove(){player.remove()}function getVideoFileType(e){var t,n=[".mp4",".webm",".ogg",".ogv"],o=e.toLowerCase(),r=null;for(t=0;t<=n.length;t+=1)if(-1!==o.indexOf(n[t])){r=n[t].substr(n[t].lastIndexOf(".")+1);break}return"ogv"===r&&(r="ogg"),r}function configure(e){files=e;var t=function(){var e=playerJW({playlist:getPlaylist(files),width:width,height:height,controls:!1,stretching:stretching,skin:skin});return e.onPlayerError=function(e){e&&errorEvent({type:"video",index:jwplayer().getPlaylistIndex(),message:e.message})},e.onSetupError=function(e){e&&errorEvent({type:"setup",index:0,message:e.message})},e.getCurrentIndex=function(){return jwplayer().getPlaylistIndex()},e};player=t()}function getPlaylist(e){for(var t=[],n=0;n<e.length;n+=1)t.push({sources:[{file:e[n],type:getVideoFileType(e[n])}]});return t}var controls,volume,autoPlay,stretching,pauseDuration,width,height,skin,player=null,source=null,origin=null,playerJW=function(e){"use strict";function t(){doneEvent()}function n(){d||(clearTimeout(f),f=setTimeout(function(){jwplayer().play(),jwplayer().setControls(!1),jwplayer().setControls(!0)},1e3*pauseDuration))}function o(e){playlistItemEvent(e)}function r(e){e&&errorEvent({type:"video",message:e.message})}function a(e){e&&errorEvent({type:"setup",message:e.message})}function i(){jwplayer("player").setup(e),jwplayer().onSetupError(function(e){a(e)}),jwplayer().onReady(function(){var a,i=document.getElementById("player").getElementsByTagName("*"),s=i.length;for(a=0;s>a;a+=1)i[a].className+=" notransition";document.getElementById("player").className+=" notransition",document.getElementById("player_menu").className+=" disable-context-menu",e.hasOwnProperty("playlist")?(jwplayer().onPlaylistComplete(function(){t()}),jwplayer().onPlaylistItem(function(e){o(e.index)})):e.hasOwnProperty("file")&&jwplayer().onComplete(function(){t()}),jwplayer().onError(function(e){r(e)}),controls&&pauseDuration>1&&jwplayer().onPause(function(){n()}),jwplayer().setVolume(volume),controls&&!autoPlay&&jwplayer().setControls(!0),readyEvent()})}function s(){d=!1,autoPlay&&(controls&&!jwplayer().getControls()&&jwplayer().setControls(!0),jwplayer().play(),controls&&(jwplayer().setControls(!1),jwplayer().setControls(!0)))}function l(){d=!0,clearTimeout(f),jwplayer().pause()}function u(){this.pause()}function p(){d=!1,clearTimeout(f),f=null,jwplayer().remove()}function c(){return jwplayer().getDuration()}function y(){return jwplayer().getPosition()}function g(){return jwplayer().getState()}var d=!1,f=null;return{getDuration:c,getPosition:y,getState:g,loadVideo:i,play:s,pause:l,onPlayerError:r,onSetupError:a,stop:u,remove:p}};window.addEventListener("message",function(e){if(origin=e.origin||e.originalEvent.origin,"http://s3.amazonaws.com"!==origin&&"http://localhost:8000"!==origin)return origin=null,void 0;if(source=e.source,e.data&&"object"==typeof e.data&&e.data.event)switch(e.data.event){case"init":init(e.data.params,e.data.files,e.data.skin),load();break;case"play":play();break;case"pause":pause();break;case"stop":stop();break;case"remove":remove()}});var files;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3BsYXllci1mb2xkZXIubWluLmpzIl0sIm5hbWVzIjpbImNvbmZpZ3VyZSIsImRvbmVFdmVudCIsInNvdXJjZSIsInBvc3RNZXNzYWdlIiwiZXZlbnQiLCJvcmlnaW4iLCJyZWFkeUV2ZW50IiwiZXJyb3JFdmVudCIsImRhdGEiLCJlcnJvciIsInBsYXlsaXN0SXRlbUV2ZW50IiwiaW5kZXgiLCJpbml0IiwicGFyYW1zIiwidXJscyIsInNraW5WYWwiLCJ3aW5kb3ciLCJvbmNvbnRleHRtZW51Iiwid2lkdGgiLCJoZWlnaHQiLCJza2luIiwiY29udHJvbHMiLCJ2aWRlbyIsInZvbHVtZSIsInN0cmV0Y2hpbmciLCJhdXRvUGxheSIsImF1dG9wbGF5IiwicGF1c2UiLCJwYXJzZUludCIsInBhdXNlRHVyYXRpb24iLCJpc05hTiIsImxvYWQiLCJwbGF5ZXIiLCJsb2FkVmlkZW8iLCJwbGF5IiwiZ2V0U3RhdGUiLCJ0b1VwcGVyQ2FzZSIsInN0b3AiLCJyZW1vdmUiLCJnZXRWaWRlb0ZpbGVUeXBlIiwidXJsIiwiaSIsImV4dGVuc2lvbnMiLCJ1cmxMb3dlcmNhc2UiLCJ0b0xvd2VyQ2FzZSIsInR5cGUiLCJsZW5ndGgiLCJpbmRleE9mIiwic3Vic3RyIiwibGFzdEluZGV4T2YiLCJmaWxlcyIsImZvbGRlclBsYXllciIsImluc3RhbmNlIiwicGxheWVySlciLCJwbGF5bGlzdCIsImdldFBsYXlsaXN0Iiwib25QbGF5ZXJFcnJvciIsImp3cGxheWVyIiwiZ2V0UGxheWxpc3RJbmRleCIsIm1lc3NhZ2UiLCJvblNldHVwRXJyb3IiLCJnZXRDdXJyZW50SW5kZXgiLCJsaXN0IiwicHVzaCIsInNvdXJjZXMiLCJmaWxlIiwic2V0dXBPYmoiLCJfb25Db21wbGV0ZSIsIl9vblBhdXNlIiwidmlld2VyUGF1c2VkIiwiY2xlYXJUaW1lb3V0IiwicGF1c2VUaW1lciIsInNldFRpbWVvdXQiLCJzZXRDb250cm9scyIsIl9vblBsYXlsaXN0SXRlbSIsInNldHVwIiwib25SZWFkeSIsImVsZW1lbnRzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwidG90YWwiLCJjbGFzc05hbWUiLCJoYXNPd25Qcm9wZXJ0eSIsIm9uUGxheWxpc3RDb21wbGV0ZSIsIm9uUGxheWxpc3RJdGVtIiwib25Db21wbGV0ZSIsIm9uRXJyb3IiLCJvblBhdXNlIiwic2V0Vm9sdW1lIiwiZ2V0Q29udHJvbHMiLCJ0aGlzIiwiZ2V0RHVyYXRpb24iLCJnZXRQb3NpdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJvcmlnaW5hbEV2ZW50Il0sIm1hcHBpbmdzIjoiQUFTQSxRQUFTQSxjQUVULFFBQVNDLGFBQ1BDLE9BQU9DLGFBQ0xDLE1BQU8sZUFDTkMsUUFHTCxRQUFTQyxjQUNQSixPQUFPQyxhQUNMQyxNQUFPLGVBQ05DLFFBSUwsUUFBU0UsWUFBV0MsR0FDbEJOLE9BQU9DLGFBQ0xDLE1BQU8sY0FDUEssTUFBT0QsR0FDTkgsUUFHTCxRQUFTSyxtQkFBa0JDLEdBQ3pCVCxPQUFPQyxhQUNMQyxNQUFPLG1CQUNQTyxNQUFPQSxHQUNOTixRQUdMLFFBQVNPLE1BQUtDLEVBQVFDLEVBQU1DLEdBQzFCQyxPQUFPQyxjQUFnQixXQUNyQixPQUFPLEdBR1RDLE1BQVFMLEVBQU9LLE1BQ2ZDLE9BQVNOLEVBQU9NLE9BQ2hCQyxLQUFPTCxFQUNQTSxTQUFXUixFQUFPUyxNQUFNRCxTQUN4QkUsT0FBU1YsRUFBT1MsTUFBTUMsT0FDdEJDLFdBQWNYLEVBQU9TLE1BQWdCLFdBQUksVUFBWSxPQUdyREcsU0FBYUosU0FBbUJSLEVBQU9TLE1BQU1JLFVBQXBCLEVBR3JCYixFQUFPUyxNQUFNSyxPQUVmZCxFQUFPUyxNQUFNSyxNQUF1QyxnQkFBdkJkLEdBQU9TLE1BQU1LLE1BQXNCQyxTQUFTZixFQUFPUyxNQUFNSyxNQUFPLElBQU1kLEVBQU9TLE1BQU1LLE1BR2hIRSxjQUFpQkMsTUFBTWpCLEVBQU9TLE1BQU1LLE9BQVUsRUFBSWQsRUFBT1MsTUFBTUssT0FHL0RFLGNBQWdCLEVBR2xCN0IsVUFBVWMsR0FHWixRQUFTaUIsUUFDUEMsT0FBT0MsWUFHVCxRQUFTQyxRQUNQRixPQUFPRSxPQUdULFFBQVNQLFNBRWlDLFlBQXBDSyxPQUFPRyxXQUFXQyxlQUNwQkosT0FBT0wsUUFJWCxRQUFTVSxRQUNQTCxPQUFPSyxPQUdULFFBQVNDLFVBQ1BOLE9BQU9NLFNBR1QsUUFBU0Msa0JBQWtCQyxHQUN6QixHQUdFQyxHQUhFQyxHQUFjLE9BQVEsUUFBUyxPQUFRLFFBQ3pDQyxFQUFlSCxFQUFJSSxjQUNuQkMsRUFBTyxJQUdULEtBQUtKLEVBQUksRUFBR0EsR0FBS0MsRUFBV0ksT0FBUUwsR0FBSyxFQUN2QyxHQUE0QyxLQUF4Q0UsRUFBYUksUUFBUUwsRUFBV0QsSUFBWSxDQUM5Q0ksRUFBT0gsRUFBV0QsR0FBR08sT0FBT04sRUFBV0QsR0FBR1EsWUFBWSxLQUFPLEVBQzdELE9BUUosTUFKYSxRQUFUSixJQUNGQSxFQUFPLE9BR0ZBLEVBcU5ULFFBQVM3QyxXQUFVYyxHQUNqQm9DLE1BQVFwQyxDQUVSLElBQUlxQyxHQUFlLFdBQ2pCLEdBQUlDLEdBQVdDLFVBQ2JDLFNBQVVDLFlBQVlMLE9BQ3RCaEMsTUFBUUEsTUFDUkMsT0FBU0EsT0FDVEUsVUFBVSxFQUNWRyxXQUFhQSxXQUNiSixLQUFNQSxNQTJCUixPQXhCQWdDLEdBQVNJLGNBQWdCLFNBQVUvQyxHQUM3QkEsR0FDRkYsWUFDRXNDLEtBQU0sUUFDTmxDLE1BQU84QyxXQUFXQyxtQkFDbEJDLFFBQVNsRCxFQUFNa0QsV0FLckJQLEVBQVNRLGFBQWUsU0FBVW5ELEdBQzVCQSxHQUNGRixZQUNFc0MsS0FBTSxRQUNObEMsTUFBTyxFQUNQZ0QsUUFBU2xELEVBQU1rRCxXQUtyQlAsRUFBU1MsZ0JBQWtCLFdBQ3pCLE1BQU9KLFlBQVdDLG9CQUdiTixFQUdUcEIsUUFBU21CLElBR1gsUUFBU0ksYUFBYU8sR0FHcEIsSUFBSyxHQUZEUixNQUVLYixFQUFJLEVBQUdBLEVBQUlxQixFQUFLaEIsT0FBUUwsR0FBSyxFQUNwQ2EsRUFBU1MsTUFDUEMsVUFDRUMsS0FBTUgsRUFBS3JCLEdBQ1hJLEtBQU1OLGlCQUFpQnVCLEVBQUtyQixPQUtsQyxPQUFPYSxHQXhYVCxHQUFJakMsVUFBVUUsT0FBUUUsU0FBVUQsV0FBWUssY0FDeENYLE1BQU9DLE9BQVFDLEtBRWZZLE9BQVMsS0FFVDlCLE9BQVMsS0FDWEcsT0FBUyxLQTBHUGdELFNBQVcsU0FBVWEsR0FDdkIsWUFLQSxTQUFTQyxLQUNQbEUsWUFHRixRQUFTbUUsS0FDRkMsSUFFSEMsYUFBYUMsR0FFYkEsRUFBYUMsV0FBVyxXQUV0QmYsV0FBV3ZCLE9BR1h1QixXQUFXZ0IsYUFBWSxHQUN2QmhCLFdBQVdnQixhQUFZLElBRU4sSUFBaEI1QyxnQkFJUCxRQUFTNkMsR0FBZ0IvRCxHQUN2QkQsa0JBQWtCQyxHQUdwQixRQUFTNkMsR0FBYy9DLEdBQ2pCQSxHQUNGRixZQUNFc0MsS0FBTSxRQUNOYyxRQUFTbEQsRUFBTWtELFVBS3JCLFFBQVNDLEdBQWFuRCxHQUNoQkEsR0FDRkYsWUFDRXNDLEtBQU0sUUFDTmMsUUFBU2xELEVBQU1rRCxVQUtyQixRQUFTMUIsS0FDUHdCLFNBQVMsVUFBVWtCLE1BQU1ULEdBRXpCVCxXQUFXRyxhQUFhLFNBQVVuRCxHQUNoQ21ELEVBQWFuRCxLQUdmZ0QsV0FBV21CLFFBQVEsV0FDakIsR0FFRW5DLEdBRkVvQyxFQUFXQyxTQUFTQyxlQUFlLFVBQVVDLHFCQUFxQixLQUNwRUMsRUFBUUosRUFBUy9CLE1BSW5CLEtBQUtMLEVBQUksRUFBT3dDLEVBQUp4QyxFQUFXQSxHQUFLLEVBQzFCb0MsRUFBU3BDLEdBQUd5QyxXQUFhLGVBRzNCSixVQUFTQyxlQUFlLFVBQVVHLFdBQWEsZ0JBRy9DSixTQUFTQyxlQUFlLGVBQWVHLFdBQWEsd0JBRWhEaEIsRUFBU2lCLGVBQWUsYUFFMUIxQixXQUFXMkIsbUJBQW1CLFdBQzVCakIsTUFJRlYsV0FBVzRCLGVBQWUsU0FBVTdFLEdBQ2xDa0UsRUFBZ0JsRSxFQUFLRyxVQUdoQnVELEVBQVNpQixlQUFlLFNBRS9CMUIsV0FBVzZCLFdBQVcsV0FDcEJuQixNQUlKVixXQUFXOEIsUUFBUSxTQUFVOUUsR0FDM0IrQyxFQUFjL0MsS0FHWlksVUFBWVEsY0FBZ0IsR0FDOUI0QixXQUFXK0IsUUFBUSxXQUNqQnBCLE1BSUpYLFdBQVdnQyxVQUFVbEUsUUFFakJGLFdBQWFJLFVBQ2ZnQyxXQUFXZ0IsYUFBWSxHQUd6Qm5FLGVBS0osUUFBUzRCLEtBQ1BtQyxHQUFlLEVBRVg1QyxXQUNFSixXQUFhb0MsV0FBV2lDLGVBRzFCakMsV0FBV2dCLGFBQVksR0FHekJoQixXQUFXdkIsT0FFUGIsV0FFRm9DLFdBQVdnQixhQUFZLEdBQ3ZCaEIsV0FBV2dCLGFBQVksS0FLN0IsUUFBUzlDLEtBQ1AwQyxHQUFlLEVBQ2ZDLGFBQWFDLEdBQ2JkLFdBQVc5QixRQUdiLFFBQVNVLEtBQ1BzRCxLQUFLaEUsUUFHUCxRQUFTVyxLQUNQK0IsR0FBZSxFQUNmQyxhQUFhQyxHQUNiQSxFQUFhLEtBQ2JkLFdBQVduQixTQUdiLFFBQVNzRCxLQUNQLE1BQU9uQyxZQUFXbUMsY0FHcEIsUUFBU0MsS0FDUCxNQUFPcEMsWUFBV29DLGNBR3BCLFFBQVMxRCxLQUNQLE1BQU9zQixZQUFXdEIsV0F6SnBCLEdBQUlrQyxJQUFlLEVBQ2ZFLEVBQWEsSUEySmpCLFFBQ0VxQixZQUFhQSxFQUNiQyxZQUFhQSxFQUNiMUQsU0FBVUEsRUFDVkYsVUFBV0EsRUFDWEMsS0FBTUEsRUFDTlAsTUFBT0EsRUFDUDZCLGNBQWVBLEVBQ2ZJLGFBQWNBLEVBQ2R2QixLQUFNQSxFQUNOQyxPQUFRQSxHQUladEIsUUFBTzhFLGlCQUFpQixVQUFXLFNBQVMxRixHQUkxQyxHQUhBQyxPQUFTRCxFQUFNQyxRQUFVRCxFQUFNMkYsY0FBYzFGLE9BRzlCLDRCQUFYQSxRQUFtRCwwQkFBWEEsT0FFMUMsTUFEQUEsUUFBUyxLQUNULE1BS0YsSUFGQUgsT0FBU0UsRUFBTUYsT0FFWEUsRUFBTUksTUFBOEIsZ0JBQWZKLEdBQU1JLE1BQXFCSixFQUFNSSxLQUFLSixNQUM3RCxPQUFRQSxFQUFNSSxLQUFLSixPQUNqQixJQUFLLE9BQ0hRLEtBQUtSLEVBQU1JLEtBQUtLLE9BQVFULEVBQU1JLEtBQUswQyxNQUFPOUMsRUFBTUksS0FBS1ksTUFDckRXLE1BRUEsTUFDRixLQUFLLE9BQ0hHLE1BQ0EsTUFDRixLQUFLLFFBQ0hQLE9BQ0EsTUFDRixLQUFLLE9BQ0hVLE1BQ0EsTUFDRixLQUFLLFNBQ0hDLFdBTVIsSUFBSVkiLCJmaWxlIjoianMvcGxheWVyLWZvbGRlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29udHJvbHMsIHZvbHVtZSwgYXV0b1BsYXksIHN0cmV0Y2hpbmcsIHBhdXNlRHVyYXRpb247XG52YXIgd2lkdGgsIGhlaWdodCwgc2tpbjtcblxudmFyIHBsYXllciA9IG51bGw7XG5cbnZhciBzb3VyY2UgPSBudWxsLFxuICBvcmlnaW4gPSBudWxsO1xuXG4vLyBPVkVSUklERTogbWV0aG9kIHRvIGRpc3Rpbmd1aXNoIGNvbmZpZ3VyYXRpb25zIGJldHdlZW4gZmlsZSBhbmQgZm9sZGVyXG5mdW5jdGlvbiBjb25maWd1cmUodXJscyl7fVxuXG5mdW5jdGlvbiBkb25lRXZlbnQoKSB7XG4gIHNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgZXZlbnQ6IFwicGxheWVyRW5kZWRcIlxuICB9LCBvcmlnaW4pO1xufVxuXG5mdW5jdGlvbiByZWFkeUV2ZW50KCkge1xuICBzb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgIGV2ZW50OiBcInBsYXllclJlYWR5XCJcbiAgfSwgb3JpZ2luKTtcblxufVxuXG5mdW5jdGlvbiBlcnJvckV2ZW50KGRhdGEpIHtcbiAgc291cmNlLnBvc3RNZXNzYWdlKHtcbiAgICBldmVudDogXCJwbGF5ZXJFcnJvclwiLFxuICAgIGVycm9yOiBkYXRhXG4gIH0sIG9yaWdpbik7XG59XG5cbmZ1bmN0aW9uIHBsYXlsaXN0SXRlbUV2ZW50KGluZGV4KSB7XG4gIHNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgZXZlbnQ6IFwicGxheWVySXRlbUNoYW5nZVwiLFxuICAgIGluZGV4OiBpbmRleFxuICB9LCBvcmlnaW4pO1xufVxuXG5mdW5jdGlvbiBpbml0KHBhcmFtcywgdXJscywgc2tpblZhbCkge1xuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB3aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgc2tpbiA9IHNraW5WYWw7XG4gIGNvbnRyb2xzID0gcGFyYW1zLnZpZGVvLmNvbnRyb2xzO1xuICB2b2x1bWUgPSBwYXJhbXMudmlkZW8udm9sdW1lO1xuICBzdHJldGNoaW5nID0gKHBhcmFtcy52aWRlby5zY2FsZVRvRml0KSA/IFwidW5pZm9ybVwiIDogXCJub25lXCI7XG5cbiAgLy8gZW5zdXJlIGF1dG9QbGF5IGlzIHRydWUgaWYgY29udHJvbHMgdmFsdWUgaXMgZmFsc2UsIG90aGVyd2lzZSB1c2UgcGFyYW1zIHZhbHVlXG4gIGF1dG9QbGF5ID0gKCFjb250cm9scykgPyB0cnVlIDogcGFyYW1zLnZpZGVvLmF1dG9wbGF5O1xuXG4gIC8vIGNoZWNrIGlmIHRoaXMgc2V0dGluZyBleGlzdHMgZHVlIHRvIG1lcmdlIG9mIGZpbGUgYW5kIGZvbGRlclxuICBpZiAocGFyYW1zLnZpZGVvLnBhdXNlKSB7XG4gICAgLy8gY29udmVydCBwYXVzZSB2YWx1ZSB0byBudW1iZXIgaWYgdHlwZSBpcyBcInN0cmluZ1wiXG4gICAgcGFyYW1zLnZpZGVvLnBhdXNlID0gKHR5cGVvZiBwYXJhbXMudmlkZW8ucGF1c2UgPT09IFwic3RyaW5nXCIpID8gcGFyc2VJbnQocGFyYW1zLnZpZGVvLnBhdXNlLCAxMCkgOiBwYXJhbXMudmlkZW8ucGF1c2U7XG5cbiAgICAvLyBpZiBub3Qgb2YgdHlwZSBcIm51bWJlclwiLCBzZXQgaXRzIHZhbHVlIHRvIDAgc28gYSBwYXVzZSBkb2VzIG5vdCBnZXQgYXBwbGllZFxuICAgIHBhdXNlRHVyYXRpb24gPSAoaXNOYU4ocGFyYW1zLnZpZGVvLnBhdXNlKSkgPyAwIDogcGFyYW1zLnZpZGVvLnBhdXNlO1xuICB9IGVsc2Uge1xuICAgIC8vIGVuc3VyZSBubyBwYXVzZSBkdXJhdGlvbiBvY2N1cnNcbiAgICBwYXVzZUR1cmF0aW9uID0gMDtcbiAgfVxuXG4gIGNvbmZpZ3VyZSh1cmxzKTtcbn1cblxuZnVuY3Rpb24gbG9hZCgpIHtcbiAgcGxheWVyLmxvYWRWaWRlbygpO1xufVxuXG5mdW5jdGlvbiBwbGF5KCkge1xuICBwbGF5ZXIucGxheSgpO1xufVxuXG5mdW5jdGlvbiBwYXVzZSgpIHtcbiAgLy8gT25seSBwYXVzZSB2aWRlbyBpZiBpdCdzIGFjdHVhbGx5IHBsYXlpbmcuXG4gIGlmIChwbGF5ZXIuZ2V0U3RhdGUoKS50b1VwcGVyQ2FzZSgpID09PSBcIlBMQVlJTkdcIikge1xuICAgIHBsYXllci5wYXVzZSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHN0b3AoKSB7XG4gIHBsYXllci5zdG9wKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgcGxheWVyLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiBnZXRWaWRlb0ZpbGVUeXBlICh1cmwpIHtcbiAgdmFyIGV4dGVuc2lvbnMgPSBbXCIubXA0XCIsIFwiLndlYm1cIiwgXCIub2dnXCIsIFwiLm9ndlwiXSxcbiAgICB1cmxMb3dlcmNhc2UgPSB1cmwudG9Mb3dlckNhc2UoKSxcbiAgICB0eXBlID0gbnVsbCxcbiAgICBpO1xuXG4gIGZvciAoaSA9IDA7IGkgPD0gZXh0ZW5zaW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGlmICh1cmxMb3dlcmNhc2UuaW5kZXhPZihleHRlbnNpb25zW2ldKSAhPT0gLTEpIHtcbiAgICAgIHR5cGUgPSBleHRlbnNpb25zW2ldLnN1YnN0cihleHRlbnNpb25zW2ldLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKHR5cGUgPT09IFwib2d2XCIpIHtcbiAgICB0eXBlID0gXCJvZ2dcIjtcbiAgfVxuXG4gIHJldHVybiB0eXBlO1xufVxuXG4vLyBpbmhlcml0IGZyb20gcGxheWVySlcgZm9yIGEgY3VzdG9taXplZCBmaWxlIG9yIGZvbGRlciBwbGF5ZXJcbnZhciBwbGF5ZXJKVyA9IGZ1bmN0aW9uIChzZXR1cE9iaikge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgdmlld2VyUGF1c2VkID0gZmFsc2U7XG4gIHZhciBwYXVzZVRpbWVyID0gbnVsbDtcblxuICBmdW5jdGlvbiBfb25Db21wbGV0ZSgpIHtcbiAgICBkb25lRXZlbnQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBhdXNlKCkge1xuICAgIGlmICghdmlld2VyUGF1c2VkKSB7XG4gICAgICAvLyB1c2VyIGhhcyBwYXVzZWQsIHNldCBhIHRpbWVyIHRvIHBsYXkgYWdhaW5cbiAgICAgIGNsZWFyVGltZW91dChwYXVzZVRpbWVyKTtcblxuICAgICAgcGF1c2VUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBjb250aW51ZSBwbGF5aW5nIHRoZSBjdXJyZW50IHZpZGVvXG4gICAgICAgIGp3cGxheWVyKCkucGxheSgpO1xuXG4gICAgICAgIC8vIHdvcmthcm91bmQgZm9yIGNvbnRyb2xzIHJlbWFpbmluZyB2aXNpYmxlLCB0dXJuIHRoZW0gb2ZmIGFuZCBvbiBhZ2FpblxuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKGZhbHNlKTtcbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcblxuICAgICAgfSwgcGF1c2VEdXJhdGlvbiAqIDEwMDApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9vblBsYXlsaXN0SXRlbShpbmRleCkge1xuICAgIHBsYXlsaXN0SXRlbUV2ZW50KGluZGV4KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yRXZlbnQoe1xuICAgICAgICB0eXBlOiBcInZpZGVvXCIsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU2V0dXBFcnJvcihlcnJvcikge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3JFdmVudCh7XG4gICAgICAgIHR5cGU6IFwic2V0dXBcIixcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbG9hZFZpZGVvKCkge1xuICAgIGp3cGxheWVyKFwicGxheWVyXCIpLnNldHVwKHNldHVwT2JqKTtcblxuICAgIGp3cGxheWVyKCkub25TZXR1cEVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgb25TZXR1cEVycm9yKGVycm9yKTtcbiAgICB9KTtcblxuICAgIGp3cGxheWVyKCkub25SZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIiksXG4gICAgICAgIHRvdGFsID0gZWxlbWVudHMubGVuZ3RoLFxuICAgICAgICBpO1xuXG4gICAgICAvLyBXb3JrYXJvdW5kIGZvciBDaHJvbWUgQXBwIFBsYXllciA8d2Vidmlldz4gbm90IGhhbmRsaW5nIENTUzMgdHJhbnNpdGlvblxuICAgICAgZm9yIChpID0gMDsgaSA8IHRvdGFsOyBpICs9IDEpIHtcbiAgICAgICAgZWxlbWVudHNbaV0uY2xhc3NOYW1lICs9IFwiIG5vdHJhbnNpdGlvblwiO1xuICAgICAgfVxuXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKS5jbGFzc05hbWUgKz0gXCIgbm90cmFuc2l0aW9uXCI7XG5cbiAgICAgIC8vIEJ1Z2ZpeCAtIGlzc3VlICMzNiAoSldQbGF5ZXIgY29udGV4dCBtZW51KVxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJfbWVudVwiKS5jbGFzc05hbWUgKz0gXCIgZGlzYWJsZS1jb250ZXh0LW1lbnVcIjtcblxuICAgICAgaWYgKHNldHVwT2JqLmhhc093blByb3BlcnR5KFwicGxheWxpc3RcIikpIHtcbiAgICAgICAgLy8gZm9sZGVyLCBsaXN0ZW4gZm9yIHBsYXlsaXN0IGNvbXBsZXRlIGV2ZW50XG4gICAgICAgIGp3cGxheWVyKCkub25QbGF5bGlzdENvbXBsZXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfb25Db21wbGV0ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBmb2xkZXIsIGxpc3RlbiBmb3Igd2hlbiBhIHBsYXlsaXN0IGl0ZW0gY2hhbmdlc1xuICAgICAgICBqd3BsYXllcigpLm9uUGxheWxpc3RJdGVtKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgX29uUGxheWxpc3RJdGVtKGRhdGEuaW5kZXgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHNldHVwT2JqLmhhc093blByb3BlcnR5KFwiZmlsZVwiKSkge1xuICAgICAgICAvLyBmaWxlLCBsaXN0ZW4gZm9yIHNpbmdsZSBmaWxlIGNvbXBsZXRlIGV2ZW50XG4gICAgICAgIGp3cGxheWVyKCkub25Db21wbGV0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX29uQ29tcGxldGUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGp3cGxheWVyKCkub25FcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgb25QbGF5ZXJFcnJvcihlcnJvcik7XG4gICAgICB9KTtcblxuICAgICAgaWYgKGNvbnRyb2xzICYmIHBhdXNlRHVyYXRpb24gPiAxKSB7XG4gICAgICAgIGp3cGxheWVyKCkub25QYXVzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX29uUGF1c2UoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGp3cGxheWVyKCkuc2V0Vm9sdW1lKHZvbHVtZSk7XG5cbiAgICAgIGlmIChjb250cm9scyAmJiAhYXV0b1BsYXkpIHtcbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcbiAgICAgIH1cblxuICAgICAgcmVhZHlFdmVudCgpO1xuXG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIHZpZXdlclBhdXNlZCA9IGZhbHNlO1xuXG4gICAgaWYgKGF1dG9QbGF5KSB7XG4gICAgICBpZiAoY29udHJvbHMgJiYgIWp3cGxheWVyKCkuZ2V0Q29udHJvbHMoKSkge1xuICAgICAgICAvLyBXaWxsIGJlIGZpcnN0IHRpbWUgcGxheWVyIGlzIGJlaW5nIHRvbGQgdG8gcGxheSBzbyBkb2luZyB0aGlzIGhlcmUgYW5kIG5vdCBpbiBzZXR1cCBzbyB0aGF0IGNvbnRyb2xzXG4gICAgICAgIC8vIGFyZW4ndCB2aXNpYmxlIHVwb24gcGxheWluZyBmb3IgdGhlIGZpcnN0IHRpbWUuXG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHModHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIGp3cGxheWVyKCkucGxheSgpO1xuXG4gICAgICBpZiAoY29udHJvbHMpIHtcbiAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgY29udHJvbHMgcmVtYWluaW5nIHZpc2libGUsIHR1cm4gdGhlbSBvZmYgYW5kIG9uIGFnYWluXG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHMoZmFsc2UpO1xuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKHRydWUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIHZpZXdlclBhdXNlZCA9IHRydWU7XG4gICAgY2xlYXJUaW1lb3V0KHBhdXNlVGltZXIpO1xuICAgIGp3cGxheWVyKCkucGF1c2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgdGhpcy5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgIHZpZXdlclBhdXNlZCA9IGZhbHNlO1xuICAgIGNsZWFyVGltZW91dChwYXVzZVRpbWVyKTtcbiAgICBwYXVzZVRpbWVyID0gbnVsbDtcbiAgICBqd3BsYXllcigpLnJlbW92ZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RHVyYXRpb24oKSB7XG4gICAgcmV0dXJuIGp3cGxheWVyKCkuZ2V0RHVyYXRpb24oKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFBvc2l0aW9uKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldFBvc2l0aW9uKCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRTdGF0ZSgpIHtcbiAgICByZXR1cm4gandwbGF5ZXIoKS5nZXRTdGF0ZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnZXREdXJhdGlvbjogZ2V0RHVyYXRpb24sXG4gICAgZ2V0UG9zaXRpb246IGdldFBvc2l0aW9uLFxuICAgIGdldFN0YXRlOiBnZXRTdGF0ZSxcbiAgICBsb2FkVmlkZW86IGxvYWRWaWRlbyxcbiAgICBwbGF5OiBwbGF5LFxuICAgIHBhdXNlOiBwYXVzZSxcbiAgICBvblBsYXllckVycm9yOiBvblBsYXllckVycm9yLFxuICAgIG9uU2V0dXBFcnJvcjogb25TZXR1cEVycm9yLFxuICAgIHN0b3A6IHN0b3AsXG4gICAgcmVtb3ZlOiByZW1vdmVcbiAgfVxufTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gIG9yaWdpbiA9IGV2ZW50Lm9yaWdpbiB8fCBldmVudC5vcmlnaW5hbEV2ZW50Lm9yaWdpbjtcblxuICAvLyBlbnN1cmUgdGhpcyBtZXNzYWdlIGlzIGNvbWluZyBmcm9tIEFtYXpvbiBTMyAod2lkZ2V0KSBvciBwcmV2aWV3IGFwcCAobG9jYWwgd2lkZ2V0KVxuICBpZiAob3JpZ2luICE9PSBcImh0dHA6Ly9zMy5hbWF6b25hd3MuY29tXCIgJiYgb3JpZ2luICE9PSBcImh0dHA6Ly9sb2NhbGhvc3Q6ODAwMFwiKSB7XG4gICAgb3JpZ2luID0gbnVsbDtcbiAgICByZXR1cm47XG4gIH1cblxuICBzb3VyY2UgPSBldmVudC5zb3VyY2U7XG5cbiAgaWYgKGV2ZW50LmRhdGEgJiYgdHlwZW9mIGV2ZW50LmRhdGEgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQuZGF0YS5ldmVudCkge1xuICAgIHN3aXRjaCAoZXZlbnQuZGF0YS5ldmVudCkge1xuICAgICAgY2FzZSBcImluaXRcIiA6XG4gICAgICAgIGluaXQoZXZlbnQuZGF0YS5wYXJhbXMsIGV2ZW50LmRhdGEuZmlsZXMsIGV2ZW50LmRhdGEuc2tpbik7XG4gICAgICAgIGxvYWQoKTtcblxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJwbGF5XCI6XG4gICAgICAgIHBsYXkoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicGF1c2VcIjpcbiAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwic3RvcFwiOlxuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInJlbW92ZVwiOlxuICAgICAgICByZW1vdmUoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59KTtcblxudmFyIGZpbGVzO1xuXG5mdW5jdGlvbiBjb25maWd1cmUodXJscykge1xuICBmaWxlcyA9IHVybHM7XG5cbiAgdmFyIGZvbGRlclBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBwbGF5ZXJKVyh7XG4gICAgICBwbGF5bGlzdDogZ2V0UGxheWxpc3QoZmlsZXMpLFxuICAgICAgd2lkdGggOiB3aWR0aCxcbiAgICAgIGhlaWdodCA6IGhlaWdodCxcbiAgICAgIGNvbnRyb2xzOiBmYWxzZSxcbiAgICAgIHN0cmV0Y2hpbmcgOiBzdHJldGNoaW5nLFxuICAgICAgc2tpbjogc2tpblxuICAgIH0pO1xuXG4gICAgaW5zdGFuY2Uub25QbGF5ZXJFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGVycm9yRXZlbnQoe1xuICAgICAgICAgIHR5cGU6IFwidmlkZW9cIixcbiAgICAgICAgICBpbmRleDogandwbGF5ZXIoKS5nZXRQbGF5bGlzdEluZGV4KCksXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaW5zdGFuY2Uub25TZXR1cEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgZXJyb3JFdmVudCh7XG4gICAgICAgICAgdHlwZTogXCJzZXR1cFwiLFxuICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGluc3RhbmNlLmdldEN1cnJlbnRJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGp3cGxheWVyKCkuZ2V0UGxheWxpc3RJbmRleCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG5cbiAgcGxheWVyID0gZm9sZGVyUGxheWVyKCk7XG59XG5cbmZ1bmN0aW9uIGdldFBsYXlsaXN0IChsaXN0KSB7XG4gIHZhciBwbGF5bGlzdCA9IFtdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkgKz0gMSkge1xuICAgIHBsYXlsaXN0LnB1c2goe1xuICAgICAgc291cmNlczogW3tcbiAgICAgICAgZmlsZTogbGlzdFtpXSxcbiAgICAgICAgdHlwZTogZ2V0VmlkZW9GaWxlVHlwZShsaXN0W2ldKVxuICAgICAgfV1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBwbGF5bGlzdDtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
